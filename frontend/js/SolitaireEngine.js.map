{"version":3,"sources":["webpack:///webpack/bootstrap eda1d6cf7a12d47db2d6","webpack:///./sources/index.js","webpack:///./sources/common/share.js","webpack:///./sources/common/event.js","webpack:///./sources/common/defaults.js","webpack:///./sources/dom/inputs.js","webpack:///./sources/common/common.js","webpack:///./sources/tips/tips.js","webpack:///./sources/tips/allToAll.js","webpack:///./sources/tips/bestTip.js","webpack:///./sources/field.js","webpack:///./sources/group/addGroup.js","webpack:///./sources/deck/addDeck.js","webpack:///./sources/deck/flipTypes.js","webpack:///./sources/deck/readyPutRules.js","webpack:///./sources/group/generators/relations/getBeside.js","webpack:///./sources/deck/readyTakeRules.js","webpack:///./sources/deck/fillRules.js","webpack:///./sources/deck/paddingTypes.js","webpack:///./sources/deck/deckActions.js","webpack:///./sources/deck/actions/twindeckAction.js","webpack:///./sources/deck/actions/dealerdeckAction.js","webpack:///./sources/history/forceMove.js","webpack:///./sources/deck/actions/kickAction.js","webpack:///./sources/deck/actions/stepsAroundAction.js","webpack:///./sources/deck/deckTake.js","webpack:///./sources/deck/deckPut.js","webpack:///./sources/deck/genCardByName.js","webpack:///./sources/history/history.js","webpack:///./sources/deck/getDecks.js","webpack:///./sources/deck/getDeckById.js","webpack:///./sources/deck/deckCardNames.js","webpack:///./sources/deck/getDeck.js","webpack:///./sources/group/groupFill.js","webpack:///./sources/group/groupRedraw.js","webpack:///./sources/group/groupGenerator.js","webpack:///./sources/group/generators/countGenerator.js","webpack:///./sources/group/generators/fanGenerator.js","webpack:///./sources/group/generators/mapGenerator.js","webpack:///./sources/group/generators/relations/relationsGenerator.js","webpack:///./sources/group/generators/relations/mapFallRelations.js","webpack:///./sources/group/generators/mapCommon.js","webpack:///./sources/group/generators/relations/mapAroundRelations.js","webpack:///./sources/group/generators/relations/mapBesideRelations.js","webpack:///./sources/group/generators/relations/lineBesideRelations.js","webpack:///./sources/group/generators/lineGenerator.js","webpack:///./sources/autosteps/addAutoSteps.js","webpack:///./sources/autosteps/fallAutoStep.js","webpack:///./sources/autosteps/autoStep.js","webpack:///./sources/preferences/drawPreferences.js","webpack:///./sources/preferences/preferncesTemplate.html","webpack:///./sources/preferences/preferencesEvents.js","webpack:///./sources/common/storage.js","webpack:///./sources/preferences/defaultPreferences.js","webpack:///./sources/move.js","webpack:///./sources/winCheck.js","webpack:///./sources/winCheckMethods.js","webpack:///./sources/dom/domManager.js","webpack:///./sources/dom/render/elRender.js","webpack:///./sources/dom/render/elClass.js","webpack:///./sources/dom/render/allElClass.js","webpack:///./sources/dom/initField.js","webpack:///./sources/dom/drawDeck.js","webpack:///./sources/dom/drawCard.js","webpack:///./sources/dom/drawTip.js","webpack:///./sources/dom/moveDragDeck.js","webpack:///./sources/dom/moveCardToHome.js","webpack:///./sources/dom/fieldThemesSet.js","webpack:///./sources/deck/deckGenerator.js","webpack:///./sources/styles/common.scss","webpack:///./sources/styles/default_theme.scss","webpack:///./sources/styles/alternative_theme.scss","webpack:///./sources/debug/debug.js","webpack:///./sources/debug/tests/renderTest.js"],"names":[],"mappings":"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","file":"SolitaireEngine.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap eda1d6cf7a12d47db2d6\n **/","'use strict';\n\n// common\nimport share      from 'share';\nimport event      from 'event';\nimport defaults   from 'defaults';\n\n// init\nimport Inputs        from 'inputs';\nimport Move          from 'move';\nimport forceMove     from 'forceMove';\nimport domManager    from 'domManager';\nimport Field         from 'field';\nimport common        from 'common';\nimport winCheck      from 'winCheck';\nimport History       from 'history';\nimport Tips          from 'tips';\nimport deckGenerator from 'deckGenerator';\n\n// import debug   from 'debug';\n\n// var debug = null;\n// if(dev) {\n// \tdebug = require('debug');\n// }\n\n// styles DOM\nimport 'common.scss';\nimport 'default_theme.scss';\nimport 'alternative_theme.scss';\n\nexports.event     = event;\nexports.options   = defaults;\nexports.winCheck  = winCheck.hwinCheck;\nexports.generator = deckGenerator;\n\nvar firstInit = true;\n\nexports.init = function(gameConfig) {\n\n\tevent.dispatch('gameInit', {firstInit});\n\n\tif(firstInit) {\n\t\tfirstInit = false;\n\t}\n\n\tvar _field = Field(gameConfig);\n\n\tevent.dispatch('gameInited');\n\n\texports.Redraw = function(data) {\n\t\t_field.Redraw(data);\n\t}\n};\n\n// dev <-- process.env.MODE == 'dev'\nif(dev) {\n\tvar debug = require('debug');\n\texports.debug = debug.default;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/index.js\n **/","'use strict';\n\nimport event    from 'event';\nimport defaults from 'defaults';\n\n// export default new function() {\nclass shareClass {\n\n\tconstructor() {\n\t\tthis._data = {};\n\t}\n\n\tget(name) {\n\t\tif(typeof this._data[name] != \"undefined\") {\n\t\t\t// TODO решить наконец проблему, \n\t\t\t// почему Object.assign не работает после babel-я\n\t\t\t\n\t\t\tevent.dispatch('shareGet:' + name, this._data[name]);\n\t\t\treturn this._data[name];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tset(name, data, forceClone) {\n\n\t\tif(typeof name == \"string\") {\n\n\t\t\tif(\n\t\t\t\ttypeof forceClone == \"boolean\" && forceClone\n\t\t\t) {\n\n\t\t\t\tthis._data[name] = Object.assign({}, data);\n\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tevent.dispatch('shareChange:' + name, {\n\t\t\t\t\tfrom: this._data[name],\n\t\t\t\t\tto: data\n\t\t\t\t});\n\n\t\t\t\tthis._data[name] = data;\n\n\t\t\t\tevent.dispatch('shareSet:' + name, data);\n\n\t\t\t}\n\t\t\t// event.dispatch('shareSet', {name : _data});\n\t\t\n\t\t} else if(name instanceof Object && typeof data == \"undefined\") {\n\n\t\t\tfor(var _name in name) {\n\t\t\t\tthis._data[_name] = name[_name];\n\t\t\t}\n\t\t\t// event.dispatch('shareSet', name);\n\n\t\t} else {\n\n\t\t\tconsole.warn('Error share.set:', name, data);\n\n\t\t}\n\t}\n\n\tgetAll() {\n\t\treturn this._data;\n\t}\n}\n\nexport default new shareClass();\n\n\n/** WEBPACK FOOTER **\n ** ./sources/common/share.js\n **/","'use strict';\r\n\r\nvar events = {};\r\n\r\nexport default new function() {\r\n\t\r\n\t// this.on = \r\n\tthis.listen = function(name, callback) {\r\n\t\tif(typeof name != 'string' || typeof callback != 'function') return;\r\n\t\tif(events[name]) {\r\n\t\t\tevents[name].push(callback);\r\n\t\t} else {\r\n\t\t\tevents[name] = [callback];\r\n\t\t}\r\n\t};\r\n\r\n\t// this.do =\r\n\tthis.dispatch = function(name, data) {\r\n\r\n\t\tif(events[name]) {\r\n\t\t\tfor(var i in events[name]) {\r\n\t\t\t\tevents[name][i](data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// this.one function(name, data) {};\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/common/event.js\n **/","'use strict';\n\nexport default {\n\n// Theme ---------------------------------------------------------------------------------\n\n\t// theme               : {\n\t// \tname          : 'alternative_theme',\n\t// \tspriteTexture : true,\n\t//     textureSuits  : ['d', 'c', 'h', 's']\n\t// },\n\n    pref : {\n    \tfield : \"default_field\",    // 0\n    \tface  : \"alternative_face\", // 1\n\t\t\tback  : \"default_back\"      // 0\n\t // empty : 1\n    },\n\n    stepType : 'default',\n    \n\tthemes : {\n\t\tfield : [\n\t\t\t\"default_field\",\n\t\t\t\"alternative_field\"\n\t\t],\n\t\tface  : [\n\t\t\t\"default_face\",\n\t\t\t\"alternative_face\"\n\t\t],\n\t\tback  : [\n\t\t\t\"default_back\",\n\t\t\t\"alternative_back\"//,\n\t\t\t// \"red_back\",\n\t\t\t// \"blue_back\"\n\t\t]\n\t\t// empty : [\n\t\t// \t\"default_empty\",\n\t\t// \t\"alternative_empty\"\n\t\t// ]\n\t},\n\n// Tips ----------------------------------------------------------------------------------\n\n\tshowTips            : true,\n\tshowTipsDestination : false,\n\tshowTipPriority     : false,\n\tcanMoveFlip         : false,\n\n\ttipsParams   : {\n        hideOnEmpty       : false,\n        excludeHomeGroups : true\n    },\n\t\n// Field ---------------------------------------------------------------------------------\n\n\tzoom                : 1.0,\n\n\tlocale              : \"ru\",\n\n\tanimation           : true,\n\tanimationTime       : 600,// ms.\n\n    inputParams : {\n        doubleClick : false\n    },\n\n// Group\n\n\tflip                : null,// param for deck\n\tactions             : null,// param for deck\n\n// Deck ----------------------------------------------------------------------------------\n\n\tcan_move_flip       : false,\n\tshowSlot            : true,\n\tautohide            : false,\n\n\tpaddingType         : 'none',\n\tflip_type           : 'none',\n\t\n\ttakeRules           : ['onlytop'],\n\tputRule             : 'any',\n\n\tmoveDistance        : 0,\n\n\tpadding_y           : 0,\n\tpadding_x           : 0,\n\tflip_padding_y      : 0,//5,\n\tflip_padding_x      : 0,//20,\n\tmove_distance       : 10,\n\tdebugLabels         : false,\n\n\tstartZIndex         : 100,\n    topZIndex           : 900,\n\n\t// afterStep           : false,// Ждать действия после элементарного хода\n\n// Card ----------------------------------------------------------------------------------\n\n\tcard : {\n\t    width        : 71,\n\t    height       : 96,\n\n\t    suits        : ['h', 'd', 'c', 's'],\n\t    // suitindexes : [ 1,   2,   3,   4 ],\n\t    colors       : {\n\t    \tred   : ['h', 'd'],\n\t\t\tblack : ['c', 's']\n\t    },\n\t    \n\t    ranks        : ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'j', 'q', 'k'],\n\t    values       : [ 1,   2,   3,   4,   5,   6,   7,   8,   9,   10,   11,  12,  13],\n\t    ranks36      : ['1',                     '6', '7', '8', '9', '10', 'j', 'q', 'k']\n\t}\n\n// Actions defaults ----------------------------------------------------------------------\n\n\t// actions : {\n\t// \ttwindeck : {\n\t// \t\tcardCount : 3\n\t// \t}\n\t// }\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/common/defaults.js\n **/","'use strict';\n\nimport share    from 'share';\nimport event    from 'event';\nimport defaults from 'defaults';\nimport common   from 'common';\n\nimport Deck from 'addDeck';\nimport Tips from 'tips';\n\n// var drag_el = null;\nshare.set('dragDeck',    null);\nshare.set('startCursor', null);\n\nvar _inputUndoRedo = function() {\n\n\tvar _dragDeck = share.get('dragDeck');\n\tif(\n\t\t_dragDeck                &&\n\t\t_dragDeck[0]             &&\n\t\t_dragDeck[0].card        &&\n\t\t_dragDeck[0].card.parent\n\t) {\n\t\t\n\t\tvar _deck = Deck.getDeckById(_dragDeck[0].card.parent)\n\t\tif(_deck) {\n\t\t\t_deck.Redraw();\n\t\t}\n\t}\n\t\n\tshare.set('dragDeck',    null);\n\tshare.set('startCursor', null);\n\n\tcommon.curUnLock();\n}\n\nevent.listen('undo', function() {\n\t_inputUndoRedo();\n});\n\nevent.listen('redo', function() {\n\t_inputUndoRedo();\n});\n\n// -------------------------------------------------------------------------------------------------------------\n\nvar cdown = function(target, x, y) {\n\n\tshare.set('dragDeck',    null);\n\tshare.set('startCursor', null);\n\n\t// var _startCursor = share.get('startCursor'),\n\t//     _dragDeck    = share.get('dragDeck');\n\t// if(_dragDeck || _startCursor) return;\n\n\tif(common.isCurLock()) { return; }\n\n\t// if (target.className.split(' ').indexOf('animated') >= 0) {\n\t//     return;\n\t// }\n\n\tif( target.className.split(' ').indexOf('slot') >= 0 ) {\n\n\t\tvar _id   = target.id,\n\t\t_deck = common.getElementById(_id);\n\t\tif(_deck) {\n\t\t\tevent.dispatch('click', _deck);\n\t\t}\n\t\t// _deck.runActions();\n\t}\n\n\tif( target.className.split(' ').indexOf('draggable') >= 0 ) {\n\n\t\tvar _id     = target.id,\n\t\t    _card   = _id                   ? common.getElementById(_id) : null,\n\t\t    _parent = _card && _card.parent ? _card.parent               : null,\n\t\t    _deck   = _parent               ? Deck.getDeckById(_parent)  : null;\n\n\t\tif(_deck) {\n\t\t\tevent.dispatch('click', _deck);\n\t\t}\n\t\t\n\t\t// _deck.runActions();\n\n\t\t// TODO\n\t\t// в данной ситуации обрабатывается только клик по карте, пустые колоды никак не обрабатываются\n\n\t\tvar _dragDeck = _deck ? _deck.Take(_id) : null;\n\n\t\tshare.set('dragDeck', _dragDeck);\n\n\t\tif(_dragDeck) {\n\n\t\t\tshare.set('startCursor', {x, y});\n\n\t\t\t// ???\n\t\t\tTips.tipsDestination({currentCard : _card});\n\t\t}\n\n\t}\n\n}\n\n// -------------------------------------------------------------------------------------------------------------\n\nvar cmove = function(x, y) {\n\n\tif(common.isCurLock()) { return; }\n\t\n\tvar _startCursor = share.get('startCursor'),\n\t    _dragDeck    = share.get('dragDeck');\n\n\tif(!_dragDeck || !_startCursor) return;\n\n\tlet _distance = _startCursor \n\t\t? Math.sqrt(common.sqr(x - _startCursor.x) + common.sqr(y - _startCursor.y)) \n\t\t: 0;\n\t// console.clear();\n\tconsole.log(x - _startCursor.x, y - _startCursor.y);\n\n\tvar _deck = common.getElementById(_dragDeck[0].card.parent);\n\n\tvar _position = _deck.padding(_dragDeck[_dragDeck.length - 1].index);\n\n\tevent.dispatch('dragDeck', {\n\t\tx, y        , \n\t\t_dragDeck   , \n\t\t_startCursor, \n\t\t_deck\n\t});\n\n\tvar cursorMove = {\n\t\tdistance     : _distance,\n\t\tdirection    : {\n\t\t\tx     : x - _startCursor.x,// (+) rigth / (-) left\n\t\t\ty     : y - _startCursor.y,// (+) down  / (-) up\n\t\t\tright : x > _startCursor.x,\n\t\t\tleft  : x < _startCursor.x,\n\t\t\tdown  : y > _startCursor.y,\n\t\t\tup    : y < _startCursor.y\n\t\t},\n\t\tlastPosition : {x, y},\n\t\tdeckPosition : {\n\t\t\tx : (_position.x + (x - _startCursor.x)),\n\t\t\ty : (_position.y + (y - _startCursor.y))\n\t\t}\n\t};\n\n\tTips.tipsMove({\n\t\tmoveDeck   : _dragDeck, \n\t\tcursorMove : cursorMove\n\t});\n\n}\n\n// -------------------------------------------------------------------------------------------------------------\n\nvar cend = function(target, x, y, dbclick) {\n\n\tif(common.isCurLock()) { return; }\n\n\tvar _startCursor = share.get('startCursor'),\n\t    _dragDeck    = share.get('dragDeck');\n\n\tif(!_dragDeck || !_startCursor) return;\n\n\tvar _deck = common.getElementById(_dragDeck[0].card.parent);\n\n\tvar _position = _deck.padding(_dragDeck[0].index);\n\tlet _distance = Math.sqrt(common.sqr(x - _startCursor.x) + common.sqr(y - _startCursor.y));\n\tconsole.log('>>> distance:', _distance, x - _startCursor.x, y - _startCursor.y);\n\tvar cursorMove = {\n\t\tdistance     : _distance,\n\t\tdbclick      : !!dbclick,\n\t\tdirection    : {\n\t\t\tx     : x - _startCursor.x,// (+) rigth / (-) left\n\t\t\ty     : y - _startCursor.y,// (+) down  / (-) up\n\t\t\tright : x > _startCursor.x,\n\t\t\tleft  : x < _startCursor.x,\n\t\t\tdown  : y > _startCursor.y,\n\t\t\tup    : y < _startCursor.y\n\t\t},\n\t\tlastPosition : {x, y},\n\t\tdeckPosition : {\n\t\t\tx : (_position.x + (x - _startCursor.x)),\n\t\t\ty : (_position.y + (y - _startCursor.y))\n\t\t}\n\t};\n\n\tshare.set('lastCursorMove', cursorMove, true);\n\n\tevent.dispatch('hideCard', target);\n\tvar _dop = document.elementFromPoint(x, y);\n\tevent.dispatch('showCard', target);\n\t// if(_dop) {\n\n\t// Move(_dragDeck, _dop, cursorMove);\n\tevent.dispatch('Move', {\n\t\tmoveDeck   : _dragDeck,\n\t\tto         : _dop,\n\t\tcursorMove : cursorMove\n\t})\n\t// }\n\n\t// event.dispatch('redrawDeckIndexes', _deck);\n\n\tshare.set('dragDeck',    null);\n\tshare.set('startCursor', null);\n\n}\n\n// -------------------------------------------------------------------------------------------------------------\ntry {\n\n\tdocument.onmousedown = function(e) {\n\t\tif(e.button !== 0) { return; }\n\t\tcdown(e.target, e.clientX, e.clientY);\n\t};\n\n\tdocument.onmousemove = function(e) {\n\t\tcmove(e.clientX, e.clientY);\n\t};\n\n\tdocument.onmouseup = function(e) {\n\t\tcend(e.target, e.clientX, e.clientY);\n\t};\n\n\tdocument.ondblclick = function(e) {\n\t\tcdown(e.target, e.clientX, e.clientY);\n\t\tcend(e.target, e.clientX, e.clientY, true);\n\t\tcommon.curUnLock();\n\t};\n\n\tdocument.addEventListener('touchstart', function(e) {\n\t\t// e.preventDefault()\n\t\tcdown(e.target, e.touches[0].clientX, e.touches[0].clientY)\n\t}, false);\n\n\tdocument.addEventListener('touchmove', function(e) {\n\n\t\tif(share.startCursor) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tcmove(e.touches[0].clientX, e.touches[0].clientY)\n\t}, false);\n\n\tdocument.addEventListener('touchend', function(e) {\n\t\t// e.preventDefault()\n\t\tcend(e.changedTouches[0].target, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\n\t}, false);\n} catch(e) {}\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/inputs.js\n **/","'use strict';\n\nimport share    from 'share';\nimport event    from 'event';\nimport defaults from 'defaults';\n\nimport Tips     from 'tips';\nimport Field    from 'field';\nimport History  from 'history';\n\nimport drawPreferences    from 'drawPreferences';\nimport preferencesEvents  from 'preferencesEvents';\nimport defaultPreferences from 'defaultPreferences';\n\n// event.listen('shareChange:stepType', (e) => {\n// \tconsole.log('%cshareChange:stepType', 'background-color: green;color: white;', e);\n// });\n\n// event.listen('shareChange:curLockState', (e) => {\n// \tconsole.log('%cshareChange:curLockState', 'background-color: blue;color: white;', e);\n// });\n\nevent.listen('gameInit', (e)=>{\n\n\tshare.set('stepType', defaults.stepType);\n\n\tcurUnLock();\n\t\n\tif(!e.firstInit) { return; };\n\tdrawPreferences();\n\tpreferencesEvents();\n});\n\nevent.listen('gameInited', ()=>{\n\tdefaultPreferences();\n});\n\nshare.set('prevStepType', defaults.stepType);\nevent.listen('change:stepType', ()=>{\n\tshare.set('prevStepType', share.get('stepType'));\n});\n\nevent.listen('moveEnd', function(e) {\n\tTips.checkTips();\n});\n\nevent.listen('actionBreak', function(e) {\n\tTips.checkTips();\n});\n\n// event.listen(\"saveSteps\", ()=>{\n// \tshare.set('stepType', defaults.stepType);\t\n// });\n\n// Lock/Unlock\n\nvar sqr = function(i) {\n    return i * i;\n};\n\n// --\n\nvar _lock = false;\n\nvar isLock = function() {\n\treturn _lock;\n};\n\nvar lock = function() {\n\t_lock = true;\n}\nevent.listen('lock', lock);\n\nvar unlock = function() {\n\tlock = false;\n}\nevent.listen('unlock', unlock);\n\n// --\n\nvar isCurLock = function() {\n\treturn share.get('curLockState');\n};\n\nvar curLock = function() {\n\t// !window.debug_i && (window.debug_i = 0);\n\t// window.debug_i += 1;\n\t\n\t// console.log('curLock');\n\t\n\t// if(window.debug_i == 2) {\n\t// \tthrow new Error('z');\n\t// }\n\tshare.set('curLockState', true);\n};\n\nvar curUnLock = function() {\n\t// console.log('curUnLock');\n\tshare.set('curLockState', false);\n}\n\n// getters\n\nvar getElements = function() {\n\treturn share.get('elements');\n}\n\nvar getElementById = function(a) {\n\tvar _elements = share.get('elements');\n\treturn _elements[a];\n}\n\nvar getElementsByName = function(name, type) {\n\tvar response = [];\n\tvar _elements = share.get('elements');\n\tfor(var i in _elements) {\n\t\tif(_elements[i].name && typeof _elements[i].name == 'string' && _elements[i].name == name) {\n\t\t\tif(type && typeof _elements[i].type == 'string') {\n\t\t\t\tif(type && _elements[i].type == type) {\n\t\t\t\t\tresponse.push(_elements[i]);\n\t\t\t\t} else {\n\t\t\t\t\tresponse.push(_elements[i]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresponse.push(_elements[i]);\n\t\t\t}\n\t\t}\n\t}\n\treturn response;\n};\n\n// validator\n\nvar validateCardName = function(name, nolog) {\n\t\n\tif(typeof name != 'string') {\n\t\tconsole.warn('Warning: validate name must have string type', name);\n\t\t// throw new Error('z');\n\t\treturn false;\n\t}\n\t\n\tvar suit  = name.slice(0, 1),\n\t\trank  = name.slice(1, 3),\n\t\tcolor = null,\n\t\tvalue = defaults.card.values[defaults.card.ranks.indexOf(rank)];\n\tfor(var colorName in defaults.card.colors) {\n\t\tif(defaults.card.colors[colorName].indexOf(suit) >= 0) {\n\t\t\tcolor = colorName;\n\t\t}\n\t}\n\t\n\tif( \n\t\tdefaults.card.suits.indexOf(suit) >= 0\n\t && defaults.card.ranks.indexOf(rank) >= 0\n\t) {\n\t\treturn {\n\t\t\tsuit , \n\t\t\trank ,\n\t\t\tcolor,\n\t\t\tvalue,\n\t\t\tname \n\t\t}\n\t} else {\n\t\tconsole.warn('Warning: validate name:', name, '- incorrect');\n\t\t// throw new Error();\n\t\treturn false;\n\t}\n};\n\n// ID generator\n\nvar _id = 0,\n\tgenId = function() {\n\treturn _id++;\n};\n\n// --\n\nshare.set('animation', defaults.animation);\n\nvar animationOn = function() {\n\tshare.set('animation', true);\n}\n\nvar animationDefault = function() {\n\tshare.set('animation', defaults.animation);\n}\n\nvar animationOff = function() {\n\tshare.set('animation', false);\n}\n\nevent.listen('newGame', function(e) {\n\t// TODO\n\t// из-за отключения анимации \n\t// на время восстановления ходов из истории приходится костылять\n\t// и везде где нужна анимация ставить common.animationDefault();\n\t// надо исправить когда из истории можно будет получить\n\t// не только историю ходов\n\tanimationOff();\n});\n\n// --\n\nevent.listen('historyReapeater', function(e) {\n\tif(e) {\n\t\tshare.set('noRedraw', true);\n\t\tshare.set('noTips', true);\n\t} else {\n\t\tshare.set('noRedraw', false);\n\t\tvar _field = Field();\n\t\t_field.Redraw();\n\t\tshare.set('noTips', false);\n\t\tTips.checkTips();\n\t}\n});\n\n// --\n\nlet deckInGroups = (deck, groups)=>{\n\tfor(let groupName in groups) {\n\t\tGroup.Group(groupName).hasDeck();\n\t}\n}\n\n// event.listen('makeStep', function(e) {\n\t// share.set('animation', defaults.animation);\n// });\n\nshare.set('stepType', defaults.stepType);\n\n// let clearInput = ()=>{\n//     share.set('dragDeck',    null);\n//     share.set('startCursor', null);\n// \t\tconsole.log('clearInput');\n// }\n\n// share.set('lang', defaults.lang);\n\nexport default {\n\tisLock           ,\n\tlock             ,\n\tunlock           ,\n\tisCurLock        ,\n\tcurLock          ,\n\tcurUnLock        ,\n\tgetElements      ,\n\tgetElementById   ,\n\tgetElementsByName,\n\tvalidateCardName ,\n\tgenId            ,\n\tanimationOn      ,\n\tanimationOff     ,\n\tanimationDefault ,\n\tdeckInGroups     ,\n\tsqr              \n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/common/common.js\n **/","'use strict';\n\nimport event     from 'event';\nimport share     from 'share';\nimport defaults  from 'defaults';\nimport common    from 'common';\n\nimport allToAll from 'allToAll';\nimport bestTip  from 'bestTip';\nimport Deck     from 'addDeck';\nimport Field    from 'field';\n\nvar _showTips = defaults.showTips;\n\nvar tipTypes = [\n\t'tip'        , \n\t'tipTo'      , \n\t'tipPriority',\n\t'tipToHome'\n];\n\nvar _tips = [];\n\nvar getTips = function() {\n\treturn _tips;\n}\n\nvar checkTips = function() {\n\n\tif(share.get('noTips')) { return false; }\n\n\tevent.dispatch('hideTips');\n\n\tvar _decks = Deck.getDecks({visible : true});\n\n\t_tips = allToAll({\n\t\tdecks : _decks\n\t});\n\n\tif(\n\t\t_tips.length === 0                         &&\n\t\tshare.get('stepType') == defaults.stepType\n\t) {\n\t\t\n\t\tevent.dispatch('noTips');\n\t\tconsole.log('GAME OVER (Подсказок больше нет)');\n\t}\n\n\t// var _showTips = share.get('showTips')\n\tif(_showTips) {\n\n\t\tvar _field = Field();\n\t\tvar _homeGroups = _field.homeGroups;\n\n\t\tfor(var i in _tips) {\n\n\t\t\t// TODO инициализировать \"hideTipsInDom\" в Field.js \n\t\t\tif(\n\t\t\t\t(\n\t\t\t\t\t_tips[i].to.count === 0                             &&\n\t\t\t\t\t_field.tipsParams.hideOnEmpty\n\t\t\t\t)                                                       ||\n\t\t\t\t(\n\t\t\t\t\t_field.tipsParams.excludeHomeGroups                 &&\n\t\t\t\t\t_homeGroups                                         &&\n\t\t\t\t\t_homeGroups.length                                  &&\n\t\t\t\t\t_homeGroups.indexOf(_tips[i].from.deck.parent) >= 0\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// ?#$%&!\n\t\t\t} else {\n\n\t\t\t\tevent.dispatch('showTip', {\n\t\t\t\t\tel   : _tips[i].from.card, \n\t\t\t\t\ttype : 'tip'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(_homeGroups.indexOf(_tips[i].to.deck.parent) >= 0) {\n\t\t\t\tevent.dispatch('showTip', {\n\t\t\t\t\tel   : _tips[i].from.card, \n\t\t\t\t\ttype : 'tipToHome'\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n};\n\nevent.listen('makeStep', checkTips);\nevent.listen('checkTips', checkTips);\n\n// --------------------------------------------------------\n\nvar showTips = function(a) {\n\t_showTips = true;\n\tif(a && a.init) return;\n\tcheckTips();\n};\nevent.listen('tipsON', showTips);\n\nvar hideTips = function(a) {\n\t_showTips = false;\n\tif(a && a.init) return;\n\tcheckTips();\n};\nevent.listen('tipsOFF', hideTips);\n\n// --------------------------------------------------------\n\nvar tipsMove = function(a) {\n\n\tif(!share.get('showTipPriority')) { return; }\n\n\tevent.dispatch('hideTips', {types : ['tipPriority']});\n\n\tif(\n\t\tshare.showTipPriority                       &&\n\t\ta                                           &&\n\t\ta.moveDeck                                  &&\n\t\ta.cursorMove                                &&\n\t\ta.cursorMove.distance                       &&\n\t\ta.cursorMove.distance >= share.moveDistance\n\t) {\n\n\t\tvar Tip = bestTip(a.moveDeck, a.cursorMove);\n\n\t\tif(Tip) {\n\n\t\t\tevent.dispatch('showTip', {\n\t\t\t\tel   : Tip.to.deck,\n\t\t\t\ttype : 'tipPriority'\n\t\t\t});\n\t\t}\n\t}\n};\n\n// --------------------------------------------------------\n\nvar tipsDestination = function(a) {\n\n\tif(share.get('showTipsDestination')) {\n\n\t\tevent.dispatch('hideTips');\n\t\t\n\t\tif(a && a.currentCard && a.currentCard.id) {\n\t\t\tfor(var i in _tips) {\n\t\t\t\tif(_tips[i].from.card.id == a.currentCard.id) {\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tevent.dispatch('showTip', {\n\t\t\t\t\t\t'el'   : _tips[i].to.deck, \n\t\t\t\t\t\t'type' : 'tipTo'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nlet checkFrom = (_from)=>{\n\n\tfor(let i in _tips) {\n\t\tif(\n\t\t\t_tips[i].from.deck.name == _from\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nlet fromTo = (_from, _to)=>{\n\t\n\tfor(let i in _tips) {\n\t\tif(\n\t\t\t_tips[i].from.deck.name == _from &&\n\t\t\t_tips[i].to.deck.name   == _to\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nexport default {\n\ttipTypes       ,\n\tgetTips        ,\n\tcheckTips      ,\n\tshowTips       ,\n\thideTips       ,\n\ttipsMove       ,\n//  tiprFrom       ,// TODO\n\tcheckFrom      ,\n\tfromTo         ,\n\ttipsDestination\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/tips/tips.js\n **/","'use strict';\r\n\r\nexport default (a)=>{\r\n\r\n\tlet _moves = [];\r\n\t\r\n// 4)\r\n\r\n\t// если получилось положить карты (с текущими правилами) записываем как возможный ход\r\n\tlet put = (deckIndex_2, deckIndex, cardIndex, _cards)=>{\r\n\t\t\r\n\t\tvar _cards_to = a.decks[deckIndex_2].cards,\r\n\t\t\t_card_to  = _cards_to.length ? _cards_to[_cards_to.length - 1] : null;\r\n\t\t\r\n\t\t_moves.push({\r\n\t\t\t\r\n\t\t\tfrom : {\r\n\t\t\t\tdeck     : a.decks[deckIndex],\r\n\t\t\t\tcard     : _cards[cardIndex] ,// firstCard of moved deck\r\n\t\t\t\tcount    : _cards.length\r\n\t\t\t\t// deckName : a.decks[deckIndex].name\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tto : {\r\n\t\t\t\tdeck     : a.decks[deckIndex_2],\r\n\t\t\t\tlastCard : _card_to,\r\n\t\t\t\tcount    : _cards_to.length\r\n\t\t\t\t// deckName : a.decks[deckIndex_2].name\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n// 3) ^\r\n\r\n\t// пробегаем все остальные колоды и пробуем положить на них то что взяли\r\n\tlet decksToPut = (_cards, _take, deckIndex, cardIndex)=>{\r\n\r\n\t\tfor(var deckIndex_2 in a.decks) {\r\n\r\n\t\t\tif(deckIndex != deckIndex_2) {\r\n\t\t\t\t\r\n\t\t\t\tvar _put = a.decks[deckIndex_2].Put(_take);\r\n\t\t\t\tif(_put) {\r\n\t\t\t\t\tput(deckIndex_2, deckIndex, cardIndex, _cards)\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n// 2) ^\r\n\r\n\t// выбираем карты из колоды\r\n\t// патаемся взять карту\r\n\tlet cardsInTakeDeck = (_cards, deckIndex)=>{\r\n\r\n\t\tfor(let cardIndex in _cards) {\r\n\r\n\t\t\tlet _id = _cards[cardIndex].id;\r\n\r\n\t\t\tlet _take = a.decks[deckIndex].Take(_id);\r\n\r\n\t\t\tif(_take) {\r\n\t\t\t\tdecksToPut(_cards, _take, deckIndex, cardIndex);\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n// 1) ^\r\n\r\n\t// пробегаем все колоды\r\n\tfor(let deckIndex in a.decks) {\r\n\t\t\r\n\t\tlet _cards = a.decks[deckIndex].cards;\r\n\t\t// each cards in  current deck\r\n\t\tcardsInTakeDeck(_cards, deckIndex);\r\n\t};\r\n\r\n\treturn _moves;\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/tips/allToAll.js\n **/","'use strict';\r\n\r\nimport share    from 'share';\r\nimport defaults from 'defaults';\r\nimport common   from 'common';\r\n\r\nimport Tips  from 'tips';\r\nimport Field from 'field';\r\n\r\nexport default function(moveDeck, cursorMove) {\r\n\r\n\tvar _autoTips = [];\r\n\t\r\n\t// выбрать подсказки для стопки из кторорой взяли карты\r\n\tvar _tips = Tips.getTips();\r\n\tfor(i in _tips) {\r\n\t\tif(_tips[i].from.card.id == moveDeck[0].card.id) {\r\n\t\t\t_autoTips.push(_tips[i]);\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(_autoTips.length == 0) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// move card to closest deck of a possible move\r\n\tvar _min_distance       = -1,\r\n\t\t_tip_index          = 0,\r\n\t\t_in_direction_count = 0;\r\n\r\n\t// Приоритет для homeGroups\r\n\tvar _field = Field();\r\n\tvar _homeGroups = _field.homeGroups;\r\n\t\r\n\tif(_homeGroups) {\r\n\t\tvar _tips = [];\r\n\t\tfor(var i in _homeGroups) {\r\n\t\t\tfor(var t in _autoTips) {\r\n\t\t\t\tif(_autoTips[t].to.deck.parent == _homeGroups[i]) {\r\n\t\t\t\t\t_tips.push(_autoTips[t]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(_tips.length) _autoTips = _tips;\r\n\t}\r\n\r\n\t// вариантов несколько\r\n\tif(_autoTips.length >= 2) {\r\n\r\n\t\tfor(var i in _autoTips) {\r\n\r\n\t\t\tvar center_from = {\r\n\t\t\t\tx : cursorMove.deckPosition.x + (defaults.card.width ),\r\n\t\t\t\ty : cursorMove.deckPosition.y + (defaults.card.height)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar _destination_deck_last_card_position = _autoTips[i].to.deck.padding(_autoTips[i].to.deck.cards.length);\r\n\t\t\tvar center_to = {\r\n\t\t\t\tx : _destination_deck_last_card_position.x + (defaults.card.width ),\r\n\t\t\t\ty : _destination_deck_last_card_position.y + (defaults.card.height)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_autoTips[i].distance = Math.sqrt(common.sqr(center_from.x - center_to.x) + common.sqr(center_from.y - center_to.y));\r\n\t\t\t_autoTips[i].inDirection = false;\r\n\t\t\tif(\r\n\t\t\t\t(cursorMove.direction.x > 0 && center_to.x > center_from.x)\r\n\t\t\t || (cursorMove.direction.x < 0 && center_to.x < center_from.x)\r\n\t\t\t) {\r\n\t\t\t\t_autoTips[i].inDirection = true;\r\n    \t\t\t_in_direction_count += 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tfor(var i in _autoTips) {\r\n\r\n\t\t\tif(_min_distance == '-1') {\r\n\t\t\t\tif(_in_direction_count == 0) {\r\n\t\t\t\t\t_min_distance = _autoTips[i].distance;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(_autoTips[i].inDirection) {\r\n\t\t\t\t\t\t_min_distance = _autoTips[i].distance;\r\n\t\t\t\t\t\t_tip_index = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(_autoTips[i].distance < _min_distance) {\r\n\t\t\t\tif(_in_direction_count == 0) {\r\n\t\t\t\t\t_min_distance = _autoTips[i].distance;\r\n\t\t\t\t\t_tip_index = i;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(_autoTips[i].inDirection) {\r\n\t\t\t\t\t\t_min_distance = _autoTips[i].distance;\r\n\t\t\t\t\t\t_tip_index = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn _autoTips[_tip_index]\r\n\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/tips/bestTip.js\n **/","'use strict';\r\n\r\n// module.exports = function(main, share) {\r\nimport share     from 'share';\r\nimport event     from 'event';\r\nimport defaults  from 'defaults';\r\nimport common    from 'common';\r\n\r\nimport Group        from 'addGroup';\r\nimport Deck         from 'addDeck';\r\nimport Tips         from 'tips';\r\nimport addAutoSteps from 'addAutoSteps';\r\n\r\nvar _field = null;\r\n\r\n\t// _params = {},\r\n\t// _elements = {};\r\n\r\n// TODO\r\n// class Field {}\r\nvar Field = function(data) {\r\n\r\n\tif(!data) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tcommon.unlock();\r\n\t\r\n\tif(data && _field) {\r\n\t\t\r\n\t\t_field.clear();\r\n\t} else {\r\n\t\tshare.set('elements', {});\r\n\t}\r\n\t\r\n\tvar a = null;\r\n\ttry {\r\n\t\ta = Object.assign({}, data);\r\n\t} catch(e) {\r\n\t\ta = data;\r\n\t\tconsole.warn('Field input params is not JSON, maybe the rules are wrong.');\r\n\t}\r\n\r\n\tthis.homeGroups = a.homeGroups ? a.homeGroups : [];\r\n\r\n\t// Tips\r\n\r\n\tif(typeof a.showTips == 'boolean' && a.showTips) {\r\n\t\tTips.showTips({init : true});\r\n\t} else {\r\n\t\tTips.hideTips({init : true});\r\n\t}\r\n\r\n\tshare.set('stepType', defaults.stepType);\r\n\r\n\tshare.set(\r\n\t\t'showTipsDestination', \r\n\t\ttypeof a.showTipsDestination == 'boolean' \r\n\t\t\t? a       .showTipsDestination \r\n\t\t\t: defaults.showTipsDestination\r\n\t);\r\n\tshare.set(\r\n\t\t'showTipPriority', \r\n\t\ttypeof a.showTipPriority == 'boolean' \r\n\t\t\t? a       .showTipPriority \r\n\t\t\t: defaults.showTipPriority\r\n\t);\r\n\t\r\n\tshare.set(\r\n\t\t'moveDistance', \r\n\t\ta.moveDistance && typeof a.moveDistance == 'number' \r\n\t\t\t? a.moveDistance \r\n\t\t\t: defaults.moveDistance\r\n\t);\r\n\r\n\t// check Win\r\n\r\n\tshare.set('winCheck', a.winCheck);\r\n\r\n\tif(a.winCheck && a.winCheck.callback && typeof a.winCheck.callback == 'function') {\r\n\t\twinCheckCallback = a.winCheck.callback;\r\n\t}\r\n\r\n\t// extension: winCheckMethods\r\n\r\n\tif(a.saveStep && typeof a.saveStep == 'function') {\r\n\t\tsaveStepCallback = a.saveStep;\r\n\t}\r\n\r\n\t// parameters and values\r\n\r\n\tshare.set(\r\n\t\t'zoom', \r\n\t\t(a.zoom && typeof a.zoom == 'number') \r\n\t\t\t? a.zoom \r\n\t\t\t: defaults.zoom\r\n\t);\r\n\r\n\tthis.tipsParams = {};\r\n\t\r\n\tfor(var tipParamName in defaults.tipsParams) {\r\n\t\tthis.tipsParams[tipParamName] = (a.tipsParams && typeof a.tipsParams[tipParamName] != \"undefined\")\r\n\t\t\t? a.tipsParams[tipParamName]\r\n\t\t\t: defaults.tipsParams[tipParamName]\r\n\t}\r\n\r\n\tthis.inputParams = {};\r\n\tfor(var inputParamName in defaults.inputParams) {\r\n\t\tthis.inputParams[inputParamName] = (a.inputParams && typeof a.inputParams[inputParamName] != \"undefined\")\r\n\t\t\t? a.inputParams[inputParamName]\r\n\t\t\t: defaults.inputParams[inputParamName]\r\n\t}\r\n\r\n\tvar _can_move_flip = a.can_move_flip && typeof a.can_move_flip == 'boolean' \r\n\t\t? a.can_move_flip \r\n\t\t: defaults.canMoveFlip\r\n\tshare.set('can_move_flip', _can_move_flip);\r\n\r\n\tshare.set(\r\n\t\t'debugLabels', \r\n\t\t(a.debugLabels && typeof a.debugLabels == 'boolean')\r\n\t\t\t? a.debugLabels\r\n\t\t\t: defaults.debugLabels\r\n\t);\r\n\r\n\tif(a.startZIndex && typeof a.startZIndex == 'number') {\r\n\t\tshare.set('start_z_index', a.startZIndex);\r\n\t}\r\n\r\n\tif(a.autoSteps) {\r\n\t\tthis.autoSteps = addAutoSteps(a.autoSteps);\r\n\t}\r\n\r\n\tif(typeof a.lang == \"string\") {\r\n\t\tshare.set('lang', a.lang);\r\n\t};\r\n\r\n// --\r\n\r\n\tthis.Draw = function(data) {\r\n\r\n\t\tshare.set('noRedraw',  true);\r\n\r\n\t\tif(data) {\r\n\t\t\ta = Object.assign({}, data);\r\n\t\t} \r\n\r\n\t\tif(!a) return;\r\n\t\t\r\n\t\tif(a.groups) {\r\n\t\t\tfor(var groupName in a.groups) {\r\n\t\t\t\ta.groups[groupName].name = groupName;\r\n\t\t\t\tGroup.addGroup(a.groups[groupName]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(a.decks) {\r\n\t\t\tfor(var e in a.decks) {\r\n\t\t\t\tDeck.addDeck(a.decks[e]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// fill elements in field\r\n\t\tif(a.fill) {\r\n\t\t\t\r\n\t\t\tvar _decks = Deck.getDecks(),\r\n\t\t\t\t_fill  = Object.assign([], a.fill);\r\n\r\n\t\t\tfor(;_fill.length;) {\r\n\t\t\t\tfor(var deckId in _decks) {\r\n\t\t\t\t\tif(_fill.length) {\r\n\t\t\t\t\t\tvar _card = _fill.shift();\r\n\t\t\t\t\t\t_decks[deckId].Fill([_card]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tshare.set('noRedraw',  false);\r\n\t\tthis.Redraw();\r\n\t\t\r\n\t\tTips.checkTips();\r\n\r\n\t\tevent.dispatch('newGame');\r\n\t\tcommon.unlock();\r\n\r\n\t}\r\n};\r\n\r\nField.prototype.clear = function() {\r\n\t\r\n\tvar _elements = share.get('elements');\r\n\tfor(var i in _elements) {\r\n\t\tif(_elements[i].type == 'deck') {\r\n\t\t\t_elements[i].clear();\r\n\t\t\t_elements[i] = null;\r\n\t\t} else if(_elements[i].type == 'group') {\r\n\t\t\t_elements[i] = null;\r\n\t\t}\r\n\t}\r\n\tshare.set('elements', {});\r\n};\r\n\r\nField.prototype.Redraw = function(data) {\r\n\t\t\r\n\tvar a = null;\r\n\r\n\tif(data) {\r\n\r\n\t\ttry {\r\n\t\t\ta = Object.assign({}, data);\r\n\t\t} catch(e) {\r\n\t\t\ta = data;\r\n\t\t\tconsole.warn('Field.Redraw input params is not JSON, can\\'t clone');\r\n\t\t}\r\n\r\n\t\tfor(var _groupName in a.groups) {\r\n\r\n\t\t\tvar _group = Group.Group(_groupName);\r\n\t\t\tif(_group) {\r\n\t\t\t\t_group.Redraw(a.groups[_groupName]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor(var i in a.decks) {\r\n\t\t\t\r\n\t\t\tvar _deck = Deck.Deck(a.decks[i].name);\r\n\t\t\tif(_deck) {\r\n\t\t\t\t_deck.Redraw(a.decks[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} else {\r\n\t\tvar _decks = Deck.getDecks();\r\n\t\tfor(var i in _decks) {\r\n\t\t\t_decks[i].Redraw();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nvar _fieldExport = function(data) {\r\n\r\n\tif(data && _field) {// TODO THIS\r\n\t\t\r\n\t\t_field.clear();\r\n\t\t_field.Draw(data);\r\n\t}\r\n\r\n\tif(data && !_field) {\r\n\r\n\t\t_field = new Field(data);\r\n\t\tevent.dispatch('initField', {a : data});\r\n\t\t_field.Draw();\r\n\t};\r\n\t\r\n\t// this = _field\r\n\treturn _field;\r\n};\r\n\r\n// _fieldExport.prototype.Redraw = function() {\r\n// \t_field.Redraw();\r\n// };\r\n\r\nexport default _fieldExport;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/field.js\n **/","'use strict';\r\n\r\nimport event          from 'event';\r\nimport share          from 'share';\r\nimport defaults       from 'defaults';\r\nimport common         from 'common';\r\n\r\nimport Deck           from 'addDeck';\r\nimport groupFill      from 'groupFill';\r\nimport groupRedraw    from 'groupRedraw';\r\nimport groupGenerator from 'groupGenerator';\r\n\r\nconst params = {\r\n\t\"paddingType\"  : {type: \"any\"    },\r\n\t\"flip\"         : {type: \"any\"    },\r\n\t\"showSlot\"     : {type: \"any\"    },\r\n\t\"takeRules\"    : {type: \"any\"    },\r\n\t\"putRules\"     : {type: \"any\"    },\r\n\t\"fillRule\"     : {type: \"any\"    },\r\n\t\"autoHide\"     : {type: \"any\"    },\r\n\t\"paddingX\"     : {type: \"any\"    },\r\n\t\"paddingY\"     : {type: \"any\"    },\r\n\t\"flipPaddingX\" : {type: \"any\"    },\r\n\t\"flipPaddingY\" : {type: \"any\"    },\r\n\t\"actions\"      : {type: \"any\"    }\r\n//  \"afterStep\"    : {type: \"boolean\"}\r\n};\r\n\r\nclass groupClass {\r\n\t\r\n\tconstructor(a, _id) {\r\n\t\t\r\n\t\tthis.type = 'group';\r\n\t\t\r\n\t\tvar id = _id;\r\n\t\t\r\n\t\tthis.getId = function() {\r\n\t\t\treturn id;\r\n\t\t}\r\n\r\n\t\tthis.name = a.name && typeof a.name == 'string' \r\n\t\t\t? a.name \r\n\t\t\t: ('name_' + id);\r\n\t\t\r\n\t\tthis.position = {\r\n\t\t\tx : a.position && a.position.x && typeof a.position.x == 'number' \r\n\t\t\t\t? a.position.x \r\n\t\t\t\t: 0,\r\n\t\t\ty : a.position && a.position.y && typeof a.position.y == 'number' \r\n\t\t\t\t? a.position.y \r\n\t\t\t\t: 0,\r\n\t\t};\r\n\r\n\t\tthis.placement = a.placement \r\n\t\t\t? {\r\n\t\t\t\tx : a.placement.x \r\n\t\t\t\t\t? a.placement.x \r\n\t\t\t\t\t: 0, \r\n\t\t\t\ty : a.placement.y \r\n\t\t\t\t\t? a.placement.y \r\n\t\t\t\t\t: 0\r\n\t\t\t} \r\n\t\t\t: null\r\n\r\n\t\tthis.decks = {};\r\n\t\t\r\n\t\t// сохраняем атрибуты чтобы прокинуть их колодам\r\n\t\tthis.parameters = {};\r\n\t\tfor(let paramName in params) {\r\n\t\t\tif(params[paramName].type == \"any\") {\r\n\t\t\t\tthis.parameters[paramName] = a[paramName] ? a[paramName] : defaults[paramName];\r\n\t\t\t} else if(params[paramName].type == \"boolean\") {\r\n\t\t\t\tthis.parameters[paramName] = typeof a[paramName] == \"boolean\" ? a[paramName] : defaults[paramName];\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.deckIndex = [];\r\n\r\n\t}\r\n\r\n// --------------------------------------------------------------------\r\n\r\n\t// Add deck to group\r\n\taddDeck(a) {\r\n\r\n\t\tif(!a) return;\r\n\t\t\r\n\t\tif(!a.position) {\r\n\t\t\ta.position = {\r\n\t\t\t\t'x' : 0, \r\n\t\t\t\t'y' : 0\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// сортировка элементов в группе по заданному индексу и порядку добавления\r\n\t\t\r\n\t\t// if(!a.position.x) { a.position.x = 0; }\r\n\t\t// if(!a.position.y) { a.position.y = 0; }\r\n\r\n\t\tif(!a.parent) a.parent = this.name;\r\n\t\t\r\n\t\ta.parentPosition = {\r\n\t\t\tx : this.position.x, \r\n\t\t\ty : this.position.y\r\n\t\t};\r\n\t\t\r\n\t\t// расставляем колоды в группе\r\n\t\t// 1 приоретет отдаётся параметру groupIndex\r\n\t\t// остальные вставляются в промежутки или добавляются в конец\r\n\t\tvar _index = 0;\r\n\t\t\r\n\t\tif( a.groupIndex \r\n\t\t && typeof a.groupIndex == 'number' \r\n\t\t && this.deckIndex[a.groupIndex - 1] \r\n\t\t && decks[ this.deckIndex[a.groupIndex - 1] ].this.deckIndex == a.this.deckIndex\r\n\t\t) {\r\n\t\t\tconsole.warn('Warning: duplicate groupIndex', a.groupIndex, 'changed to null');\r\n\t\t\ta.groupIndex = null;\r\n\t\t}\r\n\r\n\t\tif(a.groupIndex && typeof a.groupIndex == 'number') {\r\n\r\n\t\t\tif(this.deckIndex[a.groupIndex - 1]) {\r\n\t\t\t\t\r\n\t\t\t\tfor(;typeof this.deckIndex[_index] != 'undefined';_index += 1) {}\r\n\t\t\t\t\r\n\t\t\t\tif(placement) {\r\n\t\t\t\t\tvar _index    = this.deckIndex[a.groupIndex - 1];\r\n\t\t\t\t\tvar _elements = share.get('elements');\r\n\t\t\t\t\tif(placement.x) {\r\n\t\t\t\t\t\t_elements[_index].x( this.position.x + (placement.x + defaults.card.width) * _index );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(placement.y) {\r\n\t\t\t\t\t\t_elements[_index].y( this.position.y + (placement.y + defaults.card.width) * _index );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tshare.set('elements', _elements);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.deckIndex[_index] = this.deckIndex[a.groupIndex - 1];\r\n\t\t\t\tthis.deckIndex[a.groupIndex - 1] = true;\r\n\t\t\t\t_index = a.groupIndex - 1\r\n\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\tthis.deckIndex[a.groupIndex - 1] = true;\r\n\t\t\t\t_index = a.groupIndex - 1\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tfor(;typeof this.deckIndex[_index] != 'undefined';_index += 1) {};\r\n\t\t\tthis.deckIndex[_index] = true;\r\n\t\t}\r\n\t\t\r\n\t\t// смещаем координаты колод относиткльно координад группы\r\n\t\tif(this.placement) {\r\n\r\n\r\n\t\t\tif(this.placement.x) {\r\n\t\t\t\ta.position.x = (this.placement.x + defaults.card.width)  * (_index);\r\n\t\t\t}\r\n\t\t\tif(this.placement.y) {\r\n\t\t\t\ta.position.y = (this.placement.y + defaults.card.height) * (_index);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// прокидываем некоторые атрибуты всем колодам группы (у атрибутов заданных колоде приоритет выше)\r\n\t\tfor(let paramName in params) {\r\n\t\t\t\r\n\t\t\tif(params[paramName].type == \"any\") {\r\n\t\t\t\tif(\r\n\t\t\t\t\tthis.parameters[paramName]\r\n\t\t\t\t && typeof a[paramName] == \"undefined\"\r\n\t\t\t\t) {\r\n\t\t\t\t\ta[paramName] = this.parameters[paramName];\r\n\t\t\t\t};\r\n\t\t\t} else if(params[paramName].type == \"boolean\") {\r\n\t\t\t\tif(\r\n\t\t\t\t\ttypeof this.parameters[paramName] != \"undefined\"\r\n\t\t\t\t && typeof a[paramName] == \"undefined\"\r\n\t\t\t\t) {\r\n\t\t\t\t\ta[paramName] = this.parameters[paramName];\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar _el = Deck.addDeck(a);\r\n\t\t\r\n\t\tthis.deckIndex[_index]  = _el.getId();\r\n\t\tthis.decks[_el.getId()] = _el;\r\n\t}\r\n\r\n\t// Fill group\r\n\tFill(cardNames) {\r\n\t\tgroupFill.call(this, cardNames);\r\n\t}\r\n\r\n\tgetDeckById(id) {\r\n\t\treturn this.decks[id];\r\n\t}\r\n\r\n\tgetDecksByName(name) {\r\n\t\tvar _decks = {};\r\n\t\tfor(let d in this.decks) {\r\n\t\t\tif(this.decks[d].name == name) {\r\n\t\t\t\t_decks[d] = decks[d];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn _decks;\r\n\t}\r\n\r\n\t// Get decks from group\r\n\tgetDecks(a) {\r\n\t\tvar _decks = [];\r\n\t\tfor(let i in this.decks) {\r\n\t\t\tif(a && a.visible) {\r\n\t\t\t\tif(this.decks[i].visible) {\r\n\t\t\t\t\t_decks.push(this.decks[i]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t_decks.push(this.decks[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn _decks;\r\n\t}\r\n\r\n\t// Redraw group\r\n\tRedraw(_a) {\r\n\t\tgroupRedraw.call(this, _a);\r\n\t}\r\n\r\n\thasDeck(deckName) {\r\n\t\tlet has = false;\r\n\t\tfor(let deckId in decks) {\r\n\t\t\tif(decks[deckId].name == deckName) {\r\n\t\t\t\thas = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn has;\r\n\t}\r\n\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------------------------------------\r\n\r\nvar addGroup = function(a) {\r\n\r\n\tif(!a) return false;\r\n\tvar _id = 'group_' + common.genId();\r\n\t\r\n\tvar _el_group = new groupClass(a, _id);\r\n\r\n\tif(a.decks) {\r\n\t\t\r\n\t\tif(typeof a.decks == 'number') {\r\n\t\t\ta.decks = {\r\n\t\t\t\t\"generator\" : {\r\n\t\t\t\t\t\"type\"  : \"count\",\r\n\t\t\t\t\t\"count\" : a.decks\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\tif(a.decks.generator) {\r\n\t\t\t\r\n\t\t\tif(a.decks.generator.type) {\r\n\t\t\t\t\r\n\t\t\t\tif(groupGenerator[a.decks.generator.type]) {\r\n\t\t\t\t\r\n\t\t\t\t\ta.decks = groupGenerator[a.decks.generator.type].call(_el_group, a.decks.generator);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn('Deck generator type \"' + a.decks.generator.type + '\" not found.');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('Deck generator type is null.');\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\r\n\t\t\ta.placement = null;\r\n\r\n\t\t};\r\n\r\n\t\t// relations TO <-> FROM\r\n\t\t// if( a.backRelations ) TODO\r\n\t\tfor(let to in a.decks) {\r\n\r\n\t\t\tfor(let relId in a.decks[to].relations) {\r\n\r\n\t\t\t\tlet _relation = Object.assign({}, a.decks[to].relations[relId]);\r\n\r\n\t\t\t\tfor(let from in a.decks) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(a.decks[from].name == _relation.to) {\r\n\t\t\t\t\t\t_relation.to = null;\r\n\t\t\t\t\t\t_relation.from = a.decks[to].name;\r\n\t\t\t\t\t\ta.decks[from].relations.push(_relation)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor(let d in a.decks) {\r\n\t\t\t_el_group.addDeck(a.decks[d]);\r\n\t\t};\r\n\t};\r\n\r\n\tvar _elements = share.get('elements');\r\n\t_elements[_id] = _el_group;\r\n\tshare.set('elements', _elements);\r\n\t\r\n\t// fill group\r\n\tif(a && a.fill) {\r\n\r\n\t\tvar _checkFillDeck = a.fill.length;\r\n\t\tif(_checkFillDeck) {\r\n\t\t\t_el_group.Fill(a.fill);\r\n\t\t}\r\n\t}\r\n\r\n\treturn _el_group;\r\n};\r\n\r\nvar Group = function(name) {\r\n\treturn common.getElementsByName(name, 'group')[0];\r\n};\r\n\t\r\nexport default {\r\n\taddGroup,\r\n\tGroup\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/addGroup.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport defaults from 'defaults';\nimport common   from 'common';\n\nimport flipTypes      from 'flipTypes';\nimport readyPutRules  from 'readyPutRules';\nimport readyTakeRules from 'readyTakeRules';\nimport fillRules      from 'fillRules';\nimport paddingTypes   from 'paddingTypes';\nimport deckActions    from 'deckActions';\nimport Take           from 'deckTake';\nimport Put            from 'deckPut';\nimport genCardByName  from 'genCardByName';\nimport Group          from 'addGroup';\nimport History        from 'history';\n\nimport getDecks      from 'getDecks';\nimport getDeckById   from 'getDeckById';\nimport deckCardNames from 'deckCardNames';\nimport getDeck       from 'getDeck';\n\nclass deckClass {\n\n\tconstructor(a, _id) {\n\n\t\tif(!a) return false;\n\n\t\tthis.cards = [];\n\t\t\n\t\tthis.getTopCard = function() {\n\n\t\t\tif(this.cards.length === 0) { return false; }\n\t\t\treturn this.cards[this.cards.length - 1];\n\t\t}\n\t\t\n\t\t// parameters\n\t\tthis.type = 'deck';\n\t\tthis.fill = false;\n\t\tvar id = _id;\n\n\t\tthis.getId = function() {\n\t\t\treturn id;\n\t\t}\n\n\t\tthis.locked = a.locked ? true : false;\n\n\t\tvar _parent_el   = Group.Group(a.parent),\n\t\t\t_parent_name = _parent_el ? _parent_el.name : 'xname',// ???\n\t\t\t_new_id      = _parent_el ? _parent_el.getDecks().length : id;\n\t\t\n\t\tthis.name = a.name && typeof a.name == 'string' \n\t\t\t? a.name \n\t\t\t: (_parent_name + '_' + _new_id);\n\t\t\n\t\tthis.visible= a.visible && typeof a.visible == 'boolean' ? a.visible : true;// default true\n\t\t\n\t\tthis.groupIndex = a.groupIndex && typeof a.groupIndex == 'number' ? a.groupIndex : null;\n\n\t\tthis.parent= a.parent && typeof a.parent == 'string'  ? a.parent : 'field';\n\t\t\n\t\tthis.autoHide = a.autoHide && typeof a.autoHide == 'boolean' ? a.autoHide : defaults.autohide;\n\t\t\n\t\t// changed parameters\n\t\tif(typeof a.showSlot == \"undefined\") {\n\t\t\ta.showSlot = defaults.showSlot;\n\t\t}\n\t\t\n\t\t// DOM\n\t\tvar params = {};\n\t\tparams.x              = 0; \n\t\tparams.y              = 0; \n\t\tparams.rotate         = this.rotate = 0; \n\t\tparams.padding_y      = ( a.paddingY     && typeof a.paddingY     == 'number' ) ? a.paddingY     : defaults.padding_y;\n\t\tparams.flip_padding_y = ( a.flipPaddingY && typeof a.flipPaddingY == 'number' ) ? a.flipPaddingY : defaults.flip_padding_y;\n\t\tparams.padding_x      = ( a.paddingX     && typeof a.paddingX     == 'number' ) ? a.paddingX     : defaults.padding_x;\n\t\tparams.flip_padding_x = ( a.flipPaddingX && typeof a.flipPaddingX == 'number' ) ? a.flipPaddingX : defaults.flip_padding_x;\n\t\tparams.startZIndex    = ( a.startZIndex  && typeof a.startZIndex  == 'number' ) ? a.startZIndex  : defaults.startZIndex;\n\t\t\n\t\t// ------------- FLIP -------------\n\t\t\n\t\tvar flipType = a.flip && typeof a.flip == 'string' \n\t\t\t? a.flip \n\t\t\t: defaults.flip_type,\n\t\t\tcheckFlip = flipTypes[flipType];\n\n\t\tthis.flipCheck = function() {\n\t\t\tfor(var i in this.cards) {\n\t\t\t\tcheckFlip(this.cards[i], i|0, this.cards.length);\n\t\t\t}\n\t\t\tevent.dispatch('redrawDeckFlip', this);\n\t\t}\n\t\t\n\t\t// ------------- PUT -------------\n\n\t\tthis.putRules = a.putRules \n\t\t\t? typeof a.putRules == 'function' \n\t\t\t\t? a.putRules\n\t\t\t\t: typeof a.putRules == 'string' \n\t\t\t\t\t? readyPutRules[a.putRules] \n\t\t\t\t\t\t? readyPutRules[a.putRules]\n\t\t\t\t\t\t: readyPutRules[defaults.putRule]\n\t\t\t\t\t// : typeof a.putRules === 'object' \n\t\t\t\t\t: a.putRules.constructor == Array \n\t\t\t\t\t\t? a.putRules\n\t\t\t\t\t\t: readyPutRules[defaults.putRule]\n\t\t\t: readyPutRules[defaults.putRule];\n\n\t\t// ------------- TAKE -------------\n\t\t\n\t\t// можно ли взять карту/стопку\n\t\tthis.takeRules = a.takeRules;\n\n\t\t// ------------- FILL -------------\n\t\t\n\t\t// var fillRule = (\n\t\t// \ta.fillRule \n\t\t//  && typeof a.fillRule == \"string\" \n\t\t//  && typeof fillRules[a.fillRule] == \"function\"\n\t\t// ) ? fillRules[a.fillRule]\n\t\t//   : fillRules['not'];\n\n\t\tthis.fillRules = null;\n\n\t\tif(a.fillRule && !a.fillRules) {\n\t\t\ta.fillRules = [a.fillRule];\n\t\t}\n\n\t\tif(a.fillRules) {\n\t\t\tthis.fillRules = a.fillRules;\n\t\t}\n\t\t\n\t\t// ------------- PADDING -------------\n\t\t\n\t\t// порядок карт в колоде\n\t\tvar padding = a.paddingX || a.paddingY\n\t\t\t? paddingTypes.special \n\t\t\t: a.paddingType \n\t\t\t\t? (typeof a.paddingType == 'string' && paddingTypes[a.paddingType]) \n\t\t\t\t\t? paddingTypes[a.paddingType] \n\t\t\t\t\t: paddingTypes.none\n\t\t\t\t: paddingTypes[defaults.paddingType];\n\n\t\tthis.padding = function(index) {\n\t\t\tvar _padding = padding(params, this.cards[index], index, this.cards.length, this.cards);\n\t\t\treturn _padding;\n\t\t}\n\t\t\n\t\tthis.actions = [];\n\n\t\tif(a.actions) {\n\t\t\tthis.actions = a.actions;\n\t\t\tdeckActions.addActions.call(this);\n\t\t}\n\n\t\t// this.afterStep = a.afterStep;\n\n\t\t// ------------ RELATIONS ------------\n\n\t\tif(a.relations) {\n\t\t\tthis.relations = a.relations;\n\t\t} else {\n\t\t\tthis.relations = [];\n\t\t}\n\n\t\t// --\n\n\t\tthis.tags = a.tags ? a.tags : [];\n\t\t\n\t\t// --\n\n\t\tevent.dispatch('addDeckEl', {\n\t\t\ta     : a, \n\t\t\tdeck  : this,\n\t\t\tparams: params\n\t\t});\n\n\t\tlet _callback = (data)=>{\n\n\t\t\t// TODO\n\t\t\t// проверять fill только для тех стопок котрые участвовали в Action\n\t\t\t\n\t\t\tif(data.destination.name != this.name) { return; }\n\n\t\t\t// console.log('_callback', this.checkFill, this.fillRules);\n\n\t\t\tthis.checkFill();\n\t\t\t\n\t\t\t// var _deck = data.destination;\n\t\t\t\n\t\t\t// if(_deck && !this.fill && this.callback({deck : _deck})) {\n\t\t\t// \tthis.deck.fill = true;\n\t\t\t// \tHistory.add({fill : {\n\t\t\t// \t\tdeck : this.deck.name\n\t\t\t// \t}});\n\t\t\t// \t// event.dispatch('fillDeck', {deck : this.deck});\n\t\t\t// }\n\t\t};\n\t\tevent.listen('moveDragDeck', _callback);\n\n\t\tthis.Redraw = function(data) {\n\t\t\t\n\t\t\tevent.dispatch('redrawDeck', {\n\t\t\t\tdeck   : this,\n\t\t\t\tdata   : data,\n\t\t\t\tparams : params,\n\t\t\t\tcards  : this.cards\n\t\t\t});\n\t\t};\n\n\t}\n\n// -------------------------------------------------------------------------------------------------\n\n\tcheckFill() {\n\n\t\tif(!this.fill) {\n\n\t\t\tlet notFill = true;\n\t\t\t\n\t\t\tfor(let ruleName in this.fillRules) {\n\n\t\t\t\tif(fillRules[ruleName]) {\n\t\t\t\t\tnotFill = notFill && !fillRules[ruleName](this);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.fill = !notFill;\n\t\t}\n\t}\n\n\tFill(cardNames) {\n\n\t\tfor(var i in cardNames) {\n\t\t\tthis.genCardByName(cardNames[i]);\n\t\t}\n\t}\n\n\tclear() {\n\t\tfor(var i in this.cards) {\n\t\t\tevent.dispatch('removeEl', this.cards[i]);\n\t\t\tthis.cards[i] = null;\n\t\t}\n\t\tthis.cards = [];\n\t\tevent.dispatch('removeEl', this);\n\t}\n\n\tPush(deck) {// , parentName) {\n\t\tfor(var i in deck) {\n\t\t\tdeck[i].parent = this.getId();\n\t\t\tthis.cards.push(deck[i]);\n\t\t}\n\t}\n\n\tPop(count, clearParent) {\n\t\t\t\n\t\tif(this.cards.length < count) return false;\n\n\t\tvar _deck = [];\n\t\tfor(;count;count -= 1) {\n\t\t\tvar _pop = this.cards.pop();\n\t\t\tif(clearParent) _pop.parent = null;\n\t\t\t_deck.push(_pop);\n\t\t\t_deck[_deck.length - 1].parent = null;\n\t\t}\n\t\t_deck.reverse();\n\n\t\t// что делать если вынули все карты\n\t\tif(this.autoHide && this.cards.length === 0) {\n\t\t\tthis.hide();\n\t\t}\n\t\t\n\t\tthis.Redraw();\n\n\t\treturn _deck;\n\t}\n\n\tTake(cardId) {\n\t\treturn Take.call(this, cardId);// ??? .call(this, attributes);\n\t}\n\n// проверяем, можем ли положить стопку/карту\n// возвращает true, если согласно правилам сюда можно положить карту\n\tPut(putDeck) {\n\t\treturn Put.call(this, putDeck);//(deckConstructor);\n\t}\n\n// создать карту\n\tgenCardByName(name) {\n\t\treturn genCardByName.call(this, name);\n\t}\n\n\thide() {\n\t\tthis.visible = false;\n\t\tHistory.add({hideDeck : this.name});\n\t\tthis.Redraw();\n\t}\n\n\tshow() {\n\t\tthis.visible = false;\n\t\tHistory.add({showDeck : this.name});\n\t\tthis.Redraw();\n\t}\n\n\tgetCardsByName(cardName) {\n\t\tvar _cards = [];\n\t\tfor(var i in this.cards) {\n\t\t\tif(this.cards[i].name == cardName) {\n\t\t\t\t_cards.push(this.cards[i]);\n\t\t\t}\n\t\t}\n\t\treturn _cards;\n\t}\n\n\tCard(cardName) {\n\t\treturn this.getCardsByName(cardName)[0];\n\t}\n\n\thideCards() {\n\t\tfor(var i in this.cards) {\n\t\t\tthis.cards[i].visible = false;\n\t\t\tevent.dispatch('hideCard', this.cards[i]);\n\t\t}\n\t}\n\n\tshowCards() {\n\t\tfor(var i in this.cards) {\n\t\t\tthis.cards[i].visible = true;\n\t\t\tevent.dispatch('showCard', this.cards[i]);\n\t\t}\n\t}\n\n\tgetCardsNames() {\n\t\tvar _cardsNames = [];\n\t\tfor(var i in this.cards) {\n\t\t\t_cardsNames.push(this.cards[i].name);\n\t\t}\n\t\treturn _cardsNames;\n\t}\n\n\tcardsCount() {\n\t\treturn this.cards.length;\n\t}\n\n\tgetRelationsByName(relationName, filter) {\n\n\t\tlet _relations = [];\n\n\t\tfor(let i in this.relations) {\n\t\t\tif(this.relations[i].name == relationName) {\n\n\t\t\t\tif(filter) {\n\n\t\t\t\t\tlet _checked = 0, _count = 0;\n\n\t\t\t\t\tfor(let attr in filter) {\n\t\t\t\t\t\t_count += 1;\n\t\t\t\t\t\tif(this.relations[i][attr] == filter[attr]) {\n\t\t\t\t\t\t\t_checked += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(_checked == _count) {\n\t\t\t\t\t\t_relations.push(this.relations[i]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\t_relations.push(this.relations[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn _relations;\n\t}\n\n\thasTag(tagName) {\n\n\t\tfor(let i in this.tags) {\n\t\t\tif(this.tags[i] == tagName) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n}\n\n// ------------------------------------------------------------------------------------------------------------------------------------------\n\nvar addDeck = function(a) {\n\n\tif(!a) return false;\n\t\n\tvar _id = 'deck_' + common.genId();\n\t\n\tvar _a = Object.assign({}, a);\n\t\n\tvar _el_deck = new deckClass(_a, _id);\n\n\t// fill deck\n\tif(a.fill) {\n\t\tfor(var i in a.fill) {\n\t\t\tif(typeof a.fill[i] == 'string') {\n\t\t\t\t_el_deck.genCardByName(a.fill[i]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvar _elements = share.get('elements');\n\n\t_elements[_id] = _el_deck;\n\t\n\tshare.set('elements', _elements);\n\n\treturn _el_deck;\n};\n\nexport default {\n\taddDeck       ,\n\tDeck : getDeck,\n\tgetDecks      ,\n\tgetDeckById   ,\n\tdeckCardNames\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/addDeck.js\n **/","'use strict';\r\n\r\nexport default {\r\n\tnone    : function(card, i, length) {\r\n\t\tcard.flip = false;\r\n\t},\r\n\tall     : function(card, i, length) {\r\n\t\tcard.flip = true;\r\n\t},\r\n\tnotlast : function(card, i, length) {\r\n\t\tcard.flip = (i < length - 1) ? true : false;\r\n\t},\r\n\tfirst_1 : function(card, i, length) {\r\n\t\tcard.flip = (i < 1) ? true : false;\r\n\t},\r\n\tfirst_2 : function(card, i, length) {\r\n\t\tcard.flip = (i < 2) ? true : false;\r\n\t},\r\n\tfirst_3 : function(card, i, length) {\r\n\t\tcard.flip = (i < 3) ? true : false;\r\n\t},\r\n\tbee     : (card, i, length) => {\r\n\t\tcard.flip = (i == length - 1) ? false : (i % 2 == 0) ? true : false;\r\n\t}\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/flipTypes.js\n **/","'use strict';\r\n\r\nimport common   from 'common';\r\nimport defaults from 'defaults';\r\n\r\nimport Deck      from 'addDeck';\r\nimport getBeside from 'getBeside';\r\n\r\nvar rpr = {\r\n\t\t\t\r\n\r\n\t// Realtions filters\r\n\r\n\tlinePrev: (a)=>{\r\n\r\n\t\tlet prev = getBeside(a.to).prev;\r\n\r\n\t\tif(prev) {\r\n\t\t\t\r\n\t\t\ta.link = prev.to;\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\tlineNext: (a)=>{\r\n\t\t\r\n\t\tlet next = getBeside(a.to).next;\r\n\r\n\t\tif(next) {\r\n\t\t\t\r\n\t\t\ta.link = next.to;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// Internal use\r\n\r\n\t_downupcards: (a)=>{\r\n\r\n\t\tif(a.cards.length == 0) return false;\r\n\t\t\r\n\t\tlet down = common.validateCardName(a.cards[a.cards.length  - 1].name);\r\n\t\tlet up   = common.validateCardName(a.putDeck[0].card.name);\r\n\t\t\r\n\t\tif(!down || !up) return false;\r\n\t\t\r\n\t\treturn {\r\n\t\t\tup   : up,\r\n\t\t\tdown : down\r\n\t\t}\r\n\t},\r\n\r\n\t_downupranknum: (a)=>{\r\n\r\n\t\tlet du = rpr._downupcards(a);\r\n\t\t\r\n\t\treturn du ? {\r\n\t\t\tdown : defaults.card.ranks.indexOf(du.down.rank),\r\n\t\t\tup   : defaults.card.ranks.indexOf(du.up.rank)\r\n\t\t} : false;\r\n\t},\r\n\r\n\t_isFirst: (a, _name)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) {\r\n\t\t\r\n\t\t\tlet _validate = null;\r\n\t\t\t\r\n\t\t\treturn (\r\n\t\t\t\t(_validate = common.validateCardName(a.putDeck[0].card.name))\r\n\t\t\t && _validate.rank == _name\r\n\t\t\t);\r\n\t\t}\r\n\t \t\r\n\t \treturn true;\r\n\t},\r\n\r\n\t// Rules\r\n\r\n\tstriped: (a)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet color_A   = common.validateCardName(a.cards[a.cards.length - 1].name).color,\r\n\t\t\tcolor_B   = null,\r\n\t\t\t_validate = null;\r\n\t\t\r\n\t\tif(_validate = common.validateCardName(a.putDeck[0].card.name)) {\r\n\t\t\tcolor_B = _validate.color;\r\n\t\t}\r\n\t\t\r\n\t\treturn color_A != color_B;\r\n\t},\r\n\r\n\tfirstAce: (a)=>{\t\t\t\r\n\t\t\r\n\t\t// let _rank = defaults.card.ranks[0];\r\n\t\t\r\n\t\treturn rpr._isFirst(a, \"1\");\r\n\t},\r\n\r\n\tfirstKing: (a)=>{\r\n\t\t\r\n\t\t// let _rank = defaults.card.ranks[defaults.card.ranks.length - 1];\r\n\r\n\t\treturn rpr._isFirst(a, \"k\");\r\n\t},\r\n\r\n\tnotForEmpty: (a)=>{\r\n\t\t\r\n\t\treturn a.cards.length;\r\n\t},\r\n\r\n\tonlyEmpty: (a)=>{\r\n\r\n\t\treturn a.cards.length === 0;\r\n\t},\r\n\r\n\toneRank: (a)=>{\r\n\r\n\t\tif(a.cards.length == 0) return true;\r\n\t\t\r\n\t\tlet du = rpr._downupcards(a);\r\n\t\t\r\n\t\treturn du && du.up.rank == du.down.rank;\r\n\t},\r\n\t\r\n\toneSuit: (a)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\t\t\r\n\t\tlet du = rpr._downupcards(a);\r\n\t\t\r\n\t\treturn du && du.up.suit == du.down.suit;\r\n\t},\r\n\r\n\tany: (a)=>{\r\n\t\t\r\n\t\treturn true;\r\n\t},\r\n\r\n\tnot: (a)=>{\r\n\t\t\r\n\t\treturn false;\r\n\t},\r\n\r\n\tascendDeck: (a)=>{//ascend deck by step\r\n\t\t\r\n\t\tif(a.putDeck.length == 1) return true;\r\n\t\t\r\n\t\tlet ruleCorrect = true;\r\n\t\t\r\n\t\tfor(let i in a.putDeck) {\r\n\r\n\t\t\tif(i > 0) {\r\n\r\n\t\t\t\tlet down = defaults.card.ranks.indexOf(\r\n\t\t\t\t\t\tcommon.validateCardName(a.putDeck[i - 1].card.name).rank\r\n\t\t\t\t\t),\r\n\t\t\t\t\tup   = defaults.card.ranks.indexOf(\r\n\t\t\t\t\t\tcommon.validateCardName(a.putDeck[i].card.name).rank\r\n\t\t\t\t\t);\r\n\t\t\t\t\r\n\t\t\t\truleCorrect = ruleCorrect && 1 + down == up;\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\treturn ruleCorrect;\r\n\t},\r\n\r\n\tdescendDeck: (a)=>{//ascend deck by step\r\n\t\t\r\n\t\tif(a.putDeck.length == 1) return true;\r\n\t\t\r\n\t\tlet ruleCorrect = true;\r\n\t\t\r\n\t\tfor(let i in a.putDeck) {\r\n\t\t\t\r\n\t\t\tif(i > 0) {\r\n\r\n\t\t\t\tlet down = defaults.card.ranks.indexOf(\r\n\t\t\t\t\t\tcommon.validateCardName(a.putDeck[i - 1].card.name).rank\r\n\t\t\t\t\t),\r\n\t\t\t\t\tup   = defaults.card.ranks.indexOf(\r\n\t\t\t\t\t\tcommon.validateCardName(a.putDeck[i].card.name).rank\r\n\t\t\t\t\t);\r\n\t\t\t\t\r\n\t\t\t\truleCorrect = ruleCorrect && down == 1 + up;\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\treturn ruleCorrect;\r\n\t},\r\n\t\r\n\toneRankDeck: (a)=>{\r\n\t\t\r\n\t\tif(a.putDeck.length == 1) return true;\r\n\t\t\r\n\t\tlet ruleCorrect = true;\r\n\r\n\t\tfor(let i in a.putDeck) {\r\n\r\n\t\t\tif(i > 0) {\r\n\r\n\t\t\t\tlet down = common.validateCardName(a.putDeck[i - 1].card.name).suit,\r\n\t\t\t\t\tup   = common.validateCardName(a.putDeck[i].card.name).suit\r\n\t\t\t\t\r\n\t\t\t\truleCorrect = ruleCorrect && down == up;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn ruleCorrect;\r\n\t},\r\n\r\n\tascend: (a)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet da = rpr._downupranknum(a);\r\n\r\n\t\treturn da && da.down < da.up;\r\n\t},\r\n\r\n\tdescent: (a)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet da = rpr._downupranknum(a);\r\n\r\n\t\treturn da && da.down > da.up;\r\n\t},\r\n\r\n\tdescentOne: (a)=>{// one step\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet da = rpr._downupranknum(a);\r\n\r\n\t\treturn da && da.down == 1 + da.up;\r\n\t},\r\n\r\n\tascendOne: (a)=>{// one step\r\n\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet da = rpr._downupranknum(a);\r\n\r\n\t\treturn da && 1 + da.down == da.up;\r\n\t},\r\n\r\n\tascdescOne: (a)=>{\r\n\t\t\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet da = rpr._downupranknum(a);\r\n\r\n\t\treturn da && Math.abs(da.down - da.up) == 1;\r\n\t},\r\n\r\n\tsum14: (a)=>{\r\n\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet du = rpr._downupcards(a);\r\n\t\tlet _sum = du.down.value + du.up.value;\r\n\r\n\t\treturn _sum == 14;\r\n\t},\r\n\r\n\t// TODO rules with params ??? or atom rules\r\n\r\n\taround: (a)=>{// {from, putDeck, cards}\r\n\r\n\t\tif(a.cards.length == 0) return true;\r\n\r\n\t\tlet _around = a.from.deck.getRelationsByName('around', {from: null});\r\n\t\tlet _parent = Deck.getDeckById(a.cards[0].parent);\r\n\t\t\r\n\t\tfor(let i in _around) {\r\n\r\n\t\t\tif(_around[i].to == _parent.name) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\t\t\r\n\t}\r\n\r\n};\r\n\r\nexport default rpr;\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/readyPutRules.js\n **/","'use strict';\n\nexport default (_deck)=>{// {deck}\n\t\n\tlet prev = _deck.getRelationsByName('beside', {\n\t\tfrom: null,\n\t\ttype: \"prev\"\n\t})[0];\n\n\tlet next = _deck.getRelationsByName('beside', {\n\t\tfrom: null,\n\t\ttype: \"next\"\n\t})[0];\n\n\treturn {prev, next};\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/getBeside.js\n **/","'use strict';\r\n\r\nexport default {\r\n\t\t\t\t\r\n\t// SimpleRules\r\n\tnot      : (a)=>{\r\n\t\treturn false;\r\n\t},\r\n\r\n\tnotFirst : (a)=>{\r\n\t\treturn a.cardIndex > 0;\r\n\t},\r\n\r\n\tany      : (a)=>{\r\n\t\treturn true;\r\n\t},\r\n\r\n\tonlytop  : (a)=>{\r\n\r\n\t\treturn a.cardIndex == a.deckLength - 1;\r\n\t}\r\n\t\r\n\t// TODO rules\r\n\t\r\n\t// ask : function(a) {\r\n\t// \treturn true;\r\n\t// },\r\n\r\n\t// desc : function(a) {\r\n\t// \treturn true;\r\n\t// }\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/readyTakeRules.js\n **/","'use strict';\r\n\r\nimport defaults from 'defaults';\r\nimport common   from 'common';\r\n\r\nimport Deck      from 'addDeck';\r\nimport Tips      from 'tips';\r\nimport getBeside from 'getBeside';\r\n\r\nlet fr = {\r\n\r\n\tdeckLength: (e)=>{\r\n\t\t\r\n\t\treturn defaults.card.ranks.length <= a.deck.cards.length;\r\n\t},\r\n\t\r\n\tnot: ()=>{\r\n\t\t\r\n\t\treturn false;\r\n\t},\r\n\r\n\tnoMoves: (a)=>{\r\n\r\n\t\treturn !Tips.checkFrom(a.name);\r\n\t},\r\n\r\n\t_top: (a)=>{// filter\r\n\r\n\t\tlet _card = e.getTopCard();\r\n\t\treturn _card && common.validateCardName(_card).rank;\r\n\t},\r\n\r\n\ttopAce: (e)=>{\r\n\r\n\t\treturn fr._top() == '1';\r\n\t},\r\n\r\n\ttopKing: (e)=>{\r\n\r\n\t\treturn fr._top() == 'k';\r\n\t},\r\n\r\n\t_prev_next_desc_ask: (e, _type, _callback)=>{// filter\r\n\r\n\t\tlet _check = true;\r\n\t\tlet _prev = getBeside(a.to)[_type];\r\n\t\tlet _topCard = e.getTopCard();\r\n\r\n\t\tfor(;_prev && _check;) {\r\n\t\t\t\r\n\t\t\tlet _deck = Deck.Deck(_prev);\r\n\t\t\t_card = _deck.getTopCard();\r\n\t\t\t\r\n\t\t\t_check = _check && _card && _callback(common.validateCardName(_topCard).value, common.validateCardName(_card).value|0);\r\n\t\t\t\r\n\t\t\t_topCard = _card;\r\n\t\t\t_prev = getBeside(_deck)[_type];\r\n\t\t}\r\n\r\n\t\treturn _check;\r\n\t},\r\n\r\n\t// prevDescOne: (e)=>{\r\n\r\n\t// \tlet _check = true;\r\n\t// \tlet _prev = getBeside(a.to).prev;\r\n\t// \tlet _topCard = e.getTopCard();\r\n\r\n\t// \tfor(;_prev && _check;) {\r\n\t\t\t\r\n\t// \t\tlet _deck = Deck.Deck(_prev);\r\n\t\t\t\r\n\t// \t\t_card = _deck.getTopCard();\r\n\t\t\t\r\n\t// \t\t_check = _check && _card && common.validateCardName(_topCard).value == (common.validateCardName(_card).value|0) + 1;\r\n\t\t\t\r\n\t// \t\t_topCard = _card;\r\n\r\n\t// \t\t_prev = getBeside(_deck).prev;\r\n\t// \t}\r\n\r\n\t// \treturn _check;\r\n\t// }\r\n\r\n\tprevDescOne: (e)=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'prev', (u, d)=>{\r\n\t\t\treturn u == (d|0) + 1;\r\n\t\t});\r\n\t},\r\n\r\n\tprevAscOne: (e)=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'prev', (u, d)=>{\r\n\t\t\treturn (u|0) + 1 == d;\r\n\t\t});\r\n\t},\r\n\r\n\tnextDescOne: (e)=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'next', (u, d)=>{\r\n\t\t\treturn u == (d|0) + 1;\r\n\t\t});\r\n\t},\r\n\r\n\tnextAscOne: (e)=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'next', (u, d)=>{\r\n\t\t\treturn (u|0) + 1 == d;\r\n\t\t});\r\n\t},\r\n\r\n\tprevDesc: ()=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'prev', (u, d)=>{\r\n\t\t\treturn u > d;\r\n\t\t});\r\n\t},\r\n\tprevAsc: ()=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'prev', (u, d)=>{\r\n\t\t\treturn u < d;\r\n\t\t});\r\n\t},\r\n\tnextDesc: ()=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'next', (u, d)=>{\r\n\t\t\treturn u > d;\r\n\t\t});\r\n\t},\r\n\tnextAsc: ()=>{\r\n\r\n\t\treturn fr._prev_next_desc_ask(e, 'next', (u, d)=>{\r\n\t\t\treturn u < d;\r\n\t\t});\r\n\t},\r\n};\r\n\r\nexport default fr;\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/fillRules.js\n **/","'use strict';\r\n\r\nexport default {\r\n\t\r\n\tnone : function(params, card, index, length, deck) {\r\n\t\treturn {x : params.x, y : params.y};\r\n\t},\r\n\tlast_three_min : function(params, card, index, length, deck) {\r\n\t\tif(index > length - 3) {\r\n\t\t\tif(length > 3) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tx : params.x - (length - 3 - index) * 2,\r\n\t\t\t\t\ty : params.y - (length - 3 - index)\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tx : params.x + (index * 2),\r\n\t\t\t\t\ty : params.y + (index|0)\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn {x : x, y : y};\r\n\t\t}\r\n\t},\r\n\ttwindeck_typeA : function(params, card, index, length, deck) {\r\n\r\n\t\tvar twindeck_max_cards       = 24,\r\n\t\t\ttwindeck_deck_length     = 3;\r\n\t\t\r\n\t\tvar _padding = {\r\n\t\t\tx : 2,\r\n\t\t\ty : 1\r\n\t\t}\r\n\r\n\t\tvar _depth = (length / twindeck_max_cards * twindeck_deck_length)|0;\r\n\t\tif(_depth >= twindeck_deck_length) _depth = twindeck_deck_length - 1;\r\n\r\n\t\tvar _plus = index - (length - _depth - 1);\r\n\t\tif(_plus < 0) _plus = 0;\r\n\r\n\t\treturn {\r\n\t\t\tx : params.x + _padding.x * _plus, \r\n\t\t\ty : params.y + _padding.y * _plus\r\n\t\t};\r\n\t},\r\n\tradial : function(params, card, index, length, deck) {\r\n\r\n        //              b\r\n        //       C  ..`:   A = sin(b) * C\r\n        //     ...``   :B  B = cos(b) * C\r\n        // a.``.......+:\r\n        //        A     y 90deg\r\n        var _depth  = 1,\r\n        \t_radius = index * _depth,\r\n        \t// _step   = 180 / 16,\r\n        \t// _card   = defaults.card,\r\n        \t_angle  = params.rotate,//_step / 2 + 270;\r\n        \t_deg    = Math.PI / 180,\r\n        \t_a      = Math.sin(_angle * _deg) * _radius,\r\n        \t_b      = Math.cos(_angle * _deg) * _radius;\r\n        // if(_angle > 360) _angle -= 360;\r\n\t\treturn {\r\n            x : params.x + _a,// - _card.width  / 2,\r\n            y : params.y - _b// - _card.height / 2\r\n\t\t};\r\n\t},\r\n\tspecial : function(params, card, index, length, deck) {\r\n\t\t\r\n\t\tvar _y = params.y, _x = params.x;\r\n\t\t\r\n\t\tfor(var i = 0; i < index; i += 1) {\r\n\t\t\t_y += deck[i] && deck[i].flip ? params.flip_padding_y : params.padding_y;\r\n\t\t\t_x += deck[i] && deck[i].flip ? params.flip_padding_x : params.padding_x;\r\n\t\t}\r\n\t\treturn {x : _x, y : _y};\r\n\t},\r\n\tvertical: function(params, card, index, length, deck) {\r\n\t\tvar _y = params.y;\r\n\t\tfor(var i = 0; i < index; i += 1) _y += deck[i] && deck[i].flip ? params.flip_padding_y : params.padding_y;\r\n\t\tvar _return = {\r\n\t\t\tx : params.x,\r\n\t\t\ty : _y\r\n\t\t};\r\n\t\treturn _return;\r\n\t},\r\n\thorizontal: function(params, card, index, length, deck) {\r\n\t\tvar _x = params.x;\r\n\t\tfor(var i = 0; i < index; i += 1) _x += deck[i] && deck[i].flip ? params.flip_padding_x : params.padding_x;\r\n\t\tvar _return = {\r\n\t\t\tx : _x,\r\n\t\t\ty : params.y\r\n\t\t};\r\n\t\treturn _return;\r\n\t}\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/paddingTypes.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport defaults from 'defaults';\nimport common   from 'common';\n\n// Actions\nimport twindeck    from 'twindeckAction';\nimport dealerdeck  from 'dealerdeckAction';\nimport kickAction  from 'kickAction';\nimport stepsAround from 'stepsAroundAction';\n\nvar _actions = {\n\t\"twindeck\"    : twindeck   ,\n\t\"dealerdeck\"  : dealerdeck ,\n\t\"kick\"        : kickAction ,\n\t\"stepsAround\" : stepsAround     \n};\n\n// ------------------------------------------------------------------------------------------\n\nvar _decksActions  = [],\n\t_events = [];\n\nvar addActionEvent = function(_event) {\n\n\tevent.listen(_event, function(data) {\n\n\t\tfor(var i in _decksActions) {\n\t\t\tif(_decksActions[i].event == _event) {\n\t\t\t\t\n\t\t\t\tvar _actionName = _decksActions[i].action;\n\t\t\t\t\n\n\t\t\t\tvar _canRun = _event == 'click'\n\t\t\t\t\t? data.name == _decksActions[i].deck.name\n\t\t\t\t\t: true;\n\t\t\t\t\n\t\t\t\tif(_canRun) {\n\t\t\t\t\t\n\t\t\t\t\t_actions[_actionName].call(\n\t\t\t\t\t\t_decksActions[i].deck, \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactionData : _decksActions[i].deck.actions[_actionName],\n\t\t\t\t\t\t\teventData  : data,\n\t\t\t\t\t\t\teventName  : _event\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\n};\n\nvar addActions = function() {\n\n\tfor(var actionName in this.actions) {\n\n\t\tif(!this.actions[actionName].event) {\n\t\t\tthis.actions[actionName].event = 'click';\n\t\t}\n\n\t\tif(_actions[actionName]) {\n\t\t\t\n\t\t\t_decksActions.push({\n\t\t\t\tdeck   : this, \n\t\t\t\tevent  : this.actions[actionName].event,\n\t\t\t\taction : actionName\n\t\t\t});\n\n\t\t\tif(_events.indexOf(this.actions[actionName].event) < 0) {\n\t\t\t\t_events.push(this.actions[actionName].event);\n\t\t\t\taddActionEvent(this.actions[actionName].event);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('Action', actionName, 'for', this.name, 'not found.');\n\t\t};\n\n\t}\n\tautoRunActions(this.actions);\n};\n\nvar autoRunActions = function(data) {// bind this deck\n\n\tcommon.animationDefault();\n\n\tfor(var actionName in data.actions) {\n\t\tif(data.actions[actionName].autorun) {\n\t\t\tif(_actions[actionName]) {\n\t\t\t\t_actions[actionName].call(\n\t\t\t\t\tdata, \n\t\t\t\t\t{\n\t\t\t\t\t\tactionData : data.actions[actionName],\n\t\t\t\t\t\teventData  : null,\n\t\t\t\t\t\teventName  : data.actions[actionName].event\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\t// Tips.checkTips();\n}\n\nexport default {\n\taddActions\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/deckActions.js\n **/","'use strict';\r\n\r\n// import event    from 'event';\r\n// import defaults from 'defaults';\r\n\r\nexport default function(e) {\r\n// TODO переделать\r\n\t\t\r\n/*\r\n\tif(e.deck_from.iteration == 0) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar deck_to = Deck.Deck(e.data.to);\r\n\t\r\n\tvar moveCardsCount = e.data.count && typeof e.data.count == 'number' \r\n\t\t? e.data.count \r\n\t\t: defaults.actions.twindeck.CardsCount;\r\n\t\r\n\t// количество оставшихся карт в первой колоде\r\n\tvar deckFromCardsCount = e.deck_from.cards.length;\r\n\t\r\n\tif(deckFromCardsCount < moveCardsCount) {\r\n\t\tmoveCardsCount = deckFromCardsCount;\r\n\t}\r\n\t\r\n\t// инициализация\r\n\tif(typeof e.deck_from.iteration == 'undefined') {\r\n\t\t// \"-1\" - infinity\r\n\t\te.deck_from.iteration = -1;\r\n\t\te.deck_from.twindeck = [];\r\n\t}\r\n\r\n\t// количество циклов перелистываний сначало до конца\r\n\tif(e.iterations && e.deck_from.iteration < 0) {\r\n\t\te.deck_from.iteration = e.iterations\r\n\t}\r\n\r\n\tdeck_to.hideCards();\r\n\r\n\tvar _deck = deck_to.Pop(deck_to.cards.length);\r\n\r\n\t// oneStepWay.add('toHide') = Deck.deckCardNames(_deck);\r\n\t\r\n\t_deck.reverse();\r\n\tfor(var i in _deck) {\r\n\t\te.deck_from.twindeck.unshift(_deck[i]);\r\n\t}\r\n\t\r\n\t// первая колода пуста\r\n\tif(e.deck_from.twindeck && e.deck_from.twindeck.length && deckFromCardsCount == 0 && e.deck_from.iteration != 0) {\r\n\t\t// e.deck_from.twindeck.reverse();\r\n\t\te.deck_from.Push(e.deck_from.twindeck);\r\n\t\te.deck_from.twindeck = [];// unshift\r\n\t// перелистывание\r\n\t} else {\r\n\t\tvar _deck = e.deck_from.Pop(moveCardsCount);\r\n\t\tdeck_to.Push(_deck);\r\n\t}\r\n\t\r\n\te.deck_from.showCards();\r\n\t\r\n\t// ------------ FLIP ------------\r\n\r\n\t// var _deck_from = e.deck_from.cards;\r\n\t// var _deck_to = deck_to.cards;\r\n\t\r\n\te.deck_from.flipCheck();\r\n\tdeck_to    .flipCheck();\r\n\t\r\n\te.deck_from.Redraw();\r\n\tdeck_to    .Redraw();\r\n\t\r\n\t// ------------ STEP ------------\r\n\r\n\t// Step\r\n\tvar _twindeckStep = {\r\n\t\tfrom      : e.deck_from.name,\r\n\t\tto        : deck_to    .name,\r\n\t\tmoveCards : share.deckCardNames(_deck),\r\n\t\titeration : (e.deck_from.iteration|0)\r\n\t};\r\n\t\r\n\t// hiddenCards : share.deckCardNames(e.deck_from.twindeck), \r\n\t// cards       : share.deckCardNames(e.deck_from.cards),\r\n\r\n\tHistory.add(_twindeckStep);\r\n\t\r\n\tevent.dispatch('makeStep', History.get());\r\n\t\r\n\t// ------------------------------\r\n\r\n\t// share.checkTips();\r\n\r\n\te.deck_from.iteration -= 1;\r\n*/\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/actions/twindeckAction.js\n **/","'use strict';\r\n\r\nimport event     from 'event';\r\nimport share     from 'share';\r\nimport defaults  from 'defaults';\r\nimport common    from 'common';\r\n\r\nimport forceMove from 'forceMove';\r\n\r\nlet stepType = 'dealerdeckStepType';\r\n\r\nexport default function(data) {// data.actionData, e\r\n\r\n\t// listen click\r\n\t// click is for me (default)\r\n\t// if(this.name != data.actionData.name) { return; };\r\n\t\r\n\t// меняем тип хода\r\n\tshare.set('stepType', stepType);\r\n\t\r\n\t// смотрим остались ли карты\r\n\tif(this.cards.length == 0) {\r\n\r\n\t\tshare.set('stepType', defaults.stepType);\r\n\r\n\t\tevent.dispatch('actionBreak');\r\n\t\t\r\n\t\treturn;\r\n\t}\r\n\r\n\t// карты для раздачи\r\n\tvar _decks = [];\r\n\r\n\t// to == toGroup ???\r\n\tif(data.actionData.toGroup && !data.actionData.to) {\r\n\t\t\r\n\t\tdata.actionData.to = data.actionData.toGroup;\r\n\t\t\r\n\t\t// _decks = _decks.concat(Group.Group(e.toGroup).decks);\r\n\t\t\r\n\t\t// var __decks = Group.Group(data.actionData.toGroup).decks;\r\n\t\t// for(var deckIndex in __decks) {\r\n\t\t// \t_decks.push(__decks[deckIndex]);\r\n\t\t// }\r\n\t};\r\n\r\n\t// есть куда раздать\r\n\tif(data.actionData.to) {\r\n\r\n\t\t// передали имя\r\n\t\tif(typeof data.actionData.to == \"string\") {\r\n\t\t\t\r\n\t\t\t// ищем элементы с таким именем\r\n\t\t\tvar _elements = common.getElementsByName(data.actionData.to);\r\n\t\t\tfor(var i in _elements) {\r\n\r\n\t\t\t\t// это группа\r\n\t\t\t\tif(_elements[i].type == \"group\") {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// _decks = _decks.concat(Group.Group(data.actionData.to).decks);\r\n\t\t\t\t\t// var __decks = Group.Group(data.actionData.to).decks;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// берём колоды из группы\r\n\t\t\t\t\tfor(var deckIndex in _elements[i].decks) {\r\n\t\t\t\t\t\t_decks.push(_elements[i].decks[deckIndex]);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// это колода, добавляем её в список\r\n\t\t\t\tif(_elements[i].type == \"deck\") {\r\n\t\t\t\t\t_decks.push(_el);\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t// передали массив\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\tfor(var i in data.actionData.to) {\r\n\t\t\t\t\r\n\t\t\t\tvar _elements = common.getElementsByName(data.actionData.to[i]);\r\n\t\t\t\t\r\n\t\t\t\tfor(var elIndex in _elements) {\r\n\r\n\t\t\t\t\tif(_elements[elIndex].type == \"group\") {\r\n\t\t\t\t\t\t// _decks = _decks.concat(Group.Group(data.actionData.to[i]).decks);\r\n\t\t\t\t\t\t// var __decks = Group.Group(data.actionData.to[i]).decks;\r\n\t\t\t\t\t\tfor(var deckIndex in _elements[elIndex].decks) {\r\n\t\t\t\t\t\t\t_decks.push(_elements[elIndex].decks[deckIndex]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif(_elements[elIndex].type == \"deck\") {\r\n\t\t\t\t\t\t_decks.push(_elements[elIndex]);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\t// вкл/выкл анимации по умолчанию\r\n\tcommon.animationDefault();\r\n\r\n\t// флаг, что раздача удалась\r\n\tvar _makeStep = false;\r\n\r\n\t// пробегаем колоды из списка\r\n\tfor(var deckId in _decks) {\r\n\t\t\r\n\t\t// берём верхнюю карту\r\n\t\tvar _card = this.getTopCard();\r\n\r\n\t\t// флаг что такой ход возможен\r\n\t\tvar _canStep = data.actionData.onlyEmpty\r\n\t\t\t? _decks[deckId].cards.length == 0\r\n\t\t\t: true;\r\n\t\t\r\n\t\tif(_canStep && _card) {\r\n\r\n\t\t\t_makeStep = true;\r\n\r\n\t\t\tvar _cardName = _card.name;\r\n\t\t\t\r\n\t\t\tlet _callback = ()=>{\r\n\t\t\t\tevent.dispatch('checkTips');\r\n\t\t\t};\r\n\r\n\t\t\tforceMove({\r\n\t\t\t\tfrom : this.name,\r\n\t\t\t\tto   : _decks[deckId].name,\r\n\t\t\t\tdeck : [_cardName],\r\n\t\t\t\tflip : true,\r\n\t\t\t\tcallback: _callback\r\n\t\t\t}, true);\r\n\t\t\t\r\n\t\t\t_decks[deckId].flipCheck();\r\n\t\t\t// _decks[deckId].Redraw();\r\n\r\n\t\t\tevent.dispatch('addStep', {\r\n\t\t\t\t'move' : {\r\n\t\t\t\t\tfrom : this.name,\r\n\t\t\t\t\tto   : _decks[deckId].name,\r\n\t\t\t\t\tdeck : [_cardName],\r\n\t\t\t\t\tflip : true,\r\n\t\t\t\t\tstepType : share.get('stepType')\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t};\r\n\r\n\t};\r\n\t\r\n\tif(_makeStep) {\r\n\r\n\t\tconsole.log('-------------------------------------#');\r\n\t\t\r\n\t\t// сохраняем если паздача удалась\r\n\t\tevent.dispatch('saveSteps');\r\n\t\t// event.dispatch('checkTips');\r\n\t\t// if(History.count()) {\r\n\t\t// \tevent.dispatch('makeStep', History.get());\r\n\t\t// }\r\n\r\n\t};\r\n\r\n\tif(data.actionData.dispatch) {\r\n\r\n\t\tevent.dispatch(data.actionData.dispatch, !_makeStep);\r\n\t} else {\r\n\t\t// сохраняем если ничего не вызываем\r\n\r\n\t\tshare.set('stepType', defaults.stepType);\r\n\t}\r\n\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/actions/dealerdeckAction.js\n **/","'use strict';\n\nimport event  from 'event';\nimport share  from 'share';\nimport common from 'common';\n\nimport Deck from 'addDeck';\nimport Tips from 'tips';\n\nlet forceMove = function(a) {// {from, to, deck, <flip>, <callback>}\n\n\t// console.log('forceMove', a);\n\n\tif(!a.from || !a.to || !a.deck) {\n\t\treturn;\n\t}\n\n\tif(!a.deck.length) return;\n\t\n\tlet _from = typeof a.from == \"string\"\n\t\t? Deck.Deck(a.from)\n\t\t: a.from;\n\n\tlet _to   = typeof a.to   == \"string\"\n\t\t? Deck.Deck(a.to)\n\t\t: a.to;\n\n\tif(!_from || !_to || _from.type != \"deck\" || _to.type != \"deck\") {\n\t\treturn;\n\t}\n\n\tlet _check     = true;\n\tlet _from_deck = _from.cards;\n\n\tfor(let i in _from_deck) {\n\t\t\n\t\tif(i >= _from_deck.length - a.deck.length) {\n\t\t\t\n\t\t\tlet _id = i - (_from_deck.length|0) + (a.deck.length|0);\n\t\t\t\n\t\t\tif(a.deck[_id] && _from_deck[i].name != a.deck[_id]) {\n\t\t\t\t_check = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tif(_check) {\n\n\t\tlet _pop = _from.Pop(a.deck.length);\n\n\t\t// перевернуть карты во время хода\n\t\tif(a.flip) {\n\t\t\tfor(let i in _pop) {\n\t\t\t\t_pop[i].flip = !_pop[i].flip;\n\t\t\t}\n\t\t}\n\n\t\t_to.Push(_pop);\n\t\t\n\t\tlet __pop = [];\n\t\tfor(let i in _pop) {\n\t\t\t__pop.push({\n\t\t\t\tcard : _pop[i]\n\t\t\t});\n\t\t}\n\n\t\tlet moveDragDeckParams = {\n\t\t\tdeparture   : _from,\n\t\t\tdestination : _to,\n\t\t\tmoveDeck    : __pop\n\t\t};\n\t\t\n\t\tif(typeof a.callback == \"function\") {\n\t\t\tmoveDragDeckParams.callback = a.callback;\n\t\t}\n\t\t\n\t\tevent.dispatch('moveDragDeck', moveDragDeckParams);\n\t} else {\n\t\t// _warn(4);\n\t\tconsole.warn(\"forceMove:Ход невозможен\", a);\n\t}\n};\n\nevent.listen('forceMove', (e)=>{\n\tforceMove(e);\n});\n\nexport default forceMove;\n\n\n/** WEBPACK FOOTER **\n ** ./sources/history/forceMove.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport common   from 'common';\nimport defaults from 'defaults';\n\nexport default function(data) {\n\t\n\tif(share.get('stepType') != defaults.stepType) {\n\t\t// console.log('#no_kick 1');\n\t\treturn false;\n\t}\n\n\tif(data.eventData.stepType != defaults.stepType) {\n\t\treturn false;\n\t}\n\n\t// if(share.get('prevStepType') != defaults.stepType) {\n\t// \treturn false;\n\t// }\n\n\t// let _name = null;\n\t// if(\n\t// \tdata.eventData[0]                            &&\n\t// \tdata.eventData[0].move                       &&\n\t// \ttypeof data.eventData[0].move.to == \"string\"\n\t// ) {\n\t// \t_name = data.eventData[0].move.to;\n\t// }\n\t\n\t// if(\n\t// \tdata.eventData.to                    &&\n\t// \ttypeof data.eventData.to == \"string\"\n\t// ) {\n\t// \t_name = data.eventData.to;\n\t// }\n\t\n\t// if(\n\t// \tdata.eventData.to                         &&\n\t// \ttypeof data.eventData.to != \"string\"      &&\n\t// \ttypeof data.eventData.to.name == \"string\"\n\t// ) {\n\t// \t_name = data.eventData.to.name;\n\t// }\n\n\tif(data.eventData.to.name != this.name) {\n\t\treturn false;\n\t}\n\n\t// console.log('#kick -----------------------------------------');\n\n\t// console.log('KICK', data, share.get('prevStepType'));\n\n\t// if(\n\t// \tdata.eventData[0]                         &&\n\t// \ttypeof data.eventData[0].name == \"string\" &&\n\t// \tdata.eventData[0].name != this.name\n\t// ) {\n\t// \treturn false;\n\t// }\n\n\tcommon.animationDefault();\n\t\n\t// var _toDeck = Deck.Deck(data.actionData.to);\n\t\n\t// let _from = typeof data.eventData.to == \"string\"\n\t// \t\t? Deck.Deck(_name)\n\t// \t\t: data.eventData.to\n\t\n\tlet _from = data.eventData.to, //Deck.Deck(_name),\n\t    _deck = _from.getCardsNames();\n\n\tlet _callback = ()=>{\n\n\t\tevent.dispatch('addStep', {\n\t\t\t\"move\" : {\n\t\t\t\tfrom : _from.name,\n\t\t\t\tto   : data.actionData.to,\n\t\t\t\tdeck : _deck,\n\t\t\t\tflip : true\n\t\t\t}\n\t\t});\n\n\t\tevent.dispatch('saveSteps');\n\n\t\tif(data.actionData.dispatch) {\n\t\t\tevent.dispatch(data.actionData.dispatch);\n\t\t}\n\t}\n\t\n\n\t// TODO interval\n\tlet forceMoveParams = {\n\t\tfrom     : _from             ,// deck\n\t\tto       : data.actionData.to,// _decks[deckId].name,\n\t\tdeck     : _deck             ,// [_cardName],\n\t\tflip     : true              ,// true\n\t\tcallback : _callback\n\t};\n\t\n\t// forceMove(forceMoveParams);\n\tevent.dispatch('forceMove', forceMoveParams);\n\t\n\n\t// if(e.after) {\n\t// \t_events[e.after].call(this, e);\n\t// };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/actions/kickAction.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport common   from 'common';\nimport defaults from 'defaults';\n\nimport Tips from 'tips';\nimport Deck from 'addDeck';\n\nlet stepType = 'stepsAround';\n\nlet endAction = ()=>{\n\n\tshare.set('stepType', defaults.stepType);\n\tcommon.curUnLock();\n\t// Tips.checkTips();\n\n\tif(data.actionData.dispatch) {\n\t\tevent.dispatch(data.actionData.dispatch, data.eventData);\n\t}\n};\n\nexport default function(data) {// {actionData, eventData, eventName}\n\n\tlet _stepType = share.get('stepType');\n\tif(_stepType != defaults.stepType) { return; };\n\n\tshare.set('stepType', stepType);\n\t// stop Drag'n'Drop\n\tcommon.curLock();\n\t\n\tlet _relations = this.getRelationsByName('around', {from: null});\n\tlet _tips = Tips.getTips();\n\n\tif(typeof data.actionData.action == \"string\") {\n\t\n\t}\n\n\t// выполняется для всех вокруг\n\t// ход не делается\n\t// вместо хода выполняется едействие для текущей стопки (если _central, по умолчанию true)\n\tif(typeof data.actionData.run == \"string\") {\n\n\t\tlet _central = typeof data.actionData.central == \"boolean\" ? data.actionData.central : true;\n\n\t\tlet _runStack = [];\n\n\t\tfor(let i in _relations) {\n\t\t\t\n\t\t\tif(\n\t\t\t\tTips.fromTo(this.name, _relations[i].to)\n\t\t\t) {\n\t\t\t\t_runStack.push(_relations[i]);\n\t\t\t}\n\t\t}\n\n\t\tlet _counter = _runStack.length;\n\n\t\tlet _callback = ()=>{\n\t\t\t\t\n\t\t\t_counter -= 1;\n\t\t\tif(_counter === 0) {\n\t\t\t\t\n\t\t\t\tendAction();\n\t\t\t\t// event.dispatch(data.actionData.dispatch)\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(_counter === 0) {\n\n\t\t\tendAction();\n\n\t\t} else if(_central) {\n\n\t\t\t_counter += 1;\n\n\t\t\tevent.dispatch(data.actionData.run, {\n\t\t\t\tto       : this.name,\n\t\t\t\tcallback : _callback\n\t\t\t});\n\t\t}\n\n\t\tfor(let i in _runStack) {\n\t\t\t\n\t\t\tlet _data = Object.assign({}, _runStack[i]);\n\t\t\t_data.callback = _callback;\n\t\t\tevent.dispatch(data.actionData.run, _data);\n\t\t}\n\n\t// выполняется после хода \n\t} else {\n\t\t\n\t\tlet _callback = ()=>{\n\n\t\t\tif(share.get('stepType') == stepType) {\n\t\t\t\tendAction();\n\t\t\t}\n\t\t};\n\t\t\n\t\tevent.listen('makeStep', _callback)\n\t\t// event.dispatch(data.actionData.dispatch)\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/actions/stepsAroundAction.js\n **/","'use strict';\r\n\r\nimport share    from 'share';\r\nimport defaults from 'defaults';\r\nimport common   from 'common';\r\n\r\nimport takeRules from 'readyTakeRules';\r\n\r\nexport default function(cardId) {\r\n\r\n\t// Нестандартный ход (autosteps)\r\n\t// if(share.get('stepType') != defaults.stepType) {return false;};\r\n\r\n\tvar rulesCorrect = true;//!common.isLock();\r\n\r\n\trulesCorrect = rulesCorrect && !this.locked;\r\n\t\r\n\tif(typeof this.fill == \"boolean\") {\r\n\t\trulesCorrect = rulesCorrect && !this.fill;\r\n\t}\r\n\r\n\t// берём карту/стопку\r\n\r\n\tvar cardIndex  = -1;\r\n\tvar cardName   = null; \r\n\tvar cardSuit   = null; \r\n\tvar cardRank   = null; \r\n\tvar deckLength = this.cards.length;\r\n\r\n\t// проверяем не является ли перевернутой\r\n\r\n\tvar takeDeck = []\r\n\r\n\tfor(var i in this.cards) {\r\n\r\n\t\tif(this.cards[i].id == cardId) {\r\n\t\t\tcardIndex = i|0;\r\n\t\t\tcardName  = this.cards[i].name;\r\n\t\t\t\r\n\t\t\tvar _name = common.validateCardName(cardName);\r\n\t\t\t\r\n\t\t\trulesCorrect = rulesCorrect && _name;\r\n\r\n\t\t\t\r\n\t\t\tif(_name) {\r\n\t\t\t\tcardSuit = _name.suit;\r\n\t\t\t\tcardRank = _name.rank;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\trulesCorrect = rulesCorrect && (\r\n\t\t\t\t!this.cards[i].flip\r\n\t\t\t || this.cards[i].flip == defaults.canMoveFlip\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif(cardIndex >= 0) {\r\n\t\t\ttakeDeck.push({index : i, card : this.cards[i]});\r\n\t\t}\r\n\t}\r\n\tvar _attrs = {\r\n\t\tcardId     : cardId, \r\n\t\tcardName   : cardName, \r\n\t\tcardSuit   : cardSuit, \r\n\t\tcardRank   : cardRank, \r\n\t\tcardIndex  : cardIndex, \r\n\t\tdeckLength : deckLength\r\n\t}\r\n\r\n\tfor(var ruleIndex in this.takeRules) {\r\n\t\tvar ruleName = this.takeRules[ruleIndex];\r\n\t\t\r\n\t\tif(takeRules[ruleName]) {\r\n\t\t\trulesCorrect = rulesCorrect && takeRules[ruleName](_attrs);\r\n\t\t} else {\r\n\t\t\tconsole.warn('Incorrect take rule:', ruleName);\r\n\t\t\trulesCorrect = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t// возвращает массив ID карт которые можно будет перетащить\r\n\t// записывает их как активные\r\n\t\r\n\trulesCorrect = rulesCorrect && (cardIndex >= 0);\r\n\r\n\treturn rulesCorrect && takeDeck;\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/deckTake.js\n **/","'use strict';\n\nimport share    from 'share';\nimport defaults from 'defaults';\n\nimport Field    from 'field';\nimport Deck     from 'addDeck';\nimport putRules from 'readyPutRules';\n\nexport default function(putDeck) {\n\n\tlet _stepType = share.get('stepType');\n\n\tvar rulesCorrect = true;\n\t\n\tvar _deckId         = putDeck[0].card.parent;\n\tvar _deck_departure = Deck.getDeckById(_deckId);\n\n\trulesCorrect = rulesCorrect && !this.locked;\n\n\tif(_stepType != defaults.stepType) {\n\n\t\t// Нестандартный ход (autosteps)\n\t\tlet _field = Field();\n\t\trulesCorrect = rulesCorrect && _field.autoSteps && _field.autoSteps[_stepType]\n\t\t\t? _field.autoSteps[_stepType].manual({\n\t\t\t\tputDeck,\n\t\t\t\tto: this\n\t\t\t})\n\t\t\t: false;\n\t} else {\n\n\t\tlet _link = null;// deckName\n\t\tlet _deck = this;\n\n\t\tfor(var ruleIndex in this.putRules) {\n\t\t\t\n\t\t\tif(rulesCorrect) {\n\n\t\t\t\tif(_link) {\n\t\t\t\t\t_deck = Deck.Deck(_link);\n\t\t\t\t}\n\n\t\t\t\tvar ruleName = this.putRules[ruleIndex];\n\n\t\t\t\tif(putRules[ruleName]) {\n\n\t\t\t\t\tlet _param = {\n\t\t\t\t\t\tfrom    : {\n\t\t\t\t\t\t\tdeckId : _deckId, \n\t\t\t\t\t\t\tdeck   : _deck_departure\n\t\t\t\t\t\t}, \n\t\t\t\t\t\tputDeck,\n\t\t\t\t\t\tcards   : _deck.cards,\n\t\t\t\t\t\tto      : _deck,\n\t\t\t\t\t\tlink    : _link\n\t\t\t\t\t\t// rulesArgs : putRules[ruleName]\n\t\t\t\t\t};\n\t\t\t\t\trulesCorrect = rulesCorrect && putRules[ruleName](_param);\n\t\t\t\t\t_link = _param.link;\n\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn('putRule:', ruleName, 'not exists');\n\t\t\t\t\trulesCorrect = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn rulesCorrect;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/deckPut.js\n **/","'use strict';\r\n\r\nimport event  from 'event';\r\nimport share  from 'share';\r\nimport common from 'common';\r\n\r\nexport default function(name) {// TODO\r\n\r\n\tvar _name = common.validateCardName(name);// {color, rank}\r\n\t\r\n\tif(_name) {\r\n\r\n\t\tvar _id = 'card_' + common.genId(),\r\n\t\t\t_card = {\r\n\t\t\t\tid      : _id,\r\n\t\t\t\tname    : name,\r\n\t\t\t\ttype    : 'card',\r\n\t\t\t\t// domElement : domElement,\r\n\t\t\t\tvisible : true,\r\n\t\t\t\t// parent  : _parent,\r\n\t\t\t\tflip    : false\r\n\t\t\t}\r\n\t\t_card.parent = this.getId();\r\n\t\t\r\n\t\tevent.dispatch('addCardEl', _card);\r\n\t\t\r\n\t\tvar _elements = share.get('elements');\r\n\t\t_elements[_id] = _card;\r\n\t\tshare.set('elements', _elements);\r\n\t\t\r\n\t\tthis.Push([_card]);\r\n\t\tthis.flipCheck();\r\n\t\tthis.Redraw();\r\n\r\n\t\treturn _card;\r\n\t}\r\n\t\r\n\treturn false;\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/genCardByName.js\n **/","'use strict';\r\n\r\nimport event     from 'event';\r\nimport share     from 'share';\r\n\r\nimport forceMove from 'forceMove';\r\nimport Deck      from 'addDeck';\r\nimport Tips      from 'tips';\r\n// import elRender  from 'elRender';\r\n\r\n// var _undoMethods = {};\r\n// var _redoMethods = {};\r\n\r\n// ---------------------------------------- UNDO ----------------------------------------\r\n\r\nvar _undo = function(a) {\r\n\r\n\t// for(var i in _undoMethods) {\r\n\t// \t_undoMethods[i](a);\r\n\t// }\r\n\t\r\n\t// if(a.flip) {\r\n\t// };\r\n\t\r\n\t// if(a.unflip) {\r\n\t// \tif(\r\n\t// \t\ttypeof a.unflip.deck       == \"string\"\r\n\t// \t && typeof a.unflip.card       != \"undefined\"\r\n\t// \t && typeof a.unflip.card.name  == \"string\"\r\n\t// \t && typeof a.unflip.card.index != \"undefined\"\r\n\t// \t) {\r\n\t// \t\tvar _deck = Deck.Deck(a.unflip.deck),\r\n\t// \t\t\t_cards = _deck ? _deck.cards : [];\r\n\t// \t\tif(_cards[a.unflip.card.index].name == a.unflip.card.name) {\r\n\t// \t\t\t_cards[a.unflip.card.index].flip = true;\r\n\t// \t\t}\r\n\t// \t}\r\n\t// };\r\n\t\r\n\t// if(a.fill) {\r\n\t// \t// TODO\r\n\t// };\r\n\r\n\t// MOVE\r\n\tif(\r\n\t\ttypeof a.move      != \"undefined\" \r\n\t && typeof a.move.from != \"undefined\" \r\n\t && typeof a.move.to   != \"undefined\" \r\n\t && typeof a.move.deck != \"undefined\"\r\n\t) {\r\n\t\tforceMove({\r\n\t\t\tfrom : a.move.to,// from <=> to\r\n\t\t\tto   : a.move.from,\r\n\t\t\tdeck : a.move.deck,\r\n\t\t\tflip : a.move.flip\r\n\t\t});\r\n\t}\r\n\r\n};\r\n\r\nevent.listen('undo', function(_a) {\r\n\r\n\t// elRender.animationsEnd();\r\n\tevent.dispatch('stopAnimations');\r\n\t\r\n\tif(!_a) { return; };\r\n\r\n\t// Обратная совместимость\r\n\tif(_a instanceof Array) {\r\n\r\n\t\t_a.reverse();\r\n\t\t\r\n\t\tfor(var _i in _a) {\r\n\t\t\tvar a = _a[_i];\r\n\t\t\t_undo(a);\r\n\t\t}\r\n\t\t\r\n\t} else {\r\n\t\t\r\n\t\t_undo(_a);\r\n\t\t\r\n\t}\r\n\r\n\tTips.checkTips();\r\n\r\n});\r\n\r\n// ---------------------------------------- REDO ----------------------------------------\r\n\r\nvar _redo = function(a) {\r\n\r\n\t// for(var i in _redoMethods) {\r\n\t// \t_redoMethods[i](a);\r\n\t// }\r\n\r\n\t// if(a.flip) {\r\n\t// };\r\n\t\r\n\t// if(a.unflip) {\r\n\t// \tif(\r\n\t// \t\ttypeof a.unflip.deck       == \"string\"\r\n\t// \t && typeof a.unflip.card       != \"undefined\"\r\n\t// \t && typeof a.unflip.card.name  == \"string\"\r\n\t// \t && typeof a.unflip.card.index != \"undefined\"\r\n\t// \t) {\r\n\t// \t\tvar _deck = Deck.Deck(a.unflip.deck),\r\n\t// \t\t\t_cards = _deck ? _deck.cards : [];\r\n\t// \t\tif(_cards[a.unflip.card.index].name == a.unflip.card.name) {\r\n\t// \t\t\t_cards[a.unflip.card.index].flip = false;\r\n\t// \t\t}\r\n\t// \t}\r\n\t// };\r\n\t\r\n\t// if(a.fill) {\r\n\t// \t// TODO\r\n\t// };\r\n\r\n\tif(\r\n\t\ttypeof a.move      != \"undefined\" \r\n\t && typeof a.move.from != \"undefined\" \r\n\t && typeof a.move.to   != \"undefined\" \r\n\t && typeof a.move.deck != \"undefined\"\r\n\t) {\r\n\t\tforceMove(a.move);\r\n\t}\r\n\r\n};\r\n\r\nevent.listen('redo', function(_a) {\r\n\r\n\t// elRender.animationsEnd();\r\n\tevent.dispatch('stopAnimations');\r\n\t\r\n\r\n\tif(!_a) return;\r\n\r\n\t// Обратная совместимость\r\n\tif(_a instanceof Array) {\r\n\t\t_a.reverse();\r\n\t\tfor(var _i in _a) {\r\n\t\t\tvar a = _a[_i];\r\n\t\t\t_redo(a);\r\n\t\t}\r\n\t} else {\r\n\t\t_redo(_a);\r\n\t}\r\n\r\n\tTips.checkTips();\r\n\r\n});\r\n\r\n// ----------------------------------------------\r\n\r\nclass history {\r\n\r\n\tconstructor() {\r\n\t\t\r\n\t\tthis.steps = [];\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.steps = [];\r\n\t}\r\n\r\n\tadd(step) {\r\n\r\n\t\t// for(var i in step) {\r\n\t\tthis.steps.push(step);\r\n\t\t// }\r\n\t}\r\n\r\n\t// get steps and reset\r\n\tget(reset = true) {\r\n\r\n\t\tvar _req = this.steps;\r\n\t\t\r\n\t\tif(reset) {\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\r\n\t\treturn _req;\r\n\t}\r\n\r\n\tlog() {\r\n\t\tconsole.log(this.steps);\r\n\t}\r\n\r\n\tcount() {\r\n\t\treturn this.steps.length;\r\n\t}\r\n\r\n\t// addUndoMethods(a) {\r\n\t// \tfor(var i in a) {\r\n\t// \t\t_undoMethods[i] = a[i];\r\n\t// \t}\r\n\t// }\r\n\t\r\n\t// addRedoMethods(a) {\r\n\t// \tfor(var i in a) {\r\n\t// \t\t_redoMethods[i] = a[i];\r\n\t// \t}\r\n\t// }\r\n}\r\n\r\nlet _history = new history();\r\n\r\nevent.listen('addStep', (e)=>{\r\n\t_history.add(e)\r\n});\r\n\r\nevent.listen('saveSteps', ()=>{\r\n\r\n\t// save steps to client history\r\n\tevent.dispatch('makeStep', _history.get());\r\n});\r\n\r\nexport default _history;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/history/history.js\n **/","'use strict';\r\n\r\nimport share from 'share';\r\n\r\nexport default function(a) {\r\n\r\n\tvar _decks = {}\r\n\tvar _elements = share.get('elements');\r\n\tfor(var d in _elements) {\r\n\t\tif(_elements[d].type == 'deck') {\r\n\t\t\tif(a && a.visible) {\r\n\t\t\t\tif(_elements[d].visible) {\r\n\t\t\t\t\t_decks[d] = _elements[d];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t_decks[d] = _elements[d];\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\treturn _decks;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/getDecks.js\n **/","'use strict';\r\n\r\nimport share from 'share';\r\n\r\nexport default function(id) {// ID\r\n\t\r\n\tvar _elements = share.get('elements');\r\n\t\r\n\t// for(var d in _elements) {\r\n\t// \tif(_elements[d].type == 'deck' && d == id) {\r\n\t// \t\treturn _elements[d];\r\n\t// \t};\r\n\t// };\r\n\r\n\treturn _elements[id];\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/getDeckById.js\n **/","'use strict';\r\n\r\nexport default function(a) {// Take deck [{card, index}]\r\n\r\n\tvar _deck = [];\r\n\tfor(var i in a) {\r\n\t\tif(a[i].card && a[i].card.name) {\r\n\t\t\t_deck.push(a[i].card.name);\r\n\t\t} else if(a[i].name) {\r\n\t\t\t_deck.push(a[i].name);\r\n\t\t};\r\n\t};\r\n\treturn _deck;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/deckCardNames.js\n **/","'use strict';\n\nimport common from 'common';\n\nexport default function(name, groupName) {\n\t\n\tvar _decks = common.getElementsByName(name, 'deck');\n\tif(groupName && typeof groupName == 'string') {\n\t\tfor(var i in _decks) {\n\t\t\tvar _group = common.getElementById(_decks[i].parent());\n\t\t\tif(_group && _group.name && _group.name == groupName) {\n\t\t\t\treturn _decks[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t} else {\n\t\treturn _decks[0];\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/getDeck.js\n **/","'use strict';\r\n\r\nexport default function(cardNames) {\r\n\r\n\tvar deckIndex = [];\r\n\tvar _decksLength = 0;\r\n\r\n\t// создаём карты из списка cardNames в порядке очерёдности колод (по одной карте)\r\n\tfor(var i in this.decks) {\r\n\t\t_decksLength += 1;\r\n\t\tdeckIndex.push(null);\r\n\t};\r\n\t\r\n\t// если параметр groupIndex не выходит за рамки занимаем соответствующий порядковый номер\r\n\tfor(var i in this.decks) {\r\n\t\tif(this.decks[i].groupIndex && this.decks[i].groupIndex <= _decksLength) {\r\n\t\t\tdeckIndex[this.decks[i].groupIndex - 1] = true;\r\n\t\t};\r\n\t};\r\n\t\r\n\t// если нет параметра groupIndex (начинается с 1) ставим первый свободный порядковый номер\r\n\tfor(var i in this.decks) {\r\n\t\tif(!this.decks[i].groupIndex) {\r\n\t\t\tvar _index = 0;\r\n\t\t\tfor(;deckIndex[_index] != null;_index += 1) {}\r\n\t\t\tdeckIndex[_index] = this.decks[i].getId();\r\n\t\t};\r\n\t};\r\n\r\n\t// если параметр groupIndex не выходит за рамки ставим соответствующий порядковый номер\r\n\tfor(var i in this.decks) {\r\n\t\tif(this.decks[i].groupIndex && this.decks[i].groupIndex <= _decksLength) {\r\n\t\t\tdeckIndex[this.decks[i].groupIndex - 1] = this.decks[i].getId();\r\n\t\t};\r\n\t};\r\n\r\n\t// если параметр groupIndex выходит за рамки запоминаем...\r\n\tvar _decksWithBigIndex = {}\r\n\tfor(var i in this.decks) {\r\n\t\tif(this.decks[i].groupIndex && this.decks[i].groupIndex > _decksLength) {\r\n\t\t\t_decksWithBigIndex[this.decks[i].groupIndex - 1] = this.decks[i].getId();\r\n\t\t};\r\n\t};\r\n\t// ...и сортируем\r\n\tfor(var i in _decksWithBigIndex) {\r\n\t\tvar _index = 0;\r\n\t\tfor(;deckIndex[_index] != null;_index += 1) {}\r\n\t\tdeckIndex[_index] = this.decks[_decksWithBigIndex[i]].getId();\r\n\t};\r\n\r\n\t// сморим являются ли элементы названиями карт (строкой)\r\n\tvar _checkDeck = true;\r\n\tfor(var i in cardNames) {\r\n\t\t_checkDeck = _checkDeck && typeof cardNames[i] == 'string';\r\n\t};\r\n\r\n\t// циклично добавляет карты в колоды в группе (в порядке добавления)\r\n\tif(_checkDeck) {\r\n\r\n\t\tfor(var i in cardNames) {\r\n\r\n\t\t\tvar _index = deckIndex[i % deckIndex.length];\r\n\t\t\t\r\n\t\t\tthis.decks[_index].genCardByName(cardNames[i]);\r\n\t\t}\r\n\t// если нужно добавить несколько групп карт\r\n\t} else {\r\n\r\n\t \tfor(var i in cardNames) {\r\n\t \t\tif(i < deckIndex.length) {\r\n\r\n\t \t\t\t// console.log('fillDeck', deckIndex[i].name, cardNames[i]);\r\n\r\n\t \t\t\tthis.decks[deckIndex[i]].Fill(cardNames[i]);\r\n\t \t\t};\r\n\t \t};\r\n\t};\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/groupFill.js\n **/","'use strict';\r\n\r\nimport defaults from 'defaults';\r\n\r\nexport default function(_a) {\r\n\r\n\tvar _decks = this.getDecks();\r\n\t// var _index = {}\r\n\r\n\tif(typeof _a.decks == 'undefined' || typeof _a.decks == 'number') {_a.decks = [];}\r\n\r\n\tfor(var i in _decks) {\r\n\t\t\r\n\t\tif(!_a.decks[i]) { _a.decks[i] = {}; };\r\n\r\n\t\t// changed values\r\n\t\tif(\r\n\t\t\t_a.position\r\n\t\t && _a.decks[i].parentPosition\r\n\t\t) {\r\n\t\t\t_a.decks[i].parentPosition = {\r\n\t\t\t\tx : _a.position.x,\r\n\t\t\t\ty : _a.position.y\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tif( _a.rotate                   ) { _a.decks[i].rotate         = _a.rotate;       };\r\n\t\tif( _a.paddingX                 ) { _a.decks[i].paddingX       = _a.paddingX;     };\r\n\t\tif( _a.paddingY                 ) { _a.decks[i].paddingY       = _a.paddingY;     };\r\n\t\tif( _a.flipPaddingX             ) { _a.decks[i].flipPaddingX   = _a.flipPaddingX; };\r\n\t\tif( _a.flipPaddingY             ) { _a.decks[i].flipPaddingY   = _a.flipPaddingY; };\r\n\t\tif( !_a.decks[i].position       ) { _a.decks[i].position       = {};              };\r\n\t\tif( !_a.decks[i].parentPosition ) { _a.decks[i].parentPosition = {};              };\r\n\r\n\t\tif(!_a.decks[i].parentPosition.x && a.position && a.position.x && typeof a.position.x == 'number') {\r\n\t\t\t_a.decks[i].parentPosition.x = _a.position.x;\r\n\t\t};\r\n\r\n\t\tif(!_a.decks[i].parentPosition.y && a.position && a.position.y && typeof a.position.y == 'number') {\r\n\t\t\t_a.decks[i].parentPosition.y = _a.position.y;\r\n\t\t};\r\n\r\n\t\tif(_a.placement) {\r\n\t\t\t\r\n\t\t\tvar _card = defaults.card;\r\n\t\t\tif(_a.placement.x) _a.decks[i].position.x = (_a.placement.x + _card.width)  * i;\r\n\t\t\tif(_a.placement.y) _a.decks[i].position.y = (_a.placement.y + _card.height) * i;\r\n\t\t};\r\n\t\t\r\n\t\tif( !_a.decks[i].rotate       && _a.rotate        && typeof _a.rotate       == 'number' ) { _a.decks[i].rotate       = _a.rotate;       };\r\n\t\tif( !_a.decks[i].paddingX     && _a.paddingX      && typeof _a.paddingX     == 'number' ) { _a.decks[i].paddingX     = _a.paddingX;     };\r\n\t\tif( !_a.decks[i].paddingY     && _a.paddingY      && typeof _a.paddingY     == 'number' ) { _a.decks[i].paddingY     = _a.paddingY;     };\r\n\t\tif( !_a.decks[i].flipPaddingX && _a.flipPaddingX  && typeof _a.flipPaddingX == 'number' ) { _a.decks[i].flipPaddingX = _a.flipPaddingX; };\r\n\t\tif( !_a.decks[i].flipPaddingY && _a.flipPaddingY  && typeof _a.flipPaddingY == 'number' ) { _a.decks[i].flipPaddingY = _a.flipPaddingY; };\r\n\t\t\r\n\t\t_decks[i].Redraw(_a.decks[i]);\r\n\t};\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/groupRedraw.js\n **/","/*\r\n * генерация стопок в группах\r\n */\r\n\r\n\r\n'use strict';\r\n\r\nimport countGenerator from \"countGenerator\";\r\nimport fanGenerator   from \"fanGenerator\";\r\nimport mapGenerator   from \"mapGenerator\";\r\nimport lineGenerator  from \"lineGenerator\";\r\n\r\nexport default {\r\n\t\"count\" : countGenerator,\r\n\t\"fan\"   : fanGenerator,\r\n\t\"map\"   : mapGenerator,\r\n\t\"line\"  : lineGenerator\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/groupGenerator.js\n **/","/*\n * сгенерировать ряд из N карт\n */\n\n'use strict';\n\nexport default function(e) {\n\t\n    // {\n    //   type   : \"count\",\n    //   count  : int,\n    // }\n\n\tvar _count = e.count;\n\tvar _decks = [];\n\t\n\tfor(var deckIndex = 0; deckIndex < _count; deckIndex += 1) {\n\t\tvar _deckName = this.name + \"_deck\" + (deckIndex + 1);\n\t\t_decks.push({\n\t\t\tname : _deckName\n\t\t});\n\t}\n\t\n\treturn _decks;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/countGenerator.js\n **/","/*\r\n * сгенерировать группу для полумесяца\r\n */\r\n\r\n'use strict';\r\n\r\nimport defaults from 'defaults';\r\n\r\nexport default function(e) {\r\n\r\n    // {\r\n    //   type   : \"fan\",\r\n    //   count  : int,\r\n    //   radius : int,\r\n    //   center : {\r\n    //     x : int,\r\n    //     y : int\r\n    //   }\r\n    // }\r\n\r\n\tthis.placement = {\r\n        x : 0, \r\n        y : 0\r\n    };\r\n\r\n    //              b\r\n    //       C  ..`:   A = sin(b) * C\r\n    //     ...``   :B  B = cos(b) * C\r\n    // a.``.......+:\r\n    //        A     y 90deg\r\n    var _decks = [];\r\n\r\n    var _count = typeof e.count == \"number\" ? e.count : 3;//16\r\n    var _step = 180 / _count;\r\n    var _radius = typeof e.radius == \"number\" ? e.radius : 100;//405;\r\n    var _center = \r\n    \ttypeof e.center   != \"undefined\"\r\n     && typeof e.center.x != \"undefined\"\r\n     && typeof e.center.y != \"undefined\"\r\n    \t\t? e.center \r\n    \t\t: {\r\n\t        \t\"x\" : 0,\r\n\t        \t\"y\" : 0\r\n\t        };\r\n    var _angle = _step / 2 + 270;\r\n    var _deg = Math.PI / 180;\r\n    for(var deckIndex = 0; deckIndex < _count; deckIndex += 1) {\r\n        \r\n        var _a = Math.sin(_angle * _deg) * _radius;\r\n        var _b = Math.cos(_angle * _deg) * _radius;\r\n        if(_angle > 360) _angle -= 360;\r\n        _decks.push({\r\n            \"name\"     : this.name + \"_deck\" + deckIndex,\r\n            \"rotate\"   : _angle,\r\n            \"position\" : {\r\n                \"x\" : _center.x + _a - defaults.card.width  / 2,\r\n                \"y\" : _center.y - _b - defaults.card.height / 2\r\n            }\r\n        });\r\n        _angle += _step;\r\n    }\r\n\r\n    return _decks;\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/fanGenerator.js\n **/","/*\r\n * сгенерировать группу из матрицы\r\n */\r\n\r\n'use strict';\r\n\r\nimport defaults from \"defaults\";\r\n\r\nimport relationsGenerator from \"relationsGenerator\";\r\nimport mapCommon          from \"mapCommon\";\r\n\r\n// var getName = (el)=>{\r\n// \treturn typeof el == \"string\" ? el : typeof el != \"undefined\" && typeof el.name == \"string\" ? el.name : null;\r\n// };\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\nexport default function(e) {\r\n\r\n\t// {\r\n\t// \ttype            : \"map\",\r\n\t// \tmap             : [[string|{name, next, prev}]],\r\n\t// \trelations       : {\r\n\t// \t\taround : true,\r\n\t// \t\tbeside : ???,\r\n\t// \t\tfall   : {\r\n\t// \t\t\tdirectories : [\r\n\t// \t\t\t\t\"down\",\r\n\t// \t\t\t\t\"right\"\r\n\t// \t\t\t]\r\n\t// \t\t}\r\n\t// \t}\r\n\t// }\r\n\r\n\tvar _decks = [];\r\n\t\r\n\tvar _default_placement = {\r\n\t\tx : 0,\r\n\t\ty : 0\r\n\t};\r\n\r\n\tvar _placement = \r\n\t\tthis.placement\r\n\t\t\t? {\r\n\t\t\t\tx : typeof this.placement.x != \"undefined\" ? this.placement.x : _default_placement.x,\r\n\t\t\t\ty : typeof this.placement.y != \"undefined\" ? this.placement.y : _default_placement.y\r\n\t\t\t}\r\n\t\t\t: _default_placement;\r\n\r\n\tthis.placement = {x : 0, y : 0};\r\n\r\n\tvar _index = 1;\r\n\r\n\tvar _mapSize = mapCommon.mapSize(e.map);\r\n\r\n\t// {name: 'groupName_deck_0_0'}\r\n\tfor(var y in e.map) {\r\n\t\tfor(var x in e.map[y]) {\r\n\r\n\t\t\tif(\r\n\t\t\t\ttypeof e.map[y][x] == \"boolean\" && e.map[y][x]\r\n\t\t\t || typeof e.map[y][x] == \"number\"  && e.map[y][x] > 0\r\n\t\t\t) {\r\n\t\t\t\te.map[y][x] = {};\r\n\t\t\t};\r\n\r\n\t\t\tif(typeof e.map[y][x] == \"string\") {\r\n\t\t\t\te.map[y][x] = {name: e.map[y][x]};\r\n\t\t\t} else if(\r\n\t\t\t\te.map[y][x]\r\n\t\t\t && typeof e.map[y][x]      != \"undefined\"\r\n\t\t\t && typeof e.map[y][x].name != \"string\"\r\n\t\t\t) {\r\n\t\t\t\te.map[y][x].name = this.name + \"_deck_\" + x + \"_\" + y;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tfor(var _y in e.map) {\r\n\t\tfor(var _x in e.map[_y]) {\r\n\r\n\t\t\tvar x = _x | 0,\r\n\t\t\t\ty = _y | 0;\r\n\r\n\t\t\tvar _el = e.map[y][x];\r\n\t\t\t\r\n\t\t\tif(_el) {\r\n\t\t\t\t\r\n\t\t\t\tlet _deck = {\r\n\t\t\t\t\t\"name\"     : e.map[y][x].name,// (this.name + \"_deck\" + _index) OR (this.name + '_' + e.map[y][x])\r\n\t\t\t\t\t\"position\" : {\r\n\t\t\t\t\t\t\"x\" : x * ((defaults.card.width  | 0) + (_placement.x | 0)),\r\n\t\t\t\t\t\t\"y\" : y * ((defaults.card.height | 0) + (_placement.y | 0))\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//  ---------------------------------------------------------\r\n\t\t\t\tlet _relations = [];\r\n\r\n\t\t\t\tlet _relGenerators = {\r\n\t\t\t\t\t\"around\" : \"mapAroundRelations\",\r\n\t\t\t\t\t\"beside\" : \"mapBesideRelations\",\r\n\t\t\t\t\t\"fall\"   : \"mapFallRelations\"\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif(e.relations) {\r\n\r\n\t\t\t\t\tfor(let relGenName in _relGenerators) {\r\n\r\n\t\t\t\t\t\tif(e.relations[relGenName]) {\r\n\t\t\t\t\t\t\t_relations = _relations.concat(relationsGenerator[_relGenerators[relGenName]]({\r\n\t\t\t\t\t\t\t\tx, y, \r\n\t\t\t\t\t\t\t\tmap     : e.map,\r\n\t\t\t\t\t\t\t\tmapSize : _mapSize,\r\n\t\t\t\t\t\t\t\tel      : _el,\r\n\t\t\t\t\t\t\t\tdata    : e.relations[relGenName]\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\r\n\t\t\t\t_deck.relations = _relations;\r\n\t\t\t\t//  ---------------------------------------------------------\r\n\t\t\t\t\r\n\t\t\t\t_decks.push(_deck);\r\n\t\t\t\t_index += 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn _decks;\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/mapGenerator.js\n **/","'use strict';\n\nimport mapFallRelations    from 'mapFallRelations';\nimport mapAroundRelations  from 'mapAroundRelations';\nimport mapBesideRelations  from 'mapBesideRelations';\nimport lineBesideRelations from 'lineBesideRelations';\n\nexport default {\n\tmapFallRelations   ,\n\tmapAroundRelations ,\n\tmapBesideRelations ,\n\tlineBesideRelations\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/relationsGenerator.js\n **/","'use strict';\n\nimport mapCommon from 'mapCommon';\n\n// map froup generator fall relations\n\n// const directions = [\n// \t'left' ,\n// \t'rigth',\n// \t'up'   ,\n// \t'down'\n// ];\n\nconst opposite = [\n\t// ['left', 'right'],\n\t// ['up'  , 'down' ]\n\t{left  : 'right'},\n\t{right : 'left' },\n\t{up    : 'down' },\n\t{down  : 'up'   }\n];\n\nexport default (e)=>{// {x, y, map, mapSize, el, data}\n\n\tvar _relations = [];\n\n\tlet _directions = [];\n\tfor(let i in e.data.directions) {\n\t\tif(\n\t\t\t_directions.indexOf(e.data.directions[i]) < 0          // этого направления ещё не было\n\t\t && _directions.indexOf(opposite[e.data.directions[i]]) < 0// противоположного направления тоже не было\n\t\t) {\n\t\t\t_directions.push(e.data.directions[i]);\n\t\t}\n\t}\n\t\n\tfor(let i in _directions) {\n\t\tswitch(_directions[i]) {\n\t\t\tcase 'left' :\n\t\t\t\tvar x = (e.x|0) + mapCommon.beSide.left.x,\n\t\t\t\t\ty = (e.y|0) + mapCommon.beSide.left.y;\n\t\t\t\tif(mapCommon.exist(x, y, e.mapSize, e.map)) {\n\t\t\t\t\t_relations.push({\n\t\t\t\t\t\tname      : 'fall',\n\t\t\t\t\t\tdirection : 'left',\n\t\t\t\t\t\tto        : e.map[y][x].name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\t\tvar x = (e.x|0) + mapCommon.beSide.right.x,\n\t\t\t\t\ty = (e.y|0) + mapCommon.beSide.right.y;\n\t\t\t\tif(mapCommon.exist(x, y, e.mapSize, e.map)) {\n\t\t\t\t\t_relations.push({\n\t\t\t\t\t\tname      : 'fall',\n\t\t\t\t\t\tdirection : 'right',\n\t\t\t\t\t\tto        : e.map[y][x].name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'up'   :\n\t\t\t\tvar x = (e.x|0) + mapCommon.beSide.up.x,\n\t\t\t\t\ty = (e.y|0) + mapCommon.beSide.up.y;\n\t\t\t\tif(mapCommon.exist(x, y, e.mapSize, e.map)) {\n\t\t\t\t\t_relations.push({\n\t\t\t\t\t\tname      : 'fall',\n\t\t\t\t\t\tdirection : 'up',\n\t\t\t\t\t\tto        : e.map[y][x].name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'down' :\n\t\t\t\tvar x = (e.x|0) + mapCommon.beSide.down.x,\n\t\t\t\t\ty = (e.y|0) + mapCommon.beSide.down.y;\n\t\t\t\tif(mapCommon.exist(x, y, e.mapSize, e.map)) {\n\t\t\t\t\t_relations.push({\n\t\t\t\t\t\tname      : 'fall',\n\t\t\t\t\t\tdirection : 'down',\n\t\t\t\t\t\tto        : e.map[y][x].name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn _relations;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/mapFallRelations.js\n **/","'use strict';\n\nconst beSide = {\n\tleft  : {x: -1, y:  0}, \n\tright : {x:  1, y:  0}, \n\tup    : {x:  0, y: -1}, \n\tdown  : {x:  0, y:  1} \n};\n\nlet inMap = (x, y, mapSize)=>{\n\treturn x >= 0\n\t\t&& y >= 0\n\t\t&& x < mapSize.width\n\t\t&& y < mapSize.height;\n};\n\nlet exist = (x, y, mapSize, map)=> {\n\treturn inMap(x, y, mapSize)\n\t\t&& map[y][x];\n};\n\nlet mapSize = (map)=>{\n\t\n\tlet _mapSize = {\n\t\twidth  : map[0].length,//MAX LENGTH\n\t\theight : map   .length\n\t};\n\t\n\tmap.forEach(function(e) {\n\t\t_mapSize.width = Math.max(_mapSize.width, e.length);\n\t});\n\n\treturn _mapSize;\n};\n\n// IDs             TYPEs\n// CLT TOP CRT ... CORN SIDE CORN\n// LFT     RGT ... SIDE      SIDE\n// CLB BTM CRB ... CORN SIDE CORN\nconst aroundRelations = [\n\n\t{x: -1, y: -1, type: 'corn', id: 'clt'},\n\t{x:  0, y: -1, type: 'side', id: 'top'},\n\t{x:  1, y: -1, type: 'corn', id: 'crt'},\n\t\n\t{x: -1, y:  0, type: 'side', id: 'lft'},\n\t{x:  1, y:  0, type: 'side', id: 'rgt'},\n\n\t{x: -1, y:  1, type: 'corn', id: 'clb'},\n\t{x:  0, y:  1, type: 'side', id: 'btm'},\n\t{x:  1, y:  1, type: 'corn', id: 'crb'}\n\n];\n\nexport default {\n\tbeSide         ,\n\tmapSize        ,\n\tinMap          ,\n\taroundRelations,\n\texist          \n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/mapCommon.js\n **/","'use strict';\n\nimport mapCommon from 'mapCommon';\n\nexport default (e)=>{// {x, y, map, mapSize, el, data}\n\n\tlet _relations = [];\n\n\tfor(let i in mapCommon.aroundRelations) {\n\n\t\tif(\n\t\t\tmapCommon.inMap(e.x + mapCommon.aroundRelations[i].x, e.y + mapCommon.aroundRelations[i].y, e.mapSize)\n\t\t && e.map[e.y + mapCommon.aroundRelations[i].y][e.x + mapCommon.aroundRelations[i].x]\n\t\t) {\n\t\t\t_relations.push({\n\t\t\t\tname : 'around',\n\t\t\t\ttype : mapCommon.aroundRelations[i].type,\n\t\t\t\tid   : mapCommon.aroundRelations[i].id,\n\t\t\t\tto   : e.map[e.y + mapCommon.aroundRelations[i].y][e.x + mapCommon.aroundRelations[i].x].name\n\t\t\t});\n\t\t\t\n\t\t}\n\t}\n\n\treturn _relations;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/mapAroundRelations.js\n **/","'use strict';\n\nimport mapCommon from 'mapCommon';\n\n// let getBeside = (_x, _y, mapSize, map, el, type)=>{\n\n// \tif(typeof el[type] == \"string\") {\n\n// \t\tswitch(el[type]) {\n// \t\t\tcase 'left':\n// \t\t\t\tvar x = _x + mapCommon.beSide.left.x,\n// \t\t\t\t\ty = _y + mapCommon.beSide.left.y;\n// \t\t\t\treturn mapCommon.exist(x, y, mapSize, map)\n// \t\t\t \t\t? map[y][x].name\n// \t\t\t \t\t: null;\n// \t\t\tcase 'rigth':\n// \t\t\t\tvar x = _x + mapCommon.beSide.rigth.x,\n// \t\t\t\t\ty = _y + mapCommon.beSide.rigth.y;\n// \t\t\t\treturn mapCommon.exist(x, y, mapSize, map)\n// \t\t\t \t\t? map[y][x].name\n// \t\t\t \t\t: null;\n// \t\t\tcase 'up':\n// \t\t\t\tvar x = _x + mapCommon.beSide.up.x,\n// \t\t\t\t\ty = _y + mapCommon.beSide.up.y;\n// \t\t\t\treturn mapCommon.exist(x, y, mapSize, map)\n// \t\t\t \t\t? map[y][x].name\n// \t\t\t \t\t: null;\n// \t\t\tcase 'down':\n// \t\t\t\tvar x = _x + mapCommon.beSide.down.x,\n// \t\t\t\t\ty = _y + mapCommon.beSide.down.y;\n// \t\t\t\treturn mapCommon.exist(x, y, mapSize, map)\n// \t\t\t \t\t? map[y][x].name\n// \t\t\t \t\t: null;\n// \t\t\tdefault:\n// \t\t\t\treturn null;\n// \t\t}\n// \t};\n// \treturn null;\n// };\n\nexport default (e)=>{// {x, y, map, mapSize, el, data}\n\n\tlet _relations = [];\n\n\t// var _next = getBeside(e.x, e.y, e.mapSize, e.map, e.el, 'next') && (\n\t// \t_relations.push({name: 'next', to: _next})\n\t// );\n\t// var _prev = getBeside(e.x, e.y, e.mapSize, e.map, e.el, 'prev') && (\n\t// \t_relations.push({name: 'prev', to: _prev})\n\t// );\n\n\treturn _relations;\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/mapBesideRelations.js\n **/","'use strict';\n\nimport mapCommon from 'mapCommon';\n\nexport default (e)=>{// {deckIndex, count, decks, data}\n\n\tlet _relations = [];\n\n\tvar _prev = e.deckIndex > 0\n \t\t? e.decks[(e.deckIndex|0) - 1].name\n \t\t: null;\n\tif(_prev) {\n\t\t_relations.push({\n\t\t\tname: 'beside',\n\t\t\ttype: 'prev',\n\t\t\tto  : _prev\n\t\t});\n\t}\n\n\tvar _next = e.deckIndex < e.count - 1\n \t\t? e.decks[(e.deckIndex|0) + 1].name\n \t\t: null;\n\tif(_next) {\n\t\t_relations.push({\n\t\t\tname: 'beside',\n\t\t\ttype: 'next',\n\t\t\tto  : _next\n\t\t});\n\t}\n\n\treturn _relations;\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/relations/lineBesideRelations.js\n **/","/*\n * сгенерировать ряд из N карт\n */\n\n'use strict';\n\nimport relationsGenerator from 'relationsGenerator';\n\nexport default function(e) {\n\t\n\t// {\n\t// \ttype\t : \"line\",\n\t// \tcount\t: int,\n\t// \trelations : {\n\t// \t\t\"beside\" : true\n\t// \t}\n\t// }\n\t\n\t// direction <- placement: {x, y}\n\n\tvar _count = e.count;\n\tvar _decks = [];\n\t\n\tfor(var deckIndex = 0; deckIndex < _count; deckIndex += 1) {\n\t\tvar _deckName = this.name + \"_deck\" + (deckIndex + 1);\n\t\t\n\t\tlet _deck = {\n\t\t\tname : _deckName\n\t\t};\n\n\t\t_decks.push(_deck);\n\t}\n\n\tif(e.first) {\n\t\t\n\t\tlet _deck = _decks[0];\n\t\t\n\t\tfor(let propName in e.first) {\n\t\t\t_deck[propName] = e.first[propName];\n\t\t}\n\t}\n\n\t_decks[0].tag = 'first';\n\n\tif(e.last) {\n\n\t\tlet _deck = _decks[_decks.length - 1];\n\t\t\n\t\tfor(let propName in e.first) {\n\t\t\t_deck[propName] = e.first[propName];\n\t\t}\n\t}\n\n\t_decks[_decks.length - 1].tag = 'last';\n\n\tfor(let deckIndex in _decks) {\n\t\t//  ---------------------------------------------------------\n\t\tlet _relations = [];\n\n\t\tlet _relGenerators = {\n\t\t\t\"beside\" : \"lineBesideRelations\"\n\t\t};\n\n\t\tif(e.relations) {\n\n\t\t\tfor(let relGenName in _relGenerators) {\n\n\t\t\t\t// TODO\n\t\t\t\tif(e.relations[relGenName]) {\n\t\t\t\t\t_relations = _relations.concat(relationsGenerator[_relGenerators[relGenName]]({\n\t\t\t\t\t\tdeckIndex,\n\t\t\t\t\t\tcount     : _count,\n\t\t\t\t\t\tdecks     : _decks,\n\t\t\t\t\t\tdata      : e.relations[relGenName]\n\t\t\t\t\t}));\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\n\t\t_decks[deckIndex].relations = _relations;\n\t\t//  ---------------------------------------------------------\n\t}\n\n\treturn _decks;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/group/generators/lineGenerator.js\n **/","'use strict';\n\nimport fallAutoStep from 'fallAutoStep';\n// import A         from 'A';\n// import B         from 'B';\n// import C         from 'C';\n\nconst autosteps = {\n\tfallAutoStep,\n//  A,\n//  B,\n//  C\n};\n\nexport default (autoStepsParams)=>{\n\t\n\tlet _autosteps = {};\n\n\tfor(let autoStepName in autoStepsParams) {\n\t\t\n\t\tif(autosteps[autoStepName]) {\n\t\t\t\n\t\t\tlet _autostep = new autosteps[autoStepName](autoStepsParams[autoStepName]);\n\t\t\t_autostep.init(autoStepName);\n\t\t\t\n\t\t\t_autosteps[autoStepName] = _autostep;\n\t\t} else {\n\t\t\tconsole.warn(`Autostep '${autoStepName}' is not exist.`);\n\t\t}\n\t}\n\n\treturn _autosteps;\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/autosteps/addAutoSteps.js\n **/","'use strict';\n\nimport share    from 'share';\nimport defaults from 'defaults';\nimport event    from 'event';\n\nimport autoStep from 'autoStep';\nimport Deck     from 'addDeck';\nimport Tips     from 'tips';\n\nexport default class fallAutoStep extends autoStep {\n\n\tconstructor(params) {\n\n\t\tsuper(params);\n\n\t\t// event.listen('fallAutoStepCheck', this.check);\n\t}\n\n\t// есть ли ещё ходы этого типа\n\tcheck() {\n\n\t\tTips.checkTips();\n\n\t\tlet _tips = Tips.getTips();\n\n\t\tif(_tips.length === 0) {\n\n\t\t\tthis.end();\n\t\t\t// Tips.checkTips();\n\t\t}\n\t}\n\n\t// start() {\n\t// \tsuper.start();\n\t// \tconsole.log('FALL AUTO STEP');\n\t// }\n\n\tauto() {\n\n\t\tconsole.log('-- fallAutoStep:auto', share.get('curLockState'));\n\t\t// fall lines auto\n\n\t\t// get groups\n\t\t// \tget fall directions ???\n\t\t// \tget decks\n\t\t// \tget fall relations\n\n\t\t// OR getTips + random ???\n\n\t}\n\n\t// manual если autostep = false\n\t// если click = true, вручную отрабатываем перемещения карт возвращаем false\n\t// если click = false то отрабатывается move а здесь проверка возможен ли ход\n\tmanual(data) {\n\n\t\t// empty\n\t\t// check fall\n\t\t// this.check();\n\t\tlet _from = Deck.getDeckById(data.putDeck[0].card.parent),\n\t\t    _to   = data.to;\n\n\t\tlet _relations = _from.getRelationsByName('fall', {from: null});\n\n\t\tfor(let i in _relations) {\n\t\t\tif(\n\t\t\t\t_relations[i].to == _to.name &&\n\t\t\t\t_to.cardsCount() === 0\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/autosteps/fallAutoStep.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport common   from 'common';\nimport defaults from 'defaults';\n\nexport default class {\n\n\tconstructor(params) {\n\n\t\tif(typeof params.groups != \"undefined\") {\n\t\t\tthis.groups = params.groups;\n\t\t}\n\t\t\n\t\tif(typeof params.event == \"string\") {\n\t\t\tthis.event = params.event;\n\t\t}\n\n\t\tif(typeof params.dispatch == \"string\") {\n\t\t\tthis.dispatch = params.dispatch;\n\t\t}\n\n\t\tif(typeof params.autoStep == \"boolean\") {\n\t\t\tthis.autoStep = params.autoStep;\n\t\t}\n\t}\n\n\tstart() {\n\t\t\n\t\tshare.set('stepType', this.stepType);\n\n\t\tif(this.autoStep) {\n\n\t\t\tcommon.curLock();\n\t\t\tthis.auto();\n\t\t} else {\n\n\t\t\tthis.check();\n\t\t}\n\t}\n\n\tend() {\n\n\t\tif(this.dispatch) {\n\t\t\tevent.dispatch(this.dispatch, {callback: ()=>{\n\t\t\t\tshare.set('stepType', defaults.stepType);\n\t\t\t}});\n\t\t} else {\n\t\t\t// share.set('stepType', defaults.stepType);\n\t\t}\n\t}\n\n\tinit(stepType) {\n\n\t\tthis.stepType = stepType;\n\n\t\tif(this.event) {\n\t\t\tevent.listen(this.event, ()=>{\n\t\t\t\tthis.start();\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(!this.autoStep) {\n\n\t\t\tevent.listen('moveEnd', ()=>{\n\n\t\t\t\tif(share.get('stepType') != this.stepType) { return; }\n\t\t\t\t\n\t\t\t\tthis.check();\n\t\t\t});\n\t\t}\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/autosteps/autoStep.js\n **/","'use strict';\r\n\r\n// import share from 'share';\r\nimport defaults from 'defaults';\r\n\r\n// import elRender from 'elRender';\r\n\r\nexport default ()=>{\r\n\r\n\r\n\t// let _locale = require('json!locales.json')[defaults.locale];\r\n\t\r\n\t// let Tpl = require(\"./preferncesTemplate.hamlc\");//\r\n\t\r\n\t// let _values = {\r\n\t// \tlocale: _locale,\r\n\t// \tpreferences: []\r\n\t// };\r\n\r\n\t// for(let propName in defaults.themes) {\r\n\t\t\r\n\t// \tlet _pref = {\r\n\t// \t\ttitle   : _locale[\"label_\" + propName],\r\n\t// \t\toptions : []\r\n\t// \t};\r\n\t\t\r\n\t// \tfor(let i in defaults.themes[propName]) {\r\n\t// \t\t_pref.options.push({\r\n\t// \t\t\tvalue : defaults.themes[propName][i],\r\n\t// \t\t\tlabel : _locale[defaults.themes[propName][i]]\r\n\t// \t\t});\r\n\t// \t}\r\n\r\n\t// \t_values.preferences.push(_pref);\r\n\t// };\r\n\r\n\t// let _html = Tpl(_values);\r\n\r\n// --\r\n\t\r\n\tlet _html = require('html!./preferncesTemplate.html');\r\n\r\n\t$(\"#gpCommit\")\r\n\t\t.parent()\r\n\t\t.before(_html);\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/preferences/drawPreferences.js\n **/","module.exports = \"<div id=\\\"solitaire-engine-style-preferences\\\">\\n    <h4>Настройки оформления</h4>\\n    <div>\\n\\t    <span class=\\\"solitaire-engine-style-preferences-label\\\">Фон:</span>\\n\\t    <!-- <select id=\\\"pref_field\\\" class=\\\"solitaire-engine-style-preferences-element\\\"> -->\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_field\\\" value=\\\"default_field\\\">\\n        \\tКлассический\\n    \\t</label>\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_field\\\" value=\\\"alternative_field\\\">\\n        \\tАльтернативный\\n    \\t</label>\\n\\t    <!-- </select> -->\\n\\t</div>\\n\\t<div>\\n\\t    <span class=\\\"solitaire-engine-style-preferences-label\\\">Лицевая сторона:</span>\\n\\t    <!-- <select id=\\\"pref_face\\\" class=\\\"solitaire-engine-style-preferences-element\\\"> -->\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_face\\\" value=\\\"default_face\\\">\\n        \\tКлассическая\\n    \\t</label>\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_face\\\" value=\\\"alternative_face\\\">\\n        \\tАнгло-американская\\n    \\t</label>\\n\\t    <!-- </select> -->\\n\\t</div>\\n    <div>\\n\\t    <span class=\\\"solitaire-engine-style-preferences-label\\\">Рубашка:</span>\\n\\t    <!-- <select id=\\\"pref_back\\\" class=\\\"solitaire-engine-style-preferences-element\\\"> -->\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_back\\\" value=\\\"default_back\\\">\\n        \\tКлассическая\\n    \\t</label>\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_back\\\" value=\\\"alternative_back\\\">\\n        \\tАльтернативная\\n    \\t</label>\\n        <!-- <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_back\\\" value=\\\"red_back\\\">\\n        \\tКрасная\\n    \\t</label>\\n        <label>\\n        \\t<input type=\\\"radio\\\" name=\\\"pref_back\\\" value=\\\"blue_back\\\">\\n        \\tСиняя\\n    \\t</label> -->\\n\\t    <!-- </select> -->\\n\\t</div>\\n    <!-- <div>\\n\\t    <span class=\\\"solitaire-engine-style-preferences-label\\\">Пустая ячейка:</span>\\n\\t    <select id=\\\"pref_empty\\\" class=\\\"solitaire-engine-style-preferences-element\\\">\\n\\t        <option value=0>Классическая</option>\\n\\t        <option value=1>С обводкой</option>\\n\\t    </select>\\n\\t</div> -->\\n\\n</div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/html-loader!./sources/preferences/preferncesTemplate.html\n ** module id = 49\n ** module chunks = 0\n **/","'use strict';\r\n\r\nimport event    from 'event';\r\nimport defaults from 'defaults';\r\n\r\nimport storage from 'storage';\r\n\r\nlet onShowParameters = ()=>{\r\n\r\n\tlet pref = storage.get('pref');\r\n\t!pref && (pref = defaults.pref);\r\n\t\r\n\tfor(var prefName in defaults.themes) {\r\n\t\tlet _pref = pref[prefName] ? pref[prefName] : defaults.pref[prefName];\r\n\t\t$(`input[name='pref_${prefName}'][value='${_pref}']`)\r\n\t\t\t.prop({checked: true});\r\n\t}\r\n};\r\n\r\nlet applyParameters = ()=>{\r\n\t\r\n\tvar pref = {};\r\n\tfor(var prefName in defaults.themes) {\r\n\t\tpref[prefName] = $(`input[name='pref_${prefName}']:checked`).val();\r\n\t}\r\n\r\n\tevent.dispatch('fieldThemesSet', pref);\r\n\r\n\tsaveParameters(pref);\r\n};\r\n\r\nlet saveParameters = (pref)=>{\r\n\r\n\tstorage.set('pref', pref);\r\n};\r\n\r\nexport default ()=>{\r\n\t\r\n\t// TODO переделать без jQuery\r\n\r\n\t$(\"#bbParameters\").click(onShowParameters);\r\n\t// event.dispatch('addDomEvent', {\r\n\t// \t\"event\"    : \"click\"\r\n\t// \t\"element\"  : \"#bbParameters\",\r\n\t// \t\"callback\" : onShowParameters\r\n\t// });\r\n\t\r\n\t// $(\"#gpCommit\").click(saveParameters);\r\n\t\r\n\t$(\"#solitaire-engine-style-preferences input\").change(applyParameters);\r\n\t// event.dispatch('addDomEvent', {\r\n\t// \t\"event\"    : \"change\"\r\n\t// \t\"element\"  : \".solitaire-engine-style-preferences-element\",\r\n\t// \t\"callback\" : applyParameters\r\n\t// });\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/preferences/preferencesEvents.js\n **/","'use strict';\n\nclass storage {\n\n\t// TODO настройки сохраняются для всех игр,\n\t// возможно нужно будет для каждой отдельно,\n\t// тогда в конфигурацию нужно будет включить gameId\n\n\tconstructor() {\n\t\t\n\t\ttry {\n\t\t\tif(!localStorage.hasOwnProperty('SolitaireEngine')) {\n\t\t\t\tlocalStorage.SolitaireEngine = \"{}\";\n\t\t\t}\n\t\t} catch(e) {}\n\t}\n\n\tset(key, data) {\n\n\t\ttry {\n\t\t\tlet _ls = JSON.parse(localStorage.SolitaireEngine);\n\t\t\t_ls[key] = data;\n\t\t\tlocalStorage.SolitaireEngine = JSON.stringify(_ls);\n\t\t} catch(e) {}\n\t}\n\t\n\tget(key) {\n\n\t\ttry {\n\t\t\tlet _ls = JSON.parse(localStorage.SolitaireEngine);\n\t\t\treturn _ls[key];\n\t\t} catch(e) {\n\t\t\treturn null;\n\t\t}\n\t}\n\t\n\tclear() {\n\t\t\n\t\ttry {\n\t\t\tlocalStorage.SolitaireEngine = \"{}\";\n\t\t} catch(e) {}\n\t}\n}\n\nexport default new storage();\n\n\n/** WEBPACK FOOTER **\n ** ./sources/common/storage.js\n **/","'use strict';\r\n\r\nimport event    from 'event';\r\nimport defaults from 'defaults';\r\n\r\nimport storage from 'storage';\r\n\r\nexport default ()=>{\r\n\r\n\tlet pref = storage.get('pref');\r\n\t!pref && (pref = defaults.pref);\r\n\r\n\tevent.dispatch('fieldThemesSet', pref);\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/preferences/defaultPreferences.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport defaults from 'defaults';\nimport common   from 'common';\n\nimport Deck     from 'addDeck';\nimport Tips     from 'tips';\nimport bestTip  from 'bestTip';\nimport winCheck from 'winCheck';\nimport Field    from 'field';\n\nvar Move = function(moveDeck, to, cursorMove) {\n\n\tcommon.animationDefault();\n\n\tlet _deck_destination = null,// to\n\t\t// находим стопку из которой взяли\n\t\t_deck_departure   = moveDeck[0].card.parent && common.getElementById(moveDeck[0].card.parent),// from\n\t\t_success          = true;\n\n\tlet _field = Field();\n\n\tlet _stepType = share.get('stepType');\n\n\t// выйти если не стандартный ход\n\tif(\n\t\t// var _field = Field();\n\t\t_stepType != defaults.stepType &&\n\t\t(\n\t\t\t_field.autoSteps             &&\n\t\t\t!_field.autoSteps[_stepType] ||\n\t\t\t!_field.autoSteps\n\t\t)\n\t) {\n\n\t\tlet _deck_departure = moveDeck[0].card.parent && common.getElementById(moveDeck[0].card.parent);\n\n\t\tevent.dispatch('moveCardToHome', {\n\t\t\tmoveDeck  : moveDeck,\n\t\t\tdeparture : _deck_departure,\n\t\t\tstepType  : share.get('stepType')\n\t\t});\n\t\treturn;\n\t}\n\n\tif(\n\t\t!cursorMove.dbclick           &&\n\t\tcursorMove.distance === 0     &&\n\t\tshare.get('moveDistance') > 0 &&\n\t\t_stepType == defaults.stepType\n\t) {\n\t\t// кликнули один раз\n\t\t// чтобы сделать ход нужно переместить карту стопку (moveDistance != 0)\n\t\treturn false;\n\t}\n\n\t_success = _success && to;// to - не пустой\n\n\tlet _el = to && to.id && common.getElementById(to.id);// получаем карту/стопку\n\n\t// если положили на карту узнаём из какой она стопки\n\tif(_el) {\n\t\tif(_el.type == 'card') {\n\t\t\t_deck_destination = common.getElementById(_el.parent)\n\t\t} else if(_el.type == 'deck') {\n\t\t\t_deck_destination = _el;\n\t\t}\n\t}\n\n\t_success = _success && _deck_destination;\n\n\t// _deck_departure = moveDeck[0].card.parent && common.getElementById(moveDeck[0].card.parent);\n\t\t_success = _success && _deck_departure;\n\n\t\t// смотрим не одна и та же ли эта стопка\n\t\tif(_deck_destination && _deck_destination.getId() != _deck_departure.getId()) {\n\n\t\t\t// узнаём можно ли положить карты на папку назначения\n\t\t\tvar _put = _deck_destination.Put(moveDeck);\n\t\t\t_success = _success && _put;\n\n\t\t\tif(_put) {// } && _deck_departure) {\n\n\t\t\t\t// если можно положить карты берём их из исходной стопки\n\t\t\t\tvar _pop = _deck_departure.Pop(moveDeck.length);\n\t\t\t\t_success = _success && _pop;\n\n\t\t\t\tif(_pop) {\n\t\t\t\t\t\n\t\t\t\t\t// ложим карты в колоду назначения\n\t\t\t\t\t_deck_destination.Push(_pop);\n\n\t\t\t\t\t// режим анимации по умолчанию\n\t\t\t\t\tcommon.animationDefault();\n\n\t\t\t\t\tevent.dispatch('addStep', {\n\t\t\t\t\t\t'move' : {\n\t\t\t\t\t\t\tfrom : _deck_departure  .name,\n\t\t\t\t\t\t\tto   : _deck_destination.name,\n\t\t\t\t\t\t\tdeck : Deck.deckCardNames(moveDeck),\n\t\t\t\t\t\t\tstepType : share.get('stepType')\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tevent.dispatch('saveSteps');\n\n\t\t\t\t\t// var _deck = _deck_departure.cards;\n\t\t\t\t\t// if(_deck.length && _deck[_deck.length - 1].flip) {\n\t\t\t\t\t\t\n\t\t\t\t\t// \t_deck[_deck.length - 1].flip = false;\n\t\t\t\t\t\t\n\t\t\t\t\t// \tevent.dispatch('addStep', {\n\t\t\t\t\t// \t\tdeck : _deck_departure.name,\n\t\t\t\t\t// \t\tcard : {\n\t\t\t\t\t// \t\t\tname  : _deck[_deck.length - 1].name,\n\t\t\t\t\t// \t\t\tindex : _deck.length - 1\n\t\t\t\t\t// \t\t}\n\t\t\t\t\t// \t});\n\t\t\t\t\t// }\n\n\t\t\t\t\tevent.dispatch('moveDragDeck', {\n\t\t\t\t\t\t\n\t\t\t\t\t\tdeparture   : _deck_departure,\n\t\t\t\t\t\tdestination : _deck_destination,\n\t\t\t\t\t\tmoveDeck    : moveDeck,\n\t\t\t\t\t\t\n\t\t\t\t\t\tcallback    : ()=>{\n\n\t\t\t\t\t\t\t// записать ход (если он не составной)\n\t\t\t\t\t\t\t// if(_stepType == defaults.stepType) {\t\t\t\t\n\t\t\t\t\t\t\t// }\n\n\t\t\t\t\t\t\tevent.dispatch('moveEnd', {\n\t\t\t\t\t\t\t\tfrom     : _deck_departure,\n\t\t\t\t\t\t\t\tto       : _deck_destination,\n\t\t\t\t\t\t\t\tmoveDeck : moveDeck\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tTips.checkTips();\n\n\t\t\t\t\t\t\twinCheck.winCheck({show : true});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// карту отпустили на той же стопке\n\t\t\t// + минимальное неоходимое расстояние для автохода не пройдено\n\t\t\t_success = false;\n\t\t}\n\n\t// если не кдалось положить карты, вернуть обратно\n\t// или положить на лучшее возможное место\n\tif(!_success && _deck_departure) {\n\n\t\t// достаточно ли перетащили (если клика не достаточно и не двойной клик)\n\t\tif(\n\t\t\t_field.inputParams.doubleClick                   &&\n\t\t\tcursorMove.dbclick                               ||\n\t\t\tcursorMove.distance >= share.get('moveDistance')\n\t\t) {\n\t\t\t\tvar Tip = bestTip(moveDeck, cursorMove);\n\n\t\t\t\tif(Tip) {\n\t\t\t\t\tMove(moveDeck, Tip.to.deck.domElement.el, cursorMove);\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tevent.dispatch('moveCardToHome', {\n\t\t\t\t\t\tmoveDeck  : moveDeck,\n\t\t\t\t\t\tdeparture : _deck_departure\n\t\t\t\t\t});\n\t\t\t\t\t// share.moveCardToHome();\n\t\t\t\t}\n\n\t\t} else {\n\t\t\tevent.dispatch('moveCardToHome', {\n\t\t\t\tmoveDeck  : moveDeck,\n\t\t\t\tdeparture : _deck_departure\n\t\t\t});\n\t\t}\n\n\t}\n\n\t// if(_success) {\n\t// afterMove();\n\t// }\n};\n\nevent.listen('Move', function(e) {\n\tMove(e.moveDeck, e.to, e.cursorMove);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/move.js\n **/","'use strict';\n\nimport share           from 'share';\nimport event           from 'event';\nimport common          from 'common';\n\nimport winCheckMethods from 'winCheckMethods';\nimport Deck            from 'addDeck';\n\nvar winCheck = function(params) {\n\n\tvar rulesCorrect = true;\n\tvar _hasMetods = false;\n\tvar _winCheck = share.get('winCheck');// _field.winCheck\n\t\n\tfor(var ruleName in _winCheck.rules) {\n\t\t_hasMetods = true;\n\t\t\n\t\tif(winCheckMethods[ruleName]) {\n\t\t\n\t\t\tlet _result = winCheckMethods[ruleName]({\n\t\t\t\tdecks     : Deck.getDecks({visible : true}), \n\t\t\t\trulesArgs : _winCheck.rules[ruleName]\n\t\t\t});\n\t\t\t\n\t\t\trulesCorrect = rulesCorrect && _result;\n\n\t\t} else {\n\t\t\trulesCorrect = rulesCorrect && winCheckMethods.newerWin();\n\t\t}\n\t}\n\t\n\tif(!_hasMetods) {\n\t\trulesCorrect = rulesCorrect && winCheckMethods.newerWin();\n\t}\n\n\tif(rulesCorrect) {\n\t\t\n\t\tif(params && params.noCallback) { return true; }\n\t\t\n\t\t// show you win message\n\t\tevent.dispatch('win', params);\n\n\t\tconsole.log('WIN');\n\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\n// hidden check\nvar hwinCheck = function(a) {\n\t\n\tif(!a) {\n\t\ta = {};\n\t}\n\t\n\tif(typeof a.show == 'undefined') {\n\t\ta.show = false;\n\t}\n\t\n\twinCheck(a);\n\t// return winCheck({noCallback : true});\n};\n\nexport default {\n\twinCheck, \n\thwinCheck\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/winCheck.js\n **/","'use strict';\n\n/*\n * Client-server application for planning biomechanical stimulation =)\n * version: 1.0\n * author: Romasan\n * date: 05.05.2016\n */\n\n// import share    from 'share';\nimport common   from 'common';\nimport defaults from 'defaults';\n\nvar wcm = {\n\t\n\t// Filters\n\n\t// возвращает колоды определённой группы/групп\n\tgroup : function(a) {\n\n\t\tif(!a.filter || !a.filterArgs) { return false; }\n\n\t\tvar _decks = [];\n\t\tfor(let _i in a.decks) {\n\t\t\t\n\t\t\t// var _parent = a.decks[_i].parent\n\t\t\t// if(a.filterArgs.indexOf(a.decks[_i].parent)) {\n\t\t\tif(\n\t\t\t\t(\n\t\t\t\t\ttypeof a.filterArgs == \"string\"     &&\n\t\t\t\t\ta.decks[_i].parent  == a.filterArgs\n\t\t\t\t) ||\n\t\t\t\t(\n\t\t\t \t\ta.filterArgs.length                           &&\n\t\t\t \t\ta.filterArgs.indexOf(a.decks[_i].parent) >= 0\n\t\t\t \t)\n\t\t\t) {\n\t\t\t\t_decks.push(a.decks[_i]);\n\t\t\t}\n\t\t}\n\t\t\n\t\ta.decks = _decks;\n\n\t\treturn _decks.length;\n\t},\n\n\tgroups : function(a) {\n\t\treturn wcm.group(a);\n\t},\n\n\tdeck: function(a) {\n\t\t\n\t\tif(!a.filter || !a.filterArgs) { return false; }\n\t\t\n\t\tlet _decks = [];\n\n\t\tfor(let _i in a.decks) {\n\t\t\tif(\n\t\t\t\ttypeof a.filterArgs == \"string\"             &&\n\t\t\t\ta.decks[_i].name == a.filterArgs            ||\n\t\t\t\ta.filterArgs.indexOf(a.decks[_i].name) >= 0\n\t\t\t) {\n\t\t\t\t_decks.push(a.decks[_i]);\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\ta.decks = _decks;\n\t\treturn _decks.length;\n\t},\n\t\n\tdecks: function(a) {\n\t\treturn wcm.deck(a);\n\t},\n\n\t// Tag filters\n\n\tfirstEmpty: function(a) {\n\n\t\tlet _decks = [];\n\t\t\n\t\tfor(let _i in a.decks) {\n\t\t\tif(a.decks[_i].tags.indexOf('last') >= 0) {\n\t\t\t\t_decks.push(a.decks[_i]);\n\t\t\t}\n\t\t}\n\n\t\ta.decks = _decks;\n\n\t\treturn _decks.length;\n\t},\n\n\t// Internal use\n\n\t_asc_desk : function(a) {\n\n\t\tif(!a || typeof a.asc_desk != 'number') { return false; }\n\n\t\tvar _correct = true;\n\t\t\n\t\tfor(var d in a.decks) {\n\n\t\t\tif(!_correct) return false;\n\t\t\t\n\t\t\tvar _cards = a.decks[d].cards;\n\t\t\tfor(var c in _cards) {\n\t\t\t\tif(c > 0) {\t\n\t\t\t\t\tvar down = common.validateCardName(_cards[(c|0) - 1].name),\n\t\t\t\t\t\t  up   = common.validateCardName(_cards[(c|0)].name);\n\t\t\t\t\tvar _cardsRankS = defaults.card.ranks;\n\t\t\t\t\t_correct = _correct && down && up && _cardsRankS.indexOf(down.rank) == (_cardsRankS.indexOf(up.rank) + a.asc_desk);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tconsole.log('asc_desk', a.asc_desk, _correct);\n\n\t\treturn _correct;\n\t},\n\n\t// Simple rules\n\n\tnewerWin : function() {\n\t\tconsole.warn(\"You use 'newerWin' rule for checking Win. Maybe arguments in 'winCheck.rule' have incorrect rule name.\")\n\t\treturn false;\n\t},\n\n\t// все колоды пусты\n\n\tallEmpty : function(a) {\n\n\t\tvar _correct = true;\n\t\t\n\t\tfor(var _i in a.decks) {\n\t\t\t_correct = _correct && a.decks[_i].cards.length === 0;\n\t\t}\n\t\t\n\t\treturn _correct;\n\t},\n\t\n\tempty: function(a) {\n\t\twcm.allEmpty(a);\n\t},\n\n\t// Combined rules (use like filter)\n\n\t// все карты в одной колоде\n\tallInOne : function(a) {\n\n\t\tvar _emptyDecksCount = 0,\n\t\t\t_decksLength     = 0,\n\t\t\t_fillIndex       = 0;\n\t\t\n\t\tfor(var i in a.decks) {\n\t\t\tif(a.decks[i].cards.length === 0) {\n\t\t\t\t_emptyDecksCount += 1;\n\t\t\t} else {\n\t\t\t\t_fillIndex = i;\n\t\t\t}\n\t\t\t_decksLength += 1;\n\t\t}\n\t\t\n\t\tvar _correct = _emptyDecksCount == _decksLength - 1;\n\t\t\n\t\tif(a.filter) {\n\t\t\ta.decks = _correct ? [a.decks[_fillIndex]] : [];\n\t\t}\n\n\t\treturn _correct\n\t},\n\n\t// step by step 1, 2, 3\n\t// во всех колодах карты по возрастанию\n\tallAscend : function(a) {\n\n\t\ta.asc_desk = -1;\n\t\treturn wcm._asc_desk(a);\n\t},\n\t\n\t// step by step 3, 2, 1\n\t// во всех колодах карты по убыванию\n\tallDescent : function(a) {\n\t\t\t\n\t\ta.asc_desk = 1;\n\t\treturn wcm._asc_desk(a);\n\t},\n\n\t// Composite rules (input arguments)\n\t// комбинированное правило\n\t\t\n\tlego : function(_a) {\n\t\t\n\t\tif(!_a || !_a.rulesArgs) return false;\n\t\t\n\t\tvar _correct = true;\n\t\t\n\t\t// apply filters\n\t\tfor(let next in _a.rulesArgs) {\n\n\t\t\tvar _decksClone = {};\n\t\t\tfor(var i in _a.decks) {\n\t\t\t\t_decksClone[i] = _a.decks[i];\n\t\t\t}\n\t\t\tvar a = {\n\t\t\t\t// filters : _a[next].filters,\n\t\t\t\t// rules   : _a[next].rules,\n\t\t\t\tdecks   : _decksClone\n\t\t\t};\n\n\t\t\t// применяем фильтры, оставляем только интересующие колоды\n\t\t\t\n\t\t\tif(_correct && _a.rulesArgs[next].filters) {\n\n\t\t\t\ta.filter = true;\n\n\t\t\t\tfor(let i in _a.rulesArgs[next].filters) {\n\t\t\t\t\tif(typeof _a.rulesArgs[next].filters[i] == 'string' && wcm[_a.rulesArgs[next].filters[i]]) {\n\t\t\t\t\t\ta.filterArgs = null;\n\t\t\t\t\t\t_correct = _correct && wcm[_a.rulesArgs[next].filters[i]](a);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// if(typeof _a.rulesArgs[next].filters[i] == 'object') {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t_a.rulesArgs[next].filters[i]                                 &&\n\t\t\t\t\t\t\t_a.rulesArgs[next].filters[i].toString() == \"[object Object]\"\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tfor(var filterName in _a.rulesArgs[next].filters[i]) {\n\t\t\t\t\t\t\t\tif(wcm[filterName]) {\n\t\t\t\t\t\t\t\t\ta.filterArgs = _a.rulesArgs[next].filters[i][filterName]\n\t\t\t\t\t\t\t\t\t_correct = _correct && wcm[filterName](a);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_correct = _correct && wcm.newerWin();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_correct = _correct && wcm.newerWin();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ta.filter = false;\n\t\t\t}\n\n\t\t\t// применяем правила к оставшимся колодам\n\n\t\t\tif(_a.rulesArgs[next].rules) {\n\t\t\t\t\n\t\t\t\tfor(let i in _a.rulesArgs[next].rules) {\n\t\t\t\t\tif(wcm[_a.rulesArgs[next].rules[i]]) {\n\t\t\t\t\t\t_correct = _correct && wcm[_a.rulesArgs[next].rules[i]](a);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_correct = _correct && wcm.newerWin();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\treturn _correct;\n\t}\n}\n\nexport default wcm;\n\n\n/** WEBPACK FOOTER **\n ** ./sources/winCheckMethods.js\n **/","'use strict';\r\n\r\nimport event from 'event';\r\n\r\nimport elRender from 'elRender';\r\n\r\nimport initField      from 'initField';\r\nimport drawDeck       from 'drawDeck';\r\nimport drawCard       from 'drawCard';\r\nimport drawTip        from 'drawTip';\r\nimport moveDragDeck   from 'moveDragDeck';\r\nimport moveCardToHome from 'moveCardToHome';\r\nimport fieldThemesSet from 'fieldThemesSet';\r\n\r\nevent.listen('removeEl', function(e) {\r\n\telRender(e.domElement)\r\n\t\t.remove();\r\n});\r\n\r\nevent.listen('showCard', function(target) {\r\n\telRender(target).show();\r\n});\r\n\r\nevent.listen('hideCard', function(target) {\r\n\telRender(target).hide();\r\n});\r\n\r\nevent.listen('stopAnimations', function() {\r\n\telRender.stopAnimations();\r\n});\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/domManager.js\n **/","'use strict';\n\n// let jquery = require(\"script!../../../frontend/js/jquery-2.2.4.min.js\");\n\n// export default jquery;\n\nimport defaults from 'defaults';\nimport share    from 'share';\n\nimport elClass    from 'elClass';\nimport allElClass from 'allElClass';\n\nshare.set('animatedElements',      0);\nshare.set('animatedElementsStack', []);\nshare.set('animatedCallback',      ()=>{});\n\nvar _allEl = (e)=>{\n\n\tif(!e) {\n\t\tthrow new Error(\"elRender:empty arguments\");\n\t}\n\t\n\tif(typeof e == \"string\") {\n\n\t\ttry {\n\t\t\tif(e[0] == \"#\") {\n\t\t\t\tlet _element = document.getElementById(e.slice(1, Infinity));\n\t\t\t\treturn new elClass(_element);\n\t\t\t} else if(e[0] == \".\") {\n\t\t\t\tlet _elements = document.getElementsByClassName(e.slice(1, Infinity));\n\t\t\t\treturn new allElClass(_elements);\n\t\t\t} else if(e[0] == \"<\") {\n\t\t\t\tlet _temp = document.createElement('temp');\n\t\t\t\t_temp.innerHTML = e;\n\t\t\t\tlet _element = _temp.children[0];\n\t\t\t\treturn new elClass(_element);\n\t\t\t}\n\t\t} catch(e) {}\n\t\t\n\t} else if(e.el || e.elements) {\n\t\treturn e;\n\t} else {\n\t\treturn new elClass(e);\n\t}\n};\n\n_allEl.stopAnimations = (callback)=>{\n\n\t_allEl(\".animated\")\n\t\t.css({transition: '0s'})\n\t\t.removeClass(\"animated\");\n\n\t/*var _animatedElementsStack = share.get('animatedElementsStack');\n\n\tfor(var i in _animatedElementsStack) {\n\t\t_animatedElementsStack[i].el.style.transition = null;\n\t};\n\tshare.set('animatedElementsStack', []);\n\n\tshare.set('animatedElements', 0);\n\tvar _animatedCallback = share.get('animatedCallback');\n\t_animatedCallback.call(this);\n\tshare.set('animatedCallback', ()=>{});*/\n};\n\nexport default _allEl;\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/render/elRender.js\n **/","'use strict';\n\nimport event    from 'event';\nimport share    from 'share';\nimport defaults from 'defaults';\n\nexport default class elClass {\n\t\n\tconstructor(e) {\n\t\n\t\tthis.el = e;\n\t\t\n\t\tif(!e) {\n\t\t\t// if(window._debug) throw new Error(\"test\");\n\t\t\tthis.el = null;\n\t\t}\n\t}\n// --\n\tattr(attributes) {\n\t\ttry {\n\t\t\tfor(var attrName in attributes) {\n\t\t\t\tthis.el[attrName] = attributes[attrName];\n\t\t\t}\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\t\n\thasClass(className) {\n\t\ttry {\n\t\n\t\t\tvar _classes = this.el.className.split(' ');\n\t\t\treturn _classes.indexOf(className) >= 0;\n\t\t} catch(e) {}\n\t}\n// --\t\n\ttoggleClass(className) {\n\t\ttry {\n\t\n\t\t\tif(this.hasClass(className)) {\n\t\t\t\tthis.removeClass(className);\n\t\t\t} else {\n\t\t\t\tthis.addClass(className);\n\t\t\t}\n\t\t} catch(e) {}\n\t}\n// --\t\n\taddClass(className) {\n\t\ttry {\n\t\n\t\t\tvar _classes = this.el.className.split(' ');\n\t\t\tif(!this.hasClass(className)) {\n\t\t\t\t_classes.push(className);\n\t\t\t\tthis.el.className = _classes.join(' ');\n\t\t\t}\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\t\n\tremoveClass(className) {\n\n\t\tif(!this.el || !this.el.className) return this;\n\t\t\n\t\ttry {\n\n\t\t\tvar _classes = this.el.className.split(' ');\n\t\t\t\n\t\t\tif(this.hasClass(className)) {\n\t\n\t\t\t\tvar _clone = [];\n\t\t\t\tfor(var i in _classes) {\n\t\t\t\t\tif(_classes[i] != className) {\n\t\t\t\t\t\t_clone.push(_classes[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t_classes = _clone;\n\t\t\t\tthis.el.className = _classes.join(' ');\n\t\t\t}\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\t\n\tcss(a) {\n\n\t\tif(!this.el) return this;\n\n\t\ttry {\n\t\n\t\t\tfor(var attrName in a) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.el.style[attrName] = a[attrName];\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\t\n\thide() {\n\t\ttry {\n\t\n\t\t\treturn this.css({'display' : 'none'});\n\t\t} catch(e) {}\n\t}\n// --\t\n\tshow() {\n\t\ttry {\n\t\t\t\n\t\t\treturn this.css({'display' : 'block'});\n\t\t} catch(e) {}\n\t}\n// --\t\n\tappend(el) {\n\t\ttry {\n\t\n\t\t\tif(el.el) {\n\t\t\t\tel = el.el;\n\t\t\t}\n\t\t\tthis.el.appendChild(el);\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\t\n\thtml(el) {\n\t\ttry {\n\t\n\t\t\tif(typeof el == \"undefined\") {\n\t\t\t\treturn this.el.innerHTML;\n\t\t\t}\n\t\t\t\n\t\t\tif(el.el) {\n\t\t\t\tel = el.el;\n\t\t\t}\n\t\t\t\n\t\t\tthis.el.innerHTML = el;\n\t\t\t\n\t\t\treturn this;\n\t\t} catch(e) {}\n\t}\n// --\n\tanimate(params, animationTime, callback, animationName) {\n\n\t\ttry {\n\t\t\tvar _animation = share.get('animation');\n\n\t\t\ttypeof animationTime == \"undefined\" && (animationTime = defaults.animationTime);\n\t\t\ttypeof animationTime == \"function\"  && (callback = animationTime, animationTime = defaults.animationTime);\n\t\t\ttypeof callback      == \"string\"    && (animationName = callback, callback = null);\n\n\t\t\t// Thread\n\t\t\tsetTimeout(()=>{\n\n\t\t\t\tif(_animation) {\n\t\t\t\t\tthis.css({transition: (animationTime / 1000) + 's'});\n\t\t\t\t}\n\n\t\t\t\tlet counter = 0;\n\n\t\t\t\tlet reType = (e) => {// crutch\n\t\t\t\t\tlet _e = e + '';\n\t\t\t\t\tlet _px = _e.split('px')\n\t\t\t\t\tif(_px.length == 2) {\n\t\t\t\t\t\treturn (_e[0] | 0) + 'px'\n\t\t\t\t\t\tconsole.log('###', e, _e);\n\t\t\t\t\t}\n\t\t\t\t\treturn e;\n\t\t\t\t};\n\n\t\t\t\tfor(var attrName in params) {\n\n\t\t\t\t\tconsole.log('animation_counter:', \n\t\t\t\t\t\t\n\t\t\t\t\t\tattrName, \n\t\t\t\t\t\t\n\t\t\t\t\t\treType(this.el.style[attrName]), \n\t\t\t\t\t\treType(params[attrName]), \n\t\t\t\t\t\treType(this.el.style[attrName]) != reType(params[attrName]),\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.el.style[attrName], \n\t\t\t\t\t\tparams[attrName], \n\t\t\t\t\t\tthis.el.style[attrName] != params[attrName]\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\t\tif(\n\t\t\t\t\t\tthis.el.style[attrName] != params[attrName]\n\t\t\t\t\t\t// reType(this.el.style[attrName]) != reType(params[attrName])\n\t\t\t\t\t) {\n\t\t\t\t\t\tcounter += 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.el.style[attrName] = params[attrName];\n\t\t\t\t}\n\n\t\t\t\tif(_animation) {\n\n\t\t\t\t\tthis.addClass(\"animated\");\n\n\t\t\t\t\tthis.el.addEventListener(\"transitionend\", ()=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\tcounter -= 1;\n\n\t\t\t\t\t\tconsole.log('animation counter', counter, typeof callback, !counter);\n\n\t\t\t\t\t\t// event.dispatch('animationEnd', this);\n\n\t\t\t\t\t\tif(!counter) {\n\n\t\t\t\t\t\t\tthis.removeClass(\"animated\");\n\t\t\t\t\t\t\tthis.css({transition: null});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(typeof callback == \"function\") {\n\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tevent.dispatch('allAnimationsEnd', animationName);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, false);\n\t\t\t\t} else {\n\n\t\t\t\t\t// event.dispatch('animationEnd', this);\n\n\t\t\t\t\tif(typeof callback == \"function\") {\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}\n\n\t\t\t\t\tevent.dispatch('allAnimationsEnd', animationName);\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t} catch(e) {}\n\t}\n// --\t\n\tremove() {\n\t\ttry {\n\t\t\t\n\t\t\tthis.el.remove();\n\t\t} catch(e) {}\n\t}\n\n\t/*getEl() {\n\t\t\n\t\treturn this.el;\n\t}*/\n\n\tparent() {\n\t\treturn new elClass(this.el.parentNode);\n\t}\n\t\n\tafter(html) {\n\t\ttry {\n\t\t\tthis.el.parentNode.insertBefore(html, this.el.nextElementSibling);\n\t\t\t/*if(html.el) html = html.el;\n\n\t\t\tvar _parentElements = this.el.parentNode.children;\n\t\t\tvar _newChildren = [];\n\t\t\t\n\t\t\tfor(var i in _parentElements) {\n\t\t\t\t_newChildren.push(_parentElements[i]);\n\t\t\t\tif(_parentElements[i] == this.el) {\n\t\t\t\t\t_newChildren.push(html);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.el.parentNode.children = _newChildren;*/\n\t\t} catch(e) {}\n\t\treturn this;\n\t}\n\n\tbefore(html) {\n\t\ttry {\n\t\t\tthis.el.parentNode.insertBefore(html, this.el);\n\t\t\t/*if(html.el) html = html.el;\n\n\t\t\tvar _parentElements = this.el.parentNode.children;\n\t\t\tvar _newChildren = [];\n\t\t\t\n\t\t\tfor(var i in _parentElements) {\n\t\t\t\tif(_parentElements[i] == this.el) {\n\t\t\t\t\t_newChildren.push(html);\n\t\t\t\t}\n\t\t\t\t_newChildren.push(_parentElements[i]);\n\t\t\t}\n\t\t\t\n\t\t\tthis.el.parentNode.children = _newChildren;*/\n\t\t} catch(e) {}\n\t\treturn this;\n\t}\n\n\tevent(eventName, callback) {\n\t\tthis.el.addEventListener(eventName, callback);\n\t}\n\n\tclick(callback) {\n\t\tthis.event(callback);\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/render/elClass.js\n **/","'use strict';\n\nimport defaults from 'defaults';\n\nimport elClass  from 'elClass';\n\nexport default class allElClass {\n\t\n\tconstructor(elements) {\n\t\t\n\t\tthis.elements = [];\n\n\t\tfor(var i in elements) {\n\t\t\tthis.elements.push(new elClass(elements[i]));\n\t\t}\n\t}\n// --\n\tattr(attributes) {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].attr(attributes)\n\t\t}\n\t\treturn this;\n\t}\n// --\n\ttoggleClass(className) {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].toggleClass(className);\n\t\t}\n\t\treturn this;\n\t}\n// --\n\taddClass(className) {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].addClass(className);\n\t\t}\n\t\treturn this;\n\t}\n// --\n\tremoveClass(className) {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].removeClass(className);\n\t\t}\n\t\treturn this;\n\t}\n// --\n\tcss(a) {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].css(a);\n\t\t}\n\t\treturn this;\n\t}\n// --\n\thide() {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].hide();\n\t\t}\n\t\treturn this;\n\t}\n// --\n\tshow() {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].show();\n\t\t}\n\t\treturn this;\n\t}\n// --\n\tanimate(params, animationTime, callback, animationName) {\n\t\t\n\t\ttypeof animationTime == \"undefined\" && (animationTime = defaults.animationTime);\n\t\ttypeof animationTime == \"function\"  && (callback = animationTime, animationTime = defaults.animationTime);\n\t\ttypeof callback      == \"string\"    && (animationName = callback, callback = null);\n\n\t\tlet counter = 0;\n\t\t\n\t\tfor(var i in this.elements) {\n\t\t\tcounter += 1;\n\t\t\tthis.elements[i].animate(params, animationTime, ()=>{\n\t\t\t\tcounter -= 1;\n\t\t\t\tif(!counter) callback();\n\t\t\t});\n\t\t}\n\t\treturn this;\n\t}\n// --\n\tremove() {\n\t\tfor(var i in this.elements) {\n\t\t\tthis.elements[i].remove();\n\t\t}\n\t\treturn this;\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/render/allElClass.js\n **/","'use strict';\r\n\r\nimport share    from 'share';\r\nimport event    from 'event';\r\nimport defaults from 'defaults';\r\n\r\nimport Field    from 'field';\r\nimport elRender from 'elRender';\r\n\r\nevent.listen('initField', function(e) {\r\n\r\n\t\r\n\tvar domElement = e.a.field ? e.a.field : '#map';// default;\r\n\tif(typeof domElement == 'string') {\r\n\t\tif(domElement.split('.').length == 2) {\r\n\t\t\tdomElement = document.getElementsByClassName(domElement.split('.')[1])[0];\r\n\t\t} else if(domElement.split('#').length == 2) {\r\n\t\t\t\r\n\t\t\tdomElement = document.getElementById(domElement.split('#')[1]);\r\n\t\t\t\r\n\t\t} else {\r\n\t\t\tdomElement = document.getElementsByTagName(domElement);\r\n\t\t}\r\n\t\tif(!domElement) {\r\n\t\t\tdomElement = document.getElementById('mat')\r\n\t\t}\r\n\t};\r\n\t// share.field = e.field;\r\n\tvar _field = Field();\r\n\t_field.domElement = domElement;\r\n\r\n\tvar _params = {};\r\n\r\n\tif(e.a.width  && typeof e.a.width  == 'number') { _params.width  = e.a.width  + 'px'; }\r\n\tif(e.a.height && typeof e.a.height == 'number') { _params.height = e.a.height + 'px'; }\r\n\tif(e.a.top    && typeof e.a.top    == 'number') { _params.top    = e.a.top    + 'px'; }\r\n\tif(e.a.left   && typeof e.a.left   == 'number') { _params.left   = e.a.left   + 'px'; }\r\n\r\n\tvar _zoom = share.get('zoom');\r\n\t(_zoom != defaults.zoom || _zoom != 1) && (_params.transform = 'scale(' + _zoom + ')', _params['transform-origin'] = '0 0');\r\n\t// if(a.rotate && typeof a.rotate == 'number') _params.transform = 'rotate(' + (a.rotate|0) + 'deg)';\r\n\t\r\n\t// var themeName = \r\n\t// \ttypeof e.a.theme == 'string' \r\n\t// \t\t? e.a.theme \r\n\t// \t\t: typeof e.a.theme == 'object' && e.a.theme.name\r\n\t// \t\t\t? e.a.theme.name\r\n\t// \t\t\t: defaults.theme.name;\r\n\r\n\telRender(domElement)\r\n\t\t.css(_params)\r\n\t\t.addClass('solitaireField')\r\n\t\t// .addClass(themeName);\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/initField.js\n **/","'use strict';\r\n\r\nimport event    from 'event';\r\nimport share    from 'share';\r\nimport defaults from 'defaults';\r\n\r\nimport Field    from 'field';\r\nimport elRender from 'elRender';\r\n\r\nvar applyChangedParameters = function(p, a, deck) {\r\n\t\r\n\tp.x = a.position && a.position.x && typeof a.position.x == 'number'  ? a.position.x : 0,\r\n\tp.y = a.position && a.position.y && typeof a.position.y == 'number'  ? a.position.y : 0;\r\n\tp.x = a.parentPosition && a.parentPosition.x ? p.x + a.parentPosition.x : p.x;\r\n\tp.y = a.parentPosition && a.parentPosition.y ? p.y + a.parentPosition.y : p.y;\r\n\t\r\n\tdeck.rotate = p.rotate = a.rotate && typeof a.rotate == 'number' ? a.rotate : 0;\r\n\t\r\n\t// у padding_x, padding_y приоритет выше чем paddingType\r\n\r\n\tp.padding_y = a.paddingY          && typeof a.paddingY     == 'number' \r\n\t\t? a.paddingY \r\n\t\t: a.paddingType\r\n\t\t\t? defaults.padding_y      \r\n\t\t\t: 0,\r\n\tp.padding_x = a.paddingX          && typeof a.paddingX     == 'number' \r\n\t? a.paddingX \r\n\t: a.paddingType\r\n\t\t? defaults.padding_x      \r\n\t\t: 0,\r\n\tp.flip_padding_y = a.flipPaddingY && typeof a.flipPaddingY == 'number' \r\n\t? a.flipPaddingY \r\n\t: a.paddingType\r\n\t\t? defaults.flip_padding_y \r\n\t\t: 0,\r\n\tp.flip_padding_x = a.flipPaddingX && typeof a.flipPaddingX == 'number' \r\n\t? a.flipPaddingX \r\n\t: a.paddingType\r\n\t\t? defaults.flip_padding_x \r\n\t\t: 0;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('addDeckEl', function(e) {\r\n\r\n\tvar _field = Field();\r\n\t\r\n\tapplyChangedParameters(e.params, e.a, e.deck);\r\n\r\n\te.deck.domElement = \r\n\t\telRender('<div>')\r\n\t\t\t// .getEl();\r\n\t\r\n\tvar _params = {\r\n\t\tleft      : e.params.x           + 'px',\r\n\t\ttop       : e.params.y           + 'px',\r\n\t\twidth     : defaults.card.width  + 'px',\r\n \t\theight    : defaults.card.height + 'px',\r\n\t\ttransform : 'rotate(' + (e.params.rotate|0) + 'deg)'\r\n\t};\r\n\t\r\n\t_params.display = e.deck.visible ? 'block' : 'none';\r\n\r\n\telRender(e.deck.domElement)\r\n\t\t.css(_params)\r\n\t\t.addClass('el')\r\n\t\t.attr({\r\n\t\t\tid: e.deck.getId()\r\n\t\t});\r\n\r\n\t// var showSlot = e.a.showSlot && typeof e.a.showSlot == 'boolean' ? e.a.showSlot : defaults.showSlot;\r\n\tif(e.a.showSlot) {\r\n\t\telRender(e.deck.domElement)\r\n\t\t\t.addClass('slot');\r\n\t}\r\n\tif(e.a.class) {\r\n\t\telRender(e.deck.domElement)\r\n\t\t\t.addClass(e.a.class);\r\n\t}\r\n\r\n\telRender(_field.domElement)\r\n\t\t.append(e.deck.domElement);\r\n\r\n\r\n\t// add label\r\n\t\t\r\n\tvar label = e.a.label && typeof e.a.label == 'string' ? e.a.label : null;\r\n\t\r\n\tif(dev && !e.a.label && share.get('debugLabels')) {\r\n\t\tlabel = '<span style=\"color:#65B0FF;\">' + e.deck.name + '</span>';\r\n\t}\r\n\tif(label) {\r\n\t\tvar _labelElement = \r\n\t\t\telRender('<div>')\r\n\t\t\t\t.addClass('deckLabel')\r\n\t\t\t\t// .attr({\r\n\t\t\t\t// \t\"title\" : e.deck.getId() + \" (\" + e.deck.parent + \")\"\r\n\t\t\t\t// })\r\n\t\t\t\t// .getEl();\r\n\t\telRender(_labelElement)\r\n\t\t\t.html(label);\r\n\t\telRender(e.deck.domElement)\r\n\t\t\t.append(_labelElement);\r\n\t\t\r\n\t}\r\n\r\n});\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('redrawDeckFlip', function(e) {\r\n\t\r\n\tif(!e || !e.cards) return;\r\n\r\n\tfor(var i in e.cards) {\r\n\t\tvar _params = {};\r\n\t\t\r\n\t\tif(e.cards[i].flip) {\r\n\t\t\telRender(e.cards[i].domElement)\r\n\t\t\t\t.addClass('flip');\r\n\t\t} else {\r\n\t\t\telRender(e.cards[i].domElement)\r\n\t\t\t\t.removeClass('flip');\r\n\t\t}\r\n\t\telRender(e.cards[i].domElement)\r\n\t\t\t.css(_params);\r\n\t}\r\n\r\n});\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('redrawDeckIndexes', function(e) {\r\n\t\r\n\tif(!e || !e.cards) return;\r\n\r\n\tfor(var i in e.cards) {\r\n\t\telRender(e.cards[i].domElement).css({\r\n\t\t\t'z-index' : (defaults.startZIndex|0) + (i|0)\r\n\t\t})\r\n\t}\r\n});\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('redrawDeck', function(e) {\r\n\r\n\tif(share.get('noRedraw')) { return false; };\r\n\r\n\tif(e.data) {\r\n\t\tapplyChangedParameters(e.params, e.data, e.deck);\r\n\r\n\t\tif(e.data.paddingX    ) share.get('padding_x',      e.data.paddingX    );\r\n\t\tif(e.data.flipPaddingX) share.get('flip_padding_x', e.data.flipPaddingX);\r\n\t\tif(e.data.paddingY    ) share.get('padding_y',      e.data.paddingY    );\r\n\t\tif(e.data.flipPaddingY) share.get('flip_padding_y', e.data.flipPaddingY);\r\n\t}\r\n\r\n\tvar _params = {\r\n\t\tleft      : e.params.x,\r\n\t\ttop       : e.params.y,\r\n\t\ttransform : 'rotate(' + (e.params.rotate|0) + 'deg)'\r\n\t};\r\n\t\r\n\t_params.display = e.deck.visible ? 'block' : 'none';\r\n\r\n\telRender(e.deck.domElement)\r\n\t\t.css(_params);\r\n\r\n\tfor(var i in e.cards) {\r\n\t\tvar _card_position = e.deck.padding(i);\r\n\t\tvar _zIndex = (e.params.startZIndex|0) + (i|0);\r\n\t\tvar _params = {\r\n\t\t\t'left'              : _card_position.x + 'px', \r\n\t\t\t'top'               : _card_position.y + 'px',\r\n\t\t\t'z-index'           : _zIndex,\r\n\t\t    '-ms-transform'     : 'rotate(' + (e.params.rotate|0) + 'deg)',\r\n\t\t    '-webkit-transform' : 'rotate(' + (e.params.rotate|0) + 'deg)',\r\n\t\t    '-moz-transform'    : 'rotate(' + (e.params.rotate|0) + 'deg)',\r\n\t\t\t'transform'         : 'rotate(' + (e.params.rotate|0) + 'deg)'\r\n\t\t};\r\n\t\t_params.display = e.deck.visible ? 'block' : 'none';\r\n\r\n\t\t// e.deck.checkFlip(e.cards[i], i|0, e.cards.length|0);\r\n\t\t\r\n\t\tif(e.cards[i].flip) {\r\n\t\t\telRender(e.cards[i].domElement)\r\n\t\t\t\t.addClass('flip');\r\n\t\t} else {\r\n\t\t\telRender(e.cards[i].domElement)\r\n\t\t\t\t.removeClass('flip');\r\n\t\t}\r\n\t\telRender(e.cards[i].domElement)\r\n\t\t\t.css(_params);\r\n\t}\r\n\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/drawDeck.js\n **/","'use strict';\r\n\r\nimport share    from 'share';\r\nimport event    from 'event';\r\nimport defaults from 'defaults';\r\nimport common   from 'common';\r\n\r\nimport Field    from 'field';\r\nimport elRender from 'elRender';\r\n\r\nevent.listen('addCardEl', function(e) {\r\n\t\r\n\tvar _field = Field();\r\n\t\r\n\tvar _card = {\r\n\t\twidth  : defaults.card.width,\r\n\t\theight : defaults.card.height\r\n\t};\r\n\t_card = {\r\n\t\twidth  : _card.width .toFixed(3) * 1,\r\n\t\theight : _card.height.toFixed(3) * 1\r\n\t};\r\n\r\n\tvar _params = {\r\n\t\t\"width\"  : _card.width  + 'px',\r\n\t\t\"height\" : _card.height + 'px'\r\n\t};\r\n\r\n\te.domElement = \r\n\t\telRender('<div>')\r\n\t\t\t// .getEl();\r\n\t\r\n\telRender(e.domElement)\r\n\t\t// .addClass(e.name)\r\n\t\t.addClass('el card draggable ' + e.name)\r\n\t\t// .css({'background-size' : null})\r\n\t\t.css(_params)\r\n\t\t.attr({\r\n\t\t\tid: e.id\r\n\t\t});\r\n\telRender(_field.domElement)\r\n\t\t.append(e.domElement);\r\n});\r\n\r\nevent.listen('hideCard', function(e) {\r\n\r\n\tif(e && e.domElement) {\r\n\t\telRender(e.domElement[0])\r\n\t\t\t.hide();\r\n\t}\r\n});\r\n\t\r\nevent.listen('showCard', function(e) {\r\n\r\n\tif(e && e.domElement) {\r\n\t\telRender(e.domElement[0])\r\n\t\t\t.show();\r\n\t}\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/drawCard.js\n **/","'use strict';\r\n\r\nimport event    from 'event';\r\n\r\nimport elRender from 'elRender';\r\nimport Tips     from 'tips';\r\n\r\nevent.listen('showTip', function(e) {\r\n\r\n\tif(e && e.el && e.el.domElement && e.type) {\r\n\t\telRender(e.el.domElement)\r\n\t\t\t.addClass(e.type);\r\n\t}\r\n});\r\n\r\nevent.listen('hideTips', function(e) {\r\n\t\r\n\tif(e && e.types) {\r\n\t\tfor(var i in e.types) {\r\n\t\t\tvar typeName = e.types[i];\r\n\t\t\telRender('.' + typeName)\r\n\t\t\t\t.removeClass(typeName);\r\n\t\t}\r\n\t} else {\r\n\t\t\r\n\t\tfor(var i in Tips.tipTypes) {\r\n\t\t\tvar typeName = Tips.tipTypes[i];\r\n\t\t\telRender('.' + typeName)\r\n\t\t\t\t.removeClass(typeName);\r\n\t\t}\r\n\r\n\t}\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/drawTip.js\n **/","'use strict';\r\n\r\nimport event\tfrom 'event';\r\nimport share\tfrom 'share';\r\nimport common\tfrom 'common';\r\nimport defaults from 'defaults';\r\n\r\nimport elRender from 'elRender';\r\n\r\nlet angleValidate = (_angle)=>{\r\n\r\n\tif(_angle < 0\t ) { _angle += 360; }\r\n\tif(_angle > 360) { _angle -= 360; }\r\n\r\n\treturn _angle;\r\n};\r\n\r\nevent.listen('moveDragDeck', (e)=>{\r\n\r\n\tcommon.curLock();\r\n\r\n\tlet _lastIndex = e.moveDeck.length - 1;\r\n\tfor(let i in e.moveDeck) {\r\n\r\n\t\tlet _position = e.destination.padding(e.destination.cards.length - 1 + (i | 0));\r\n\r\n\t\tlet departureAngle = angleValidate(e.departure\t.rotate), \r\n\t\t\tdestinationAngle = angleValidate(e.destination.rotate);\r\n\r\n\t\telRender(e.moveDeck[i].card.domElement)\r\n\t\t\t.css({\r\n\t\t\t\t'transform' : 'rotate(' + departureAngle + 'deg)'\r\n\t\t\t})\r\n\r\n\t\tif(departureAngle - destinationAngle > 180) {\r\n\t\t\t\r\n\t\t\tdepartureAngle = departureAngle - 360;\r\n\t\t\telRender(e.moveDeck[i].card.domElement)\r\n\t\t\t\t.css({\r\n\t\t\t\t\t'transform' : 'rotate(' + departureAngle + 'deg)'\r\n\t\t\t\t})\r\n\t\t};\r\n\t\t\r\n\t\tif(departureAngle - destinationAngle < -180) {\r\n\t\t\tdestinationAngle -= 360;\r\n\t\t}\r\n\r\n\t\tlet _params = {\r\n\t\t\t'left'\t\t\t: _position.x + 'px', \r\n\t\t\t'top'\t\t\t : _position.y + 'px',\r\n\t\t\t'transform' : 'rotate(' + destinationAngle + 'deg)'\r\n\t\t};\r\n\r\n\t\tlet _zIndex = (defaults.topZIndex | 0) + (i | 0);\r\n\r\n\t\tlet _callback = function(e, _last) {\r\n\r\n\t\t\te.departure\t .Redraw();\r\n\t\t\te.destination.Redraw();\r\n\r\n\t\t\tcommon.curUnLock();\r\n\r\n\t\t\tif(_last && typeof e.callback == \"function\") {\r\n\t\t\t\te.callback();\r\n\t\t\t}\r\n\r\n\t\t\tevent.dispatch('moveDragDeckDone', {\r\n\t\t\t\tdeck : e.destination\r\n\t\t\t});\r\n\t\t}.bind(null, e, i == _lastIndex);\r\n\r\n\t\telRender(e.moveDeck[i].card.domElement)\r\n\t\t\t.css({'z-index' : _zIndex})\r\n\t\t\t.animate(\r\n\t\t\t\t_params, \r\n\t\t\t\t_callback\r\n\t\t\t);\r\n\r\n\t\t// elRender(e.moveDeck[i].card.domElement)\r\n\t\t\t// .animate(_params)\r\n\r\n\t}\r\n});\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('moveDragDeckDone', (e)=>{\r\n\r\n\tif(!e.deck.fill) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet _deck = e.deck.cards;\r\n\tfor(let i in _deck) {\r\n\t\telRender(_deck[i].domElement)\r\n\t\t\t.addClass('fill')\r\n\t}\r\n});\r\n\r\n// --------------------------------------------------------------------------------------------------------\r\n\r\nevent.listen('dragDeck', (e)=>{// {x, y, _dragDeck, _startCursor, _deck}\r\n\r\n\tfor(let i in e._dragDeck) {\r\n\t\t\tlet _position = e._deck.padding(e._dragDeck[i].index);\r\n\t\t\tlet _params = {\r\n\t\t\t\t'left'    : (_position.x + (e.x - e._startCursor.x)) + 'px',\r\n\t\t\t\t'top'     : (_position.y + (e.y - e._startCursor.y)) + 'px',\r\n\t\t\t\t// transform : 'rotate(0deg)',\r\n\t\t\t\t'z-index' : defaults.topZIndex + (i | 0)\r\n\t\t\t}\r\n\t\t\t// Operations with DOM\r\n\t\t\t\telRender(e._dragDeck[i].card.domElement)\r\n\t\t\t\t\t\t.css(_params);\t \r\n\t\t}\r\n});\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/moveDragDeck.js\n **/","'use strict';\n\nimport event  from 'event';\nimport common from 'common';\nimport share  from 'share';\n\nimport elRender from 'elRender';\n\n// Move card to home\nevent.listen('moveCardToHome', function(e) {\n\n\tconsole.log('moveCardToHome');\n\n\tif(share.get('lastCursorMove').distance > 0) {\n\t\tcommon.curLock();\n\t}\n\n\t\tfor(var i in e.moveDeck) {\n\n\t\t\tvar _position = e.departure.padding(e.moveDeck[i].index);\n\t\t\tvar _params = {\n\t\t\t\tleft : _position.x + 'px',\n\t\t\t\ttop  : _position.y + 'px'\n\t\t\t}\n\n\t\t\telRender(e.moveDeck[i].card.domElement)\n\t\t\t\t.animate(\n\n\t\t\t\t\t_params, \n\n\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tcommon.curUnLock();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(e.departure) {\n\t\t\t\t\t\t\te.departure.Redraw();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.log('>>> callback', typeof e.callback);\n\t\t\t\t\t\tif(typeof e.callback == \"function\") {\n\t\t\t\t\t\t\te.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\t\n\t\t\t\t\t'moveCardToHomeAnimation'\n\t\t\t\t);\n\t\t}\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/moveCardToHome.js\n **/","'use strict';\r\n\r\nimport event    from 'event';\r\nimport defaults from 'defaults';\r\n\r\nimport Field    from 'field';\r\nimport elRender from 'elRender';\r\n\r\nevent.listen('fieldThemesSet', (pref)=>{\r\n\t\r\n\tvar _field = Field();\r\n\t\r\n\tlet fieldDomElement = _field.domElement;\r\n\r\n\r\n\tfor(var prefName in defaults.themes) {\r\n\t\t\r\n\t\t// Clear old themes\r\n\t\tfor(var i in defaults.themes[prefName]) {\r\n\t\t\tlet themeName = defaults.themes[prefName][i];\r\n\t\t\telRender(fieldDomElement).removeClass(themeName);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t// Add new themes\r\n\t\t// let className = defaults.themes[prefName][pref[prefName]];\r\n\t\tlet className = pref[prefName];\r\n\t\telRender(fieldDomElement).addClass(className);\r\n\t\t\r\n\t}\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./sources/dom/fieldThemesSet.js\n **/","'use strict';\r\n\r\nimport defaults from 'defaults';\r\n\r\nvar shuffle = function(a) {\r\n    for(var j, x, i = a.length; i; j = Math.floor(Math.random() * i), x = a[--i], a[i] = a[j], a[j] = x) {};\r\n}\r\n\r\nexport default function(a) {\r\n\r\n\tvar default_type = 'all';\r\n\r\n\tvar default_shuffle = false;\r\n\tvar max_iterations = 10;\r\n\r\n\tvar type        = a && a.type       && typeof a.type       == 'string'                                  ? a.type       : default_type;\r\n\tvar _deckCount  = a && a.deckCount  && typeof a.deckCount  == 'number'                                  ? a.deckCount  : 52;\r\n\tvar _iterations = a && a.iterations && typeof a.iterations == 'number' && a.iterations < max_iterations ? a.iterations : 1;\r\n\tvar _shuffle    = a && a.shuffle    && typeof a.shuffle    != 'undefuned'                               ? a.shuffle    : default_shuffle;\r\n\r\n\tvar genType = function(_cardsColors, _cardsRanks) {\r\n\t\tvar _deck = [];\r\n\t\tfor(var c in _cardsColors) {\r\n\t\t\tfor(var r in _cardsRanks) {\r\n\t\t\t\t_deck.push(_cardsColors[c] + _cardsRanks[r]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn _deck;\r\n\t}\r\n\t\r\n\tvar _ranks = _deckCount == 36 ? defaults.card.ranks36 : defaults.card.ranks;\r\n\tif(a && a.ranks) {\r\n\t\t_ranks = []\r\n\t\tfor(i in a.ranks) {\r\n\t\t\tif(defaults.card.rank.indexOf(a.ranks[i].toString()) >= 0) {\r\n\t\t\t\t_ranks.push(a.ranks[i].toString())\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar genTypes = {\r\n\t\tall    : function() {\r\n\t\t\treturn genType(defaults.card.suits, _ranks);\r\n\t\t},\r\n\t\tblack  : function() {\r\n\t\t\tvar _cardsSuits = defaults.card.colors.black;\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t},\r\n\t\tred    : function() {\r\n\t\t\tvar _cardsSuits = defaults.card.colors.red;\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t},\r\n\t\tblack_and_red  : function() {\r\n\t\t\tvar _cardsSuits = [\r\n\t\t\t\tdefaults.card.colors.red[(Math.random() * defaults.card.colors.red.length)|0], \r\n\t\t\t\tdefaults.card.colors.black[(Math.random() * defaults.card.colors.black.length)|0]\r\n\t\t\t];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t},\r\n\t\th_only : function() {\r\n\t\t\tvar _cardsSuits = ['h'];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t}, \r\n\t\td_only : function() {\r\n\t\t\tvar _cardsSuits = ['d'];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t}, \r\n\t\tc_only : function() {\r\n\t\t\tvar _cardsSuits = ['c'];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t},\r\n\t\ts_only : function() {\r\n\t\t\tvar _cardsSuits = ['s'];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t},\r\n\t\tone_rank_only : function() {\r\n\t\t\tvar _cardsSuits = [defaults.card.solors[(Math.random() * defaults.card.solors.length)|0]];\r\n\t\t\treturn genType(_cardsSuits, _ranks);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tgenTypes.hearts   = genTypes.h_only;\r\n\tgenTypes.diamonds = genTypes.d_only;\r\n\tgenTypes.clubs    = genTypes.c_only;\r\n\tgenTypes.spades   = genTypes.s_only;\r\n\t\r\n\tvar _deck = [];\r\n\t\r\n\tfor(;_iterations > 0;_iterations -= 1) {\r\n\t\t_deck = _deck.concat(genTypes[type]());\r\n\t}\r\n\r\n\tif(_shuffle) {\r\n\t\tshuffle(_deck);\r\n\t}\r\n\r\n\treturn _deck;\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./sources/deck/deckGenerator.js\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sources/styles/common.scss\n ** module id = 68\n ** module chunks = 0\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sources/styles/default_theme.scss\n ** module id = 69\n ** module chunks = 0\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./sources/styles/alternative_theme.scss\n ** module id = 70\n ** module chunks = 0\n **/","'use strict';\r\n\r\nimport share    from 'share';\r\nimport event    from 'event';\r\nimport common   from 'common';\r\nimport defaults from 'defaults';\r\n\r\nimport deckGenerator from 'deckGenerator';\r\nimport elRender      from 'elRender';\r\nimport mapCommon     from 'mapCommon';\r\nimport history       from 'history';\r\n\r\nimport renderTest from 'renderTest';\r\n\r\n// event.listen('addStep', (e) => {\r\n// \tconsole.log('* Добавили данные для истории:', e.move ? e.move.stepType : 'none', e);\r\n// \tif(e.move && !e.move.stepType) {\r\n// \t\tthrow new Error('debug');\r\n// \t}\r\n// });\r\n\r\n// event.listen('makeStep', (e) => {\r\n// \tconsole.log('# Отправили данные на сохранение в историю:', e);\r\n// }\r\n\r\nlet _history = [],\r\n\t_redo    = [];\r\n\r\nlet debugHistoryMgr = new function() {\r\n\t\r\n\tthis.record = function(data) {\r\n\t\t_redo = [];\r\n\t\t_history.push(data);\r\n\t}\r\n\t\r\n\tthis.undo = function() {\r\n\t\t\r\n\t\tvar _step = _history.pop();\r\n\t\tif(_step) {\r\n\t\t\t_redo.push(_step);\r\n\t\t};\r\n\t\treturn _step;\r\n\t}\r\n\t\r\n\tthis.redo = function() {\r\n\t\t\r\n\t\tvar _step = _redo.pop();\r\n\t\tif(_step) {\r\n\t\t\t_history.push(_step);\r\n\t\t};\r\n\t\treturn _step;\r\n\t}\r\n};\r\n\r\n// add buttons\r\n\r\nlet _debugHistory = false;\r\nlet debugHistory = (a)=>{\r\n\t\r\n\tif(_debugHistory) {\r\n\t\treturn;\r\n\t}\r\n\t_debugHistory = true;\r\n\t\r\n\tevent.listen('makeStep', debugHistoryMgr.record);\r\n\t\r\n\tif(a && a.drawButtons) elRender(document.body)\r\n\t\t.append(\r\n\t\t\t\telRender(\"<div>\")\r\n\t\t\t\t\t.append(\r\n\t\t\t\t\t\t$(\"<span>\")\r\n\t\t\t\t\t\t\t.addClass('awesome')\r\n\t\t\t\t\t\t\t.text('UNDO')\r\n\t\t\t\t\t\t\t.click(function() {\r\n\t\t\t\t\t\t\t\tvar _data = debugHistoryMgr.undo();\r\n\t\t\t\t\t\t\t\tif(_data) {\r\n\t\t\t\t\t\t\t\t\tSolitaireEngine.event.dispatch('undo', _data);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t.append(\r\n\t\t\t\t\t\t$(\"<span>\")\r\n\t\t\t\t\t\t\t.addClass('awesome')\r\n\t\t\t\t\t\t\t.text('REDO')\r\n\t\t\t\t\t\t\t.click(function() {\r\n\t\t\t\t\t\t\t\tvar _data = debugHistoryMgr.redo();\r\n\t\t\t\t\t\t\t\tif(_data) {\r\n\t\t\t\t\t\t\t\t\tSolitaireEngine.event.dispatch('redo', _data);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t.css({\r\n\t\t\t\t\t\tposition : 'fixed', \r\n\t\t\t\t\t\ttop      : '1px', \r\n\t\t\t\t\t\tleft     : '1px'\r\n\t\t\t\t\t})\r\n\t);\r\n\r\n};\r\n\r\nlet runTests = ()=>{\r\n\t// renderTest();\r\n}\r\n\r\nevent.listen('gameInit', (e)=>{\r\n\tif(!e.firstInit) {return;};\r\n\trunTests();\r\n})\r\n\r\nexport default {\r\n\tshare                                     ,\r\n\tdeckGenerator                             ,\r\n\tdebugHistory                              ,\r\n\tdebugHistoryMgr                           ,\r\n\tvalidateCardName : common.validateCardName,\r\n\telRender                                  ,\r\n\tdefaults                                  ,\r\n\tgroupGenerators : {\r\n\t\tmapCommon\r\n\t},\r\n\thistory\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./sources/debug/debug.js\n **/","'use strict';\r\n\r\nimport elRender from 'elRender';\r\n\r\nexport default ()=>{\r\n\r\n/*\tlog(\"-- renderTests\");\r\n// --\r\n\tlog(\"- startTest#1\");\r\n\tlet _el_1 = elRender(\"<div>\");\r\n\tlog(\r\n\t\t\"- renderTest#1-A\",\r\n\t\t_el_1\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#1-B\",\r\n\t// \t_el_1.elements[0].el.className\r\n\t// );\r\n// --\tlog(\"-- renderTests\");\r\n// --\r\n\tlog(\"- startTest#1\");\r\n\tlet _el_1 = elRender(\"<div>\");\r\n\tlog(\r\n\t\t\"- renderTest#1-A\",\r\n\t\t_el_1\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#1-B\",\r\n\t// \t_el_1.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#2\");\r\n\tlet _el_2 = elRender(\"#tbUndo\");\r\n\tlog(\r\n\t\t\"- renderTest#2-A\",\r\n\t\t_el_2\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#2-B\",\r\n\t// \t_el_2.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#3\");\r\n\tlet _el_3 = elRender(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#3 '.titleBandLink'\",\r\n\t\t_el_3\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#3-B\",\r\n\t// \t_el_3.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#4\");\r\n\tlet _el_4 = document.querySelector(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#4-A\",\r\n\t\telRender(_el_4)\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#4-B\",\r\n\t// \t_el_4.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#5\");\r\n\tlet _el_5 = document.querySelectorAll(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#5 '.titleBandLink'\",\r\n\t\t_el_5\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#5-B\",\r\n\t// \t_el_5.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#6\");\r\n\tlet _el = elRender(\"#tbUndo\");\r\n\tlet _el_6 = elRender(_el);\r\n\tlog(\r\n\t\t\"- renderTest#6-A\",\r\n\t\t_el_6\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#6-B\",\r\n\t// \t_el_6.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#7\");\r\n\tlet _elements = elRender(\".titleBandLink\");\r\n\tlet _el_7 = elRender(_elements);\r\n\tlog(\r\n\t\t\"- renderTest#7-A\",\r\n\t\t_el_7\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#7-B\",\r\n\t// \t_el_7.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#8\");\r\n\tlet _element = elRender(\"#tbUndo\");\r\n\tlet _element2 = elRender(\"#tbRedo\");\r\n\tlet _el_8 = elRender(_element)\r\n\t\t.after(_element2);\r\n\tlog(\r\n\t\t\"- renderTest#8-A\",\r\n\t\t_el_8\r\n\t);\r\n\tlog(\"- startTest#2\");\r\n\tlet _el_2 = elRender(\"#tbUndo\");\r\n\tlog(\r\n\t\t\"- renderTest#2-A\",\r\n\t\t_el_2\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#2-B\",\r\n\t// \t_el_2.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#3\");\r\n\tlet _el_3 = elRender(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#3 '.titleBandLink'\",\r\n\t\t_el_3\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#3-B\",\r\n\t// \t_el_3.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#4\");\r\n\tlet _el_4 = document.querySelector(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#4-A\",\r\n\t\telRender(_el_4)\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#4-B\",\r\n\t// \t_el_4.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#5\");\r\n\tlet _el_5 = document.querySelectorAll(\".titleBandLink\");\r\n\tlog(\r\n\t\t\"- renderTest#5 '.titleBandLink'\",\r\n\t\t_el_5\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#5-B\",\r\n\t// \t_el_5.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#6\");\r\n\tlet _el = elRender(\"#tbUndo\");\r\n\tlet _el_6 = elRender(_el);\r\n\tlog(\r\n\t\t\"- renderTest#6-A\",\r\n\t\t_el_6\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#6-B\",\r\n\t// \t_el_6.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#7\");\r\n\tlet _elements = elRender(\".titleBandLink\");\r\n\tlet _el_7 = elRender(_elements);\r\n\tlog(\r\n\t\t\"- renderTest#7-A\",\r\n\t\t_el_7\r\n\t);\r\n\t// log(\r\n\t// \t\"- renderTest#7-B\",\r\n\t// \t_el_7.elements[0].el.className\r\n\t// );\r\n// --\r\n\tlog(\"- startTest#8\");\r\n\tlet _element = elRender(\"#tbUndo\");\r\n\tlet _element2 = elRender(\"#tbRedo\");\r\n\tlet _el_8 = elRender(_element)\r\n\t\t.after(_element2);\r\n\tlog(\r\n\t\t\"- renderTest#8-A\",\r\n\t\t_el_8\r\n\t);*/\r\n}; \n\n\n/** WEBPACK FOOTER **\n ** ./sources/debug/tests/renderTest.js\n **/"],"sourceRoot":""}