var SolitaireEngine=function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),d=(n(i),a(2)),r=n(d),o=a(3),s=n(o),u=a(4),l=(n(u),a(28)),f=(n(l),a(9)),c=n(f),p=a(5),m=(n(p),a(26)),g=n(m),h=a(29),v=n(h);t.event=r["default"],t.options=s["default"],t.winCheck=g["default"].hwinCheck,t.init=function(e){var a=(0,c["default"])(e);t.Redraw=function(e){a.Redraw(e)}},v["default"]&&(t.debug=v["default"])},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={};t["default"]=new function(){this.get=function(e){return"undefined"!=typeof a[e]?a[e]:null},this.set=function(e,t){a[e]=t},this.getAll=function(){return a}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={};t["default"]=new function(){this.listen=function(e,t){"string"==typeof e&&"function"==typeof t&&(a[e]?a[e].push(t):a[e]=[t])},this.dispatch=function(e,t){if(a[e])for(var n in a[e])a[e][n](t)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={card:{width:71,height:96,suits:["h","d","c","s"],colors:{red:["h","d"],black:["c","s"]},ranks:["1","2","3","4","5","6","7","8","9","10","j","q","k"],indexes:[1,2,3,4,5,6,7,8,9,10,11,12,13],ranks36:["1","6","7","8","9","10","j","q","k"]},zoom:1,can_move_flip:!1,showSlot:!0,autohide:!1,paddingType:"none",flip_type:"none",takeRules:["onlytop"],putName:"any",tipRule:"allToAll",padding_y:0,padding_x:0,flip_padding_y:0,flip_padding_x:0,move_distance:10,Tips:null,moveDistance:0,showTips:!0,showTipsDestination:!1,showTipPriority:!1,debugLabels:!1,debugLog:!1,theme:"default_theme",animation:!0,animationTime:300,actions:{twindeck:{cardCount:3}},startZIndex:100,topZIndex:900,canMoveFlip:!1,tipsParams:{hideOnEmpty:!1,excludeHomeGroups:!0},inputParams:{doubleClick:!1}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),d=n(i),r=a(2),o=n(r),s=a(3),u=n(s),l=a(5),f=n(l),c=a(11),p=n(c),m=a(6),g=n(m),h=a(25),v=n(h);Math.sqr=function(e){return e*e},d["default"].set("dragDeck",null),d["default"].set("startCursor",null),o["default"].listen("undo",function(){d["default"].get("dragDeck")&&f["default"].getDeckById(d["default"].dragDeck[0].card.parent).Redraw(),d["default"].set("dragDeck",null),d["default"].set("startCursor",null)}),o["default"].listen("redo",function(){d["default"].get("dragDeck")&&f["default"].getDeckById(_dragDeck[0].card.parent).Redraw(),d["default"].set("dragDeck",null),d["default"].set("startCursor",null)});var k=function(e,t,a){var n=d["default"].get("startCursor"),i=d["default"].get("dragDeck");if(!f["default"].isCurLock()){try{$(".draggable").finish()}catch(r){console.warn(r)}if(!i&&!n){if(e.className.split(" ").indexOf("slot")>=0){var o=e.id,s=f["default"].getElementById(o);s.runActions()}if(e.className.split(" ").indexOf("draggable")>=0){var o=e.id,u=o?f["default"].getElementById(o):null,l=u&&u.parent?u.parent:null,s=l?p["default"].getDeckById(l):null;s.runActions();var i=s?s.Take(o):null;d["default"].set("dragDeck",i),d["default"].get("dragDeck")&&(d["default"].set("startCursor",{x:t,y:a}),g["default"].tipsDestination({currentCard:u}))}}}},y=function(e,t){var a=d["default"].get("startCursor"),n=d["default"].get("dragDeck");if(n&&a){var i=a?Math.sqrt(Math.sqr(e-a.x)+Math.sqr(t-a.y)):0,r=f["default"].getElementById(n[0].card.parent);for(var o in n){var s=r.padding(n[o].index),l={left:s.x+(e-a.x)+"px",top:s.y+(t-a.y)+"px","z-index":u["default"].topZIndex+(0|o)};for(var c in l)n[o].card.domElement[0].style[c]=l[c]}var p={distance:i,direction:{x:e-a.x,y:t-a.y,right:e>a.x,left:e<a.x,down:t>a.y,up:t<a.y},lastPosition:{x:e,y:t},deckPosition:{x:s.x+(e-a.x),y:s.y+(t-a.y)}};g["default"].tipsMove({moveDeck:n,cursorMove:p})}},_=function(e,t,a,n){var i=d["default"].get("startCursor"),r=d["default"].get("dragDeck");if(r&&i){var o=f["default"].getElementById(r[0].card.parent),s=o.padding(r[0].index),u={distance:Math.sqrt(Math.sqr(t-i.x)+Math.sqr(a-i.y)),dbclick:n,direction:{x:t-i.x,y:a-i.y,right:t>i.x,left:t<i.x,down:a>i.y,up:a<i.y},lastPosition:{x:t,y:a},deckPosition:{x:s.x+(t-i.x),y:s.y+(a-i.y)}};e.style.display="none";var l=document.elementFromPoint(t,a);e.style.display="block",(0,v["default"])(r,l,u),d["default"].set("dragDeck",null),d["default"].set("startCursor",null)}};document.onmousedown=function(e){0==e.button&&k(e.target,e.clientX,e.clientY)},document.onmousemove=function(e){y(e.clientX,e.clientY)},document.onmouseup=function(e){_(e.target,e.clientX,e.clientY)},document.ondblclick=function(e){k(e.target,e.clientX,e.clientY),_(e.target,e.clientX,e.clientY,!0)},document.addEventListener("touchstart",function(e){k(e.target,e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchmove",function(e){d["default"].startCursor&&e.preventDefault(),y(e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchend",function(e){_(e.changedTouches[0].target,e.changedTouches[0].clientX,e.changedTouches[0].clientY)},!1)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),d=n(i),r=a(2),o=n(r),s=a(3),u=n(s),l=a(6),f=(n(l),!1),c=function(){return f},p=function(){f=!0};o["default"].listen("lock",p);var m=function(){p=!1};o["default"].listen("unlock",m);var g=!1,h=function(){return g},v=function(){d["default"].curLockState=!0},k=function(){d["default"].curLockState=!1},y=function(){return d["default"].get("elements")},_=function(e){var t=d["default"].get("elements");return t[e]},x=function(e,t){var a=[],n=d["default"].get("elements");for(var i in n)n[i].name&&"string"==typeof n[i].name&&n[i].name==e&&(t&&"string"==typeof n[i].type&&t&&n[i].type==t?a.push(n[i]):a.push(n[i]));return a},w=function(e,t){if("string"!=typeof e)return console.warn("Warning: validate name must have string type",e),!1;var a=e.slice(0,1),n=e.slice(1,3),i=null;for(var d in u["default"].card.colors)u["default"].card.colors[d].indexOf(a)>=0&&(i=d);return u["default"].card.suits.indexOf(a)>=0&&u["default"].card.ranks.indexOf(n)>=0?{suit:a,rank:n,color:i}:(console.warn("Warning: validate name:",e,"- incorrect"),!1)},b=0,P=function(){return b++};d["default"].set("animation",u["default"].animation);var D=function(){d["default"].set("animation",!0)},C=function(){d["default"].set("animation",!1)};o["default"].listen("newGame",function(e){C()}),o["default"].listen("makeStep",function(e){d["default"].set("animation",u["default"].animation)}),t["default"]={isLock:c,lock:p,unlock:m,isCurLock:h,curLock:v,curUnLock:k,getElements:y,getElementById:_,getElementsByName:x,validateCardName:w,genId:P,animationOn:D,animationOff:C}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(1),o=n(r),s=a(3),u=n(s),l=a(5),f=(n(l),a(7)),c=n(f),p=a(8),m=n(p),g=a(11),h=n(g),v=a(9),k=n(v),y=u["default"].showTips,_=["tip","tipTo","tipPriority","tipToHome"],x=[],w=function(){return x},b=function(){d["default"].dispatch("hideTips");var e=h["default"].getDecks({visible:!0}),t=o["default"].get("autoTips"),a=c["default"][t];if("function"==typeof a)x=a({decks:e});else for(r in o["default"].autoTips)"function"==typeof o["default"].autoTips[r]?x=x.concat(autoTips[r]({decks:e})):c["default"][r]&&(x=x.concat(c["default"][r]({decks:e,rules:o["default"].autoTips[r]})));if(y){var n=(0,k["default"])(),i=n.homeGroups;for(var r in x)0==x[r].to.count&&n.tipsParams.hideOnEmpty||n.tipsParams.excludeHomeGroups&&i&&i.length&&i.indexOf(x[r].from.deck.parent)>=0||d["default"].dispatch("showTip",{el:x[r].from.card,type:"tip"}),i.indexOf(x[r].to.deck.parent)>=0&&d["default"].dispatch("showTip",{el:x[r].from.card,type:"tipToHome"})}};d["default"].listen("makeStep",b);var P=function(e){y=!0,e&&e.init||b()};d["default"].listen("tipsON",P);var D=function(e){y=!1,e&&e.init||b()};d["default"].listen("tipsOFF",D);var C=function(e){if(o["default"].showTipPriority&&(d["default"].dispatch("hideTips",{types:["tipPriority"]}),o["default"].showTipPriority&&e&&e.moveDeck&&e.cursorMove&&e.cursorMove.distance&&e.cursorMove.distance>=o["default"].moveDistance)){var t=(0,m["default"])(e.moveDeck,e.cursorMove);t&&d["default"].dispatch("showTip",{el:t.to.deck,type:"tipPriority"})}},I=function(e){if(o["default"].get("showTipsDestination")&&(d["default"].dispatch("hideTips"),e&&e.currentCard&&e.currentCard.id))for(var t in x)x[t].from.card.id==e.currentCard.id&&d["default"].dispatch("showTip",{el:x[t].to.deck,type:"tipTo"})};t["default"]={tipTypes:_,getTips:w,checkTips:b,showTips:P,hideTips:D,tipsMove:C,tipsDestination:I}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={allToAll:function(e){var t=function(t,a,i,d){for(var r in e.decks)if(i!=r){var o=e.decks[r].Put(a);if(o){var s=e.decks[r].cards,u=s.length?s[s.length-1]:null;n.push({from:{deck:e.decks[i],card:t[d],count:t.length},to:{deck:e.decks[r],lastCard:u,count:s.length}})}}},a=function(a){for(var n in a){var d=a[n].id,r=e.decks[i].Take(d);r&&t(a,r,i,n)}},n=[];for(var i in e.decks){var d=e.decks[i].cards;a(d)}return n}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var a=[],n=u["default"].getTips();for(p in n)n[p].from.card.id==e[0].card.id&&a.push(n[p]);if(0==a.length)return!1;var i=-1,r=0,s=0,l=(0,f["default"])(),c=l.homeGroups;if(c){var n=[];for(var p in c)for(var m in a)a[m].to.deck.parent==c[p]&&n.push(a[m]);n.length&&(a=n)}if(a.length>=2){for(var p in a){var g={x:t.deckPosition.x+o["default"].card.width*d["default"].get("zoom"),y:t.deckPosition.y+o["default"].card.height*d["default"].get("zoom")},h=a[p].to.deck.padding(a[p].to.deck.cards.length),v={x:h.x+o["default"].card.width*d["default"].get("zoom"),y:h.y+o["default"].card.height*d["default"].get("zoom")};a[p].distance=Math.sqrt(Math.sqr(g.x-v.x)+Math.sqr(g.y-v.y)),a[p].inDirection=!1,(t.direction.x>0&&v.x>g.x||t.direction.x<0&&v.x<g.x)&&(a[p].inDirection=!0,s+=1)}for(var p in a)"-1"==i&&(0==s?i=a[p].distance:a[p].inDirection&&(i=a[p].distance,r=p)),a[p].distance<i&&(0==s?(i=a[p].distance,r=p):a[p].inDirection&&(i=a[p].distance,r=p))}return a[r]};var i=a(1),d=n(i),r=a(3),o=n(r),s=a(6),u=n(s),l=a(9),f=n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),d=n(i),r=a(2),o=n(r),s=a(3),u=n(s),l=a(5),f=n(l),c=a(10),p=n(c),m=a(11),g=n(m),h=a(6),v=n(h),k=a(7),y=n(k),_=null,x=function(e){if(!e)return!1;f["default"].unlock(),e&&_?_.clear():d["default"].set("elements",{});var t=null;try{t=Object.assign?Object.assign({},e):JSON.parse(JSON.stringify(e))}catch(a){t=e,console.warn("Field input params is not JSON, maybe the rules are wrong.")}this.homeGroups=t.homeGroups?t.homeGroups:[],d["default"].set("debugLog",t.debugLog&&"boolean"==typeof t.debugLog?t.debugLog:u["default"].debugLog),"boolean"==typeof t.showTips&&t.showTips?v["default"].showTips({init:!0}):v["default"].hideTips({init:!0}),d["default"].set("showTipsDestination","boolean"==typeof t.showTipsDestination?t.showTipsDestination:u["default"].showTipsDestination),d["default"].set("showTipPriority","boolean"==typeof t.showTipPriority?t.showTipPriority:u["default"].showTipPriority);var n=t.autoTips&&"string"==typeof t.autoTips&&y["default"][t.autoTips]?t.autoTips:u["default"].tipRule;d["default"].set("autoTips",n),"#god"==document.location.hash&&(document.body.innerHTML="<h1>=)</h1>"),d["default"].set("moveDistance",t.moveDistance&&"number"==typeof t.moveDistance?t.moveDistance:u["default"].moveDistance),d["default"].set("winCheck",t.winCheck),t.winCheck&&t.winCheck.callback&&"function"==typeof t.winCheck.callback&&(winCheckCallback=t.winCheck.callback),t.saveStep&&"function"==typeof t.saveStep&&(saveStepCallback=t.saveStep),d["default"].set("zoom",t.zoom&&"number"==typeof t.zoom?t.zoom:u["default"].zoom),this.tipsParams={};for(var i in u["default"].tipsParams)this.tipsParams[i]=t.tipsParams&&"undefined"!=typeof t.tipsParams[i]?t.tipsParams[i]:u["default"].tipsParams[i];this.inputParams={};for(var r in u["default"].inputParams)this.inputParams[r]=t.inputParams&&"undefined"!=typeof t.inputParams[r]?t.inputParams[r]:u["default"].inputParams[r];var s=t.can_move_flip&&"boolean"==typeof t.can_move_flip?t.can_move_flip:u["default"].canMoveFlip;if(d["default"].set("can_move_flip",s),d["default"].set("debugLabels",t.debugLabels&&"boolean"==typeof t.debugLabels?t.debugLabels:u["default"].debugLabels),this.Draw=function(){if(t){if(t.groups)for(var e in t.groups)t.groups[e].name=e,p["default"].addGroup(t.groups[e]);if(t.decks)for(var a in t.decks)g["default"].addDeck(t.decks[a]);v["default"].checkTips(),o["default"].dispatch("newGame"),f["default"].unlock()}},t.startZIndex&&"number"==typeof t.startZIndex&&d["default"].set("start_z_index",t.startZIndex),t.fill)for(var l in t.fill){var c=this.getElementsByName(l);for(var m in c)["deck","group"].indexOf(c[m].type)&&"string"!=typeof t.fill[l]&&c[m].Fill(t.fill[l])}};x.prototype.clear=function(){var e=d["default"].get("elements");for(var t in e)"deck"==e[t].type?(e[t].clear(),e[t]=null):"group"==e[t].type&&(e[t]=null);d["default"].set("elements",{})},x.prototype.Redraw=function(e){console.log("redraw field",e);var t=null;try{t=Object.assign?Object.assign({},e):JSON.parse(JSON.stringify(e))}catch(a){t=e,console.warn("Field.Redraw input params is not JSON, can't clone")}for(var n in t.groups){var i=p["default"].Group(n);i&&i.Redraw(t.groups[n])}for(var d in t.decks){var r=g["default"].Deck(t.decks[d].name);r&&r.Redraw(t.decks[d])}};var w=function(e){return e&&_&&(_.clear(),_.Draw(e)),e&&!_&&(_=new x(e),o["default"].dispatch("initField",{a:e}),_.Draw()),_};t["default"]=w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=(n(i),a(1)),r=n(d),o=a(3),s=n(o),u=a(5),l=n(u),f=a(11),c=n(f),p=a(23),m=n(p),g=a(24),h=n(g),v=function(e,t){this.type="group";var a=t;this.getId=function(){return a},this.name=e.name&&"string"==typeof e.name?e.name:"name_"+a,this.position={x:e.position&&e.position.x&&"number"==typeof e.position.x?e.position.x:0,y:e.position&&e.position.y&&"number"==typeof e.position.y?e.position.y:0},this.placement=e.placement?{x:e.placement.x?e.placement.x:0,y:e.placement.y?e.placement.y:0}:null,this.decks={},this.parameters={paddingType:e.paddingType?e.paddingType:s["default"].paddingType,flip:e.flip?e.flip:null,take:e.take?e.take:null,showSlot:e.showSlot?e.showSlot:s["default"].showSlot,takeRules:e.takeRules?e.takeRules:s["default"].takeRules,putRules:e.putRules?e.putRules:s["default"].putRules,fillRule:e.fillRule?e.fillRule:s["default"].fillRule,autoHide:e.autoHide?e.autoHide:s["default"].autoHide,paddingX:e.paddingX?e.paddingX:s["default"].paddingX,paddingY:e.paddingY?e.paddingY:s["default"].paddingY,flipPaddingX:e.flipPaddingX?e.flipPaddingX:s["default"].flipPaddingX,flipPaddingY:e.flipPaddingY?e.flipPaddingY:s["default"].flipPaddingY},this.deckIndex=[]};v.prototype.addDeck=function(e){if(e){e.position||(e.position={x:0,y:0}),e.parent||(e.parent=this.name),e.parentPosition={x:this.position.x,y:this.position.y};var t=0;if(e.groupIndex&&"number"==typeof e.groupIndex&&this.deckIndex[e.groupIndex-1]&&decks[this.deckIndex[e.groupIndex-1]]["this"].deckIndex==e["this"].deckIndex&&(console.warn("Warning: duplicate groupIndex",e.groupIndex,"changed to null"),e.groupIndex=null),e.groupIndex&&"number"==typeof e.groupIndex)if(this.deckIndex[e.groupIndex-1]){for(;"undefined"!=typeof this.deckIndex[t];t+=1);if(placement){var t=this.deckIndex[e.groupIndex-1],a=r["default"].get("elements");placement.x&&a[t].x(this.position.x+(placement.x+s["default"].card.width)*t),placement.y&&a[t].y(this.position.y+(placement.y+s["default"].card.width)*t),r["default"].set("elements",a)}this.deckIndex[t]=this.deckIndex[e.groupIndex-1],this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1}else this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1;else{for(;"undefined"!=typeof this.deckIndex[t];t+=1);this.deckIndex[t]=!0}this.placement&&(this.placement.x&&(e.position.x=(this.placement.x+s["default"].card.width)*t),this.placement.y&&(e.position.y=(this.placement.y+s["default"].card.height)*t)),this.parameters.paddingType&&"undefined"==typeof e.paddingType&&(e.paddingType=this.parameters.paddingType),this.parameters.flip&&"undefined"==typeof e.flip&&(e.flip=this.parameters.flip),this.parameters.take&&"undefined"==typeof e.take&&(e.take=this.parameters.take),this.parameters.showSlot&&"undefined"==typeof e.showSlot&&(e.showSlot=this.parameters.showSlot),this.parameters.takeRules&&"undefined"==typeof e.takeRules&&(e.takeRules=this.parameters.takeRules),this.parameters.putRules&&"undefined"==typeof e.putRules&&(e.putRules=this.parameters.putRules),this.parameters.fillRule&&"undefined"==typeof e.fillRule&&(e.fillRule=this.parameters.fillRule),this.parameters.autoHide&&"undefined"==typeof e.autoHide&&(e.autoHide=this.parameters.autoHide),this.parameters.paddingX&&"undefined"==typeof e.paddingX&&(e.paddingX=this.parameters.paddingX),this.parameters.paddingY&&"undefined"==typeof e.paddingY&&(e.paddingY=this.parameters.paddingY),this.parameters.flipPaddingX&&"undefined"==typeof e.flipPaddingX&&(e.flipPaddingX=this.parameters.flipPaddingX),this.parameters.flipPaddingY&&"undefined"==typeof e.flipPaddingY&&(e.flipPaddingY=this.parameters.flipPaddingY);var n=c["default"].addDeck(e);this.deckIndex[t]=n.getId(),this.decks[n.getId()]=n}},v.prototype.Fill=function(e){m["default"].call(this,e)},v.prototype.getDeckById=function(e){return this.decks[e]},v.prototype.getDecksByName=function(e){var t={};for(var a in this.decks)this.decks[a].name==e&&(t[a]=decks[a]);return t},v.prototype.getDecks=function(e){var t=[];for(var a in this.decks)e&&e.visible?this.decks[a].visible&&t.push(this.decks[a]):t.push(this.decks[a]);return t},v.prototype.Redraw=function(e){h["default"].call(this,e)};var k=function(e){if(!e)return!1;var t="group_"+l["default"].genId(),a=new v(e,t);if(e.decks){if("number"==typeof e.decks){var n=e.decks;e.decks=[];for(var i=0;n>i;i+=1)e.decks.push({name:a.name+"_deck"+(i+1)})}for(var d in e.decks)a.addDeck(e.decks[d])}var o=r["default"].get("elements");if(o[t]=a,r["default"].set("elements",o),e&&e.fill){var s=e.fill.length;s&&a.Fill(e.fill)}return a},y=function(e){return l["default"].getElementsByName(e,"group")[0]};t["default"]={addGroup:k,Group:y}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(1),o=n(r),s=a(3),u=n(s),l=a(5),f=n(l),c=a(12),p=n(c),m=a(13),g=n(m),h=a(14),v=(n(h),a(15)),k=n(v),y=a(16),_=n(y),x=a(17),w=n(x),b=a(20),P=n(b),D=a(21),C=n(D),I=a(22),T=n(I),M=a(10),O=n(M),R=a(18),E=n(R),N=function(e,t){if(!e)return!1;this.cards=[],this.getTopCard=function(){return this.cards[this.cards.length-1]},this.type="deck",this.fill=!1;var a=t;this.getId=function(){return a};var n=O["default"].Group(e.parent),i=n?n.name:"xname",r=n?n.getDecks().length:a;this.name=e.name&&"string"==typeof e.name?e.name:i+"_"+r,this.visible=e.visible&&"boolean"==typeof e.visible?e.visible:!0,this.groupIndex=e.groupIndex&&"number"==typeof e.groupIndex?e.groupIndex:null,this.parent=e.parent&&"string"==typeof e.parent?e.parent:"field",this.autoHide=e.autoHide&&"boolean"==typeof e.autoHide?e.autoHide:u["default"].autohide;var o={};o.startZIndex=e.startZIndex&&"number"==typeof e.startZIndex?e.startZIndex:u["default"].start_z_index,"undefined"==typeof e.showSlot&&(e.showSlot=u["default"].showSlot),o.x=0,o.y=0,o.rotate=this.rotate=0,o.padding_y=e.paddingY&&"number"==typeof e.paddingY?e.paddingY:u["default"].padding_y,o.flip_padding_y=e.flipPaddingY&&"number"==typeof e.flipPaddingY?e.flipPaddingY:u["default"].flip_padding_y,o.padding_x=e.paddingX&&"number"==typeof e.paddingX?e.paddingX:u["default"].padding_x,o.flip_padding_x=e.flipPaddingX&&"number"==typeof e.flipPaddingX?e.flipPaddingX:u["default"].flip_padding_x;var s=e.flip&&"string"==typeof e.flip?e.flip:u["default"].flip_type,l=p["default"][s];this.flipCheck=function(){for(var e in this.cards)l(this.cards[e],0|e,this.cards.length)},this.putRules=e.putRules?"function"==typeof e.putRules?e.putRules:"string"==typeof e.putRules?g["default"][e.putRules]?g["default"][e.putRules]:g["default"][u["default"].putName]:e.putRules.constructor==Array?e.putRules:g["default"][u["default"].putName]:g["default"][u["default"].putName],this.takeRules=e.takeRules;var f=e.fillRule&&"string"==typeof e.fillRule&&"function"==typeof k["default"][e.fillRule]?k["default"][e.fillRule]:k["default"].not;console.log("PADDING",this.name,e.paddingType,e.paddingX,e.paddingY);var c=e.paddingX||e.paddingY?_["default"].special:e.paddingType?"string"==typeof e.paddingType&&_["default"][e.paddingType]?_["default"][e.paddingType]:_["default"].none:_["default"][u["default"].paddingType];this.padding=function(e){var t=c(o,this.cards[e],e,this.cards.length,this.cards);return t},this.actions=[],e.actions&&(this.actions=e.actions),this.runActions=function(){w["default"].runActions.call(this)},d["default"].dispatch("addDeckEl",{a:e,deck:this,params:o}),d["default"].listen("moveDragDeck",function(e){if(e.destination.name==this.deck.name){var t=e.destination;t&&!this.fill&&this.callback({deck:t})&&(this.deck.fill=!0,E["default"].add({fill:{deck:this.deck.name}}))}}.bind({deck:this,callback:f})),this.Redraw=function(e){d["default"].dispatch("redrawDeck",{deck:this,a:e,params:o,cards:this.cards})}};N.prototype.Fill=function(e){for(var t in e)this.genCardByName(e[t])},N.prototype.clear=function(){for(var e in this.cards)d["default"].dispatch("removeEl",this.cards[e]),this.cards[e]=null;this.cards=[],d["default"].dispatch("removeEl",this)},N.prototype.Push=function(e){for(var t in e)e[t].parent=this.getId(),this.cards.push(e[t])},N.prototype.Pop=function(e,t){if(this.cards.length<e)return!1;for(var a=[];e;e-=1){var n=this.cards.pop();t&&(n.parent=null),a.push(n),a[a.length-1].parent=null}return a.reverse(),this.autoHide&&0==this.cards.length&&this.hide(),this.Redraw(),a},N.prototype.Take=function(e){return P["default"].call(this,e)},N.prototype.Put=function(e){return C["default"].call(this,e)},N.prototype.genCardByName=function(e){return T["default"].call(this,e)},N.prototype.hide=function(){this.visible=!1,E["default"].add({hideDeck:this.name}),this.Redraw()},N.prototype.show=function(){this.visible=!1,E["default"].add({showDeck:this.name}),this.Redraw()},N.prototype.getCardsByName=function(e){var t=[];for(var a in this.cards)this.cards[a].name==e&&t.push(this.cards[a]);return t},N.prototype.Card=function(e){return this.getCardsByName(e)[0]},N.prototype.hideCards=function(){for(var e in this.cards)this.cards[e].visible=!1,d["default"].dispatch("hideCard",this.cards[e])},N.prototype.showCards=function(){for(var e in this.cards)this.cards[e].visible=!0,d["default"].dispatch("showCard",this.cards[e])};var Y=function(e){if(!e)return!1;var t="deck_"+f["default"].genId(),a=Object.assign?Object.assign({},e):JSON.parse(JSON.stringify(e)),n=new N(a,t);if(e.fill)for(var i in e.fill)"string"==typeof e.fill[i]&&n.genCardByName(e.fill[i]);var d=o["default"].get("elements");return d[t]=n,o["default"].set("elements",d),n},X=function(e,t){var a=f["default"].getElementsByName(e,"deck");if(t&&"string"==typeof t){for(var n in a){var i=f["default"].getElementById(_gecks[n].parent());if(i&&i.name&&i.name==t)return a[n]}return!1}return a[0]},S=function(e){var t={},a=o["default"].get("elements");for(var n in a)"deck"==a[n].type&&(e&&e.visible?a[n].visible&&(t[n]=a[n]):t[n]=a[n]);return t},A=function(e){var t=o["default"].get("elements");for(var a in t)if("deck"==t[a].type&&a==e)return t[a];return null},j=function(e){var t=[];for(var a in e)e[a].card&&e[a].card.name?t.push(e[a].card.name):e[a].name&&t.push(e[a].name);return t};t["default"]={addDeck:Y,Deck:X,getDecks:S,getDeckById:A,deckCardNames:j}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={none:function(e,t,a){e.flip=!1},all:function(e,t,a){e.flip=!0},notlast:function(e,t,a){e.flip=a-1>t},first_1:function(e,t,a){e.flip=1>t},first_2:function(e,t,a){e.flip=2>t},first_3:function(e,t,a){e.flip=3>t}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),d=n(i),r=a(3),o=n(r),s={_downupcards:function(e){if(0==e.cards.length)return!1;var t=d["default"].validateCardName(e.cards[e.cards.length-1].name),a=d["default"].validateCardName(e.putDeck[0].card.name);return t&&a?{up:a,down:t}:!1},_downupranknum:function(e){var t=s._downupcards(e);return t?{down:o["default"].card.ranks.indexOf(t.down.rank),up:o["default"].card.ranks.indexOf(t.up.rank)}:!1},_isFirst:function(e,t){if(0==e.cards.length){var a=null;return(a=d["default"].validateCardName(e.putDeck[0].card.name))&&a.rank==t}return!0},striped:function(e){if(0==e.cards.length)return!0;var t=d["default"].validateCardName(e.cards[e.cards.length-1].name).color,a=null,n=null;return(n=d["default"].validateCardName(e.putDeck[0].card.name))&&(a=n.color),t!=a},firstAce:function(e){return s._isFirst(e,"1")},firstKing:function(e){return s._isFirst(e,"k")},notForEmpty:function(e){return e.cards.length},oneRank:function(e){if(0==e.cards.length)return!0;var t=s._downupcards(e);return t&&t.up.rank==t.down.rank},oneSuit:function(e){if(0==e.cards.length)return!0;var t=s._downupcards(e);return t&&t.up.suit==t.down.suit},any:function(e){return!0},not:function(e){return!1},ascendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=o["default"].card.ranks.indexOf(d["default"].validateCardName(e.putDeck[a-1].card.name).rank),i=o["default"].card.ranks.indexOf(d["default"].validateCardName(e.putDeck[a].card.name).rank);t=t&&1+n==i}return t},descendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=o["default"].card.ranks.indexOf(d["default"].validateCardName(e.putDeck[a-1].card.name).rank),i=o["default"].card.ranks.indexOf(d["default"].validateCardName(e.putDeck[a].card.name).rank);t=t&&n==1+i}return t},oneRankDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=d["default"].validateCardName(e.putDeck[a-1].card.name).suit,i=d["default"].validateCardName(e.putDeck[a].card.name).suit;t=t&&n==i}return t},ascend:function(e){if(0==e.cards.length)return!0;var t=s._downupranknum(e);return t&&t.down<t.up},descent:function(e){if(0==e.cards.length)return!0;var t=s._downupranknum(e);return t&&t.down>t.up},descentOne:function(e){if(0==e.cards.length)return!0;var t=s._downupranknum(e);return t&&t.down==1+t.up},ascendOne:function(e){if(0==e.cards.length)return!0;var t=s._downupranknum(e);return t&&1+t.down==t.up},ascdescOne:function(e){if(0==e.cards.length)return!0;var t=s._downupranknum(e);return t&&1==Math.abs(t.down-t.up)}};t["default"]=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={not:function(e){return!1},notFirst:function(e){return e.cardIndex>0},any:function(e){return!0},onlytop:function(e){return e.cardIndex==e.deckLength-1},ask:function(e){return console.log(e),!0},desc:function(e){return console.log(e),!0}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3),d=n(i);t["default"]={deckLength:function(e){return d["default"].card.ranks.length<=e.deck.cards.length},not:function(){return!1}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={none:function(e,t,a,n,i){return console.log("NO PADDING"),{x:e.x,y:e.y}},last_three_min:function(e,t,a,n,i){return a>n-3?n>3?{x:e.x-2*(n-3-a),y:e.y-(n-3-a)}:{x:e.x+2*a,y:e.y+(0|a)}:{x:x,y:y}},twindeck_typeA:function(e,t,a,n,i){var d=24,r=3,o={x:2,y:1},s=n/d*r|0;s>=r&&(s=r-1);var u=a-(n-s-1);return 0>u&&(u=0),{x:e.x+o.x*u,y:e.y+o.y*u}},radial:function(e,t,a,n,i){var d=1,r=a*d,o=e.rotate,s=Math.PI/180,u=Math.sin(o*s)*r,l=Math.cos(o*s)*r;return{x:e.x+u,y:e.y-l}},special:function(e,t,a,n,i){var d=e.y,r=e.x;console.log("SPECIAL",d,r,e.padding_x,e.padding_y);for(var o=0;a>o;o+=1)d+=i[o]&&i[o].flip?e.flip_padding_y:e.padding_y,r+=i[o]&&i[o].flip?e.flip_padding_x:e.padding_x;return{x:r,y:d}},vertical:function(e,t,a,n,i){for(var d=e.y,r=0;a>r;r+=1)d+=i[r]&&i[r].flip?e.flip_padding_y:e.padding_y;var o={x:e.x,y:d};return o},horizontal:function(e,t,a,n,i){for(var d=e.x,r=0;a>r;r+=1)d+=i[r]&&i[r].flip?e.flip_padding_x:e.padding_x;var o={x:d,y:e.y};return o}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(3),o=n(r),s=a(11),u=n(s),l=a(10),f=n(l),c=a(18),p=n(c),m=a(19),g=n(m),h={twindeck:function(e){if(0!=e.deck_from.iteration){var t=u["default"].Deck(e.data.to),a=e.data.count&&"number"==typeof e.data.count?e.data.count:o["default"].actions.twindeck.CardsCount,n=e.deck_from.cards.length;a>n&&(a=n),"undefined"==typeof e.deck_from.iteration&&(e.deck_from.iteration=-1,e.deck_from.twindeck=[]),e.iterations&&e.deck_from.iteration<0&&(e.deck_from.iteration=e.iterations),t.hideCards();var i=t.Pop(t.cards.length);i.reverse();for(var r in i)e.deck_from.twindeck.unshift(i[r]);if(e.deck_from.twindeck&&e.deck_from.twindeck.length&&0==n&&0!=e.deck_from.iteration)e.deck_from.Push(e.deck_from.twindeck),e.deck_from.twindeck=[];else{var i=e.deck_from.Pop(a);t.Push(i)}e.deck_from.showCards(),e.deck_from.flipCheck(),t.flipCheck(),e.deck_from.Redraw(),t.Redraw();var s={from:e.deck_from.name,to:t.name,moveCards:share.deckCardNames(i),iteration:0|e.deck_from.iteration};p["default"].add(s),d["default"].dispatch("makeStep",p["default"].get()),e.deck_from.iteration-=1}},twindeck2:function(e){},dealerdeck:function(e){var t=f["default"].Group(e.toGroup).decks;if(0!=this.cards.length){for(var a in t){var n=this.getTopCard().name;(0,g["default"])({from:this.name,to:t[a].name,deck:[n],flip:!0},!0),p["default"].add({move:{from:this.name,to:t[a].name,deck:[n],flip:!0}})}d["default"].dispatch("makeStep",p["default"].get())}}},v=function(e){for(var t in this.actions)h[t]&&(console.log("run action",this,t,this.actions[t]),h[t].call(this,this.actions[t]))};t["default"]={runActions:v}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(1),o=(n(r),a(19)),s=n(o),u=a(11),l=(n(u),a(6)),f=n(l),c=[],p={},m={},g=function(e){console.log("#undo",e);for(var t in p)p[t](e);"undefined"!=typeof e.move&&"undefined"!=typeof e.move.from&&"undefined"!=typeof e.move.to&&"undefined"!=typeof e.move.deck&&(0,s["default"])({from:e.move.to,to:e.move.from,deck:e.move.deck,flip:e.move.flip})};d["default"].listen("undo",function(e){if(console.log("undo",e),e){if(e instanceof Array)for(var t in e){var a=e[t];g(a)}else g(e);f["default"].checkTips()}});var h=function(e){for(var t in m)m[t](e);"undefined"!=typeof e.move&&"undefined"!=typeof e.move.from&&"undefined"!=typeof e.move.to&&"undefined"!=typeof e.move.deck&&(0,s["default"])(e.move)};d["default"].listen("redo",function(e){if(e){if(e instanceof Array){e.reverse();for(var t in e){var a=e[t];h(a)}}else h(e);f["default"].checkTips()}}),t["default"]=new function(){this.reset=function(){c=[]},this.add=function(e){c.push(e)},this.get=function(){var e=c;return this.reset(),e},this.addUndoMethods=function(e){for(var t in e)p[t]=e[t]},this.addRedoMethods=function(e){for(var t in e)m[t]=e[t]}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{
value:!0}),t["default"]=function(e){var t=o["default"].get("animation");if(e.from&&e.to&&e.deck&&"string"==typeof e.from&&"string"==typeof e.to&&e.deck.length){var a=u["default"].Deck(e.from),n=u["default"].Deck(e.to);if(a&&n){var i=!0,r=a.cards;for(var s in r)if(s>=r.length-e.deck.length){var l=s-(0|r.length)+(0|e.deck.length);e.deck[l]&&r[s].name!=e.deck[l]&&(i=!1)}if(i){var f=a.Pop(e.deck.length);if(e.flip)for(var s in f)f[s].flip=!f[s].flip;if(n.Push(f),t){console.log("ANIMATE",f);var c=[];for(var s in f)c.push({card:f[s]});console.log(c),d["default"].dispatch("moveDragDeck",{departure:a,destination:n,moveDeck:c})}else a.Redraw(),n.Redraw()}else _warn(4)}}};var i=a(2),d=n(i),r=a(1),o=n(r),s=a(11),u=n(s),l=a(6);n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=!0;//!common.isLock();
"boolean"==typeof this.fill&&(t=t&&!this.fill);var a=-1,n=null,i=null,d=null,o=this.cards.length,u=[];for(var f in this.cards){if(this.cards[f].id==e){a=0|f,n=this.cards[f].name;var c=s["default"].validateCardName(n);t=t&&c,c&&(i=c.suit,d=c.rank),t=t&&(!this.cards[f].flip||this.cards[f].flip==r["default"].canMoveFlip)}a>=0&&u.push({index:f,card:this.cards[f]})}var p={cardId:e,cardName:n,cardSuit:i,cardRank:d,cardIndex:a,deckLength:o};for(var m in this.takeRules){var g=this.takeRules[m];l["default"][g]?t=t&&l["default"][g](p):(console.log("Incorrect take rule:",g),t=!1)}return t=t&&a>=0,t&&u};var i=a(1),d=(n(i),a(3)),r=n(d),o=a(5),s=n(o),u=a(14),l=n(u)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=!0,a=e[0].card.parent,n=d["default"].getDeckById(a);for(var i in this.putRules){var r=this.putRules[i];o["default"][r]?t=t&&o["default"][r]({from:{deckId:a,deck:n},putDeck:e,cards:this.cards,rulesArgs:o["default"][r]}):(console.warn("putRule:",r,"not exists"),t=!1)}return t};var i=a(11),d=n(i),r=a(13),o=n(r)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=u["default"].validateCardName(e);if(t){var a="card_"+u["default"].genId(),n={id:a,name:e,type:"card",visible:!0,flip:!1};n.parent=this.getId(),d["default"].dispatch("addCardEl",n);var i=o["default"].get("elements");return i[a]=n,o["default"].set("elements",i),this.Push([n]),this.flipCheck(),this.Redraw(),n}return!1};var i=a(2),d=n(i),r=a(1),o=n(r),s=a(5),u=n(s)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=[],a=0;for(var n in this.decks)a+=1,t.push(null);for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex<=a&&(t[this.decks[n].groupIndex-1]=!0);for(var n in this.decks)if(!this.decks[n].groupIndex){for(var i=0;null!=t[i];i+=1);t[i]=this.decks[n].getId()}for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex<=a&&(t[this.decks[n].groupIndex-1]=this.decks[n].getId());var d={};for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex>a&&(d[this.decks[n].groupIndex-1]=this.decks[n].getId());for(var n in d){for(var i=0;null!=t[i];i+=1);t[i]=this.decks[d[n]].getId()}var r=!0;for(var n in e)r=r&&"string"==typeof e[n];if(r)for(var n in e){var i=t[n%t.length];this.decks[i].genCardByName(e[n])}else for(var n in e)n<t.length&&this.decks[t[n]].Fill(e[n])}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=this.getDecks();"undefined"!=typeof e.decks&&"number"!=typeof e.decks||(e.decks=[]);for(var n in t){if(e.decks[n]||(e.decks[n]={}),e.position&&e.decks[n].parentPosition&&(e.decks[n].parentPosition={x:e.position.x,y:e.position.y}),e.rotate&&(e.decks[n].rotate=e.rotate),e.paddingX&&(e.decks[n].paddingX=e.paddingX),e.paddingY&&(e.decks[n].paddingY=e.paddingY),e.flipPaddingX&&(e.decks[n].flipPaddingX=e.flipPaddingX),e.flipPaddingY&&(e.decks[n].flipPaddingY=e.flipPaddingY),e.decks[n].position||(e.decks[n].position={}),e.decks[n].parentPosition||(e.decks[n].parentPosition={}),!e.decks[n].parentPosition.x&&a.position&&a.position.x&&"number"==typeof a.position.x&&(e.decks[n].parentPosition.x=e.position.x),!e.decks[n].parentPosition.y&&a.position&&a.position.y&&"number"==typeof a.position.y&&(e.decks[n].parentPosition.y=e.position.y),e.placement){var i=r["default"].card;e.placement.x&&(e.decks[n].position.x=(e.placement.x+i.width)*n),e.placement.y&&(e.decks[n].position.y=(e.placement.y+i.height)*n)}!e.decks[n].rotate&&e.rotate&&"number"==typeof e.rotate&&(e.decks[n].rotate=e.rotate),!e.decks[n].paddingX&&e.paddingX&&"number"==typeof e.paddingX&&(e.decks[n].paddingX=e.paddingX),!e.decks[n].paddingY&&e.paddingY&&"number"==typeof e.paddingY&&(e.decks[n].paddingY=e.paddingY),!e.decks[n].flipPaddingX&&e.flipPaddingX&&"number"==typeof e.flipPaddingX&&(e.decks[n].flipPaddingX=e.flipPaddingX),!e.decks[n].flipPaddingY&&e.flipPaddingY&&"number"==typeof e.flipPaddingY&&(e.decks[n].flipPaddingY=e.flipPaddingY),t[n].Redraw(e.decks[n])}};var d=n(3),r=i(d)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(1),o=n(r),s=a(5),u=n(s),l=a(11),f=n(l),c=a(6),p=n(c),m=a(8),g=n(m),h=a(18),v=n(h),k=a(26),y=n(k),_=a(9),x=n(_),w=function b(e,t,a){var n=null,i=null,r=!0;r=r&&t;var s=t&&t.id&&u["default"].getElementById(t.id);if(s&&("card"==s.type?n=u["default"].getElementById(s.parent):"deck"==s.type&&(n=s)),r=r&&n,i=e[0].card.parent&&u["default"].getElementById(e[0].card.parent),r=r&&i,n&&n.getId()!=i.getId()){var l=n.Put(e);if(r=r&&l,l&&i){var c=i.Pop(e.length);if(r=r&&c,c){n.Push(c),d["default"].dispatch("moveDragDeck",{departure:i,destination:n,moveDeck:e}),v["default"].add({move:{from:i.name,to:n.name,deck:f["default"].deckCardNames(e)}});var m=i.cards;m.length&&m[m.length-1].flip&&(m[m.length-1].flip=!1,v["default"].add({unflip:{deck:i.name,card:{name:m[m.length-1].name,index:m.length-1}}})),d["default"].dispatch("makeStep",v["default"].get()),y["default"].winCheck({show:!0})}}}else r=!1;if(!r&&i){var h=(0,x["default"])();if(h.inputParams.doubleClick&&a.dbclick||a.distance>=o["default"].get("moveDistance")){var k=(0,g["default"])(e,a);k?b(e,k.to.deck.domElement,a):d["default"].dispatch("moveCardToHome",{moveDeck:e,departure:i})}else d["default"].dispatch("moveCardToHome",{moveDeck:e,departure:i})}p["default"].checkTips()};t["default"]=w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),d=n(i),r=a(2),o=n(r),s=a(5),u=(n(s),a(27)),l=n(u),f=a(11),c=n(f),p=function(e){var t=!0,a=!1,n=d["default"].get("winCheck");for(var i in n.rules)a=!0,t=l["default"][i]?t&&l["default"][i]({decks:c["default"].getDecks({visible:!0}),rulesArgs:n.rules[i]}):t&&l["default"].newerWin();return a||(t=t&&l["default"].newerWin()),t?e&&e.noCallback?!0:(o["default"].dispatch("win",e),!0):!1},m=function(e){e||(e={}),"undefined"==typeof e.show&&(e.show=!1),p(e)};t["default"]={winCheck:p,hwinCheck:m}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),d=n(i),r=a(3),o=n(r),s={group:function(e){if(!e.filter)return!1;var t=[];for(var a in e.decks)("string"==typeof e.filterArgs&&e.decks[a].parent==e.filterArgs||e.filterArgs.indexOf(e.decks[a].parent)>=0)&&t.push(e.decks[a]);return e.decks=t,t.length},_asc_desk:function(e){if(!e||null==e.asc_desk||"number"!=typeof e.asc_desk)return!1;var t=!0;for(var a in e.decks){if(!t)return!1;var n=e.decks[a].cards;for(var i in n)if(i>0){var r=d["default"].validateCardName(n[(0|i)-1].name),s=d["default"].validateCardName(n[0|i].name),u=o["default"].card.ranks;t=t&&r&&s&&u.indexOf(r.rank)==u.indexOf(s.rank)+e.asc_desk}}return t},newerWin:function(){return console.warn("You use 'newerWin' rule for checking Win. Maybe arguments in 'winCheck.rule' have incorrect rule name."),!1},allEmpty:function(e){var t=!0;for(var a in e.decks)t=t&&0==e.decks[a].cards.length;return t},allInOne:function(e){var t=0,a=0,n=0;for(var i in e.decks)0==e.decks[i].cards.length?t+=1:n=i,a+=1;var d=t==a-1;return e.filter&&(e.decks=d?[e.decks[n]]:[]),d},allAscend:function(e){return e.asc_desk=-1,s._asc_desk(e)},allDescent:function(e){return e.asc_desk=1,s._asc_desk(e)},lego:function(e){if(!e||!e.rulesArgs)return!1;var t=!0;for(var a in e.rulesArgs){var n={};for(var i in e.decks)n[i]=e.decks[i];var d={decks:n};if(t&&e.rulesArgs[a].filters){d.filter=!0;for(var i in e.rulesArgs[a].filters)if("string"==typeof e.rulesArgs[a].filters[i]&&s[e.rulesArgs[a].filters[i]])t=t&&s[e.rulesArgs[a].filters[i]](d);else if(e.rulesArgs[a].filters[i]&&"[object Object]"==e.rulesArgs[a].filters[i].toString())for(var r in e.rulesArgs[a].filters[i])s[r]?(d.filterArgs=e.rulesArgs[a].filters[i][r],t=t&&s[r](d)):t=t&&s.newerWin();else t=t&&s.newerWin();d.filter=!1}if(e.rulesArgs[a].rules)for(var i in e.rulesArgs[a].rules)s[e.rulesArgs[a].rules[i]]?t=t&&s[e.rulesArgs[a].rules[i]](d):(console.log("#2"),t=t&&s.newerWin())}return t}};t["default"]=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),d=n(i),r=a(1),o=n(r),s=a(3),u=n(s),l=a(5),f=n(l),c=a(9),p=n(c),m=a(6),g=n(m),h=function(e){this.el=e};h.prototype.addClass=function(e){try{var t=this.el.className.split(" ");t.indexOf(e)<0&&(t.push(e),this.el.className=t.join(" "))}catch(a){console.warn(a,this.el)}return this},h.prototype.removeClass=function(e){try{var t=this.el.className.split(" ");if(t.indexOf(e)>=0){var a=[];for(var n in t)t[n]!=e&&a.push(t[n]);t=a,this.el.className=t.join(" ")}}catch(i){console.warn(i,this.el)}return this},h.prototype.css=function(e){for(attrName in e)this.el.style[attrName]=e[attrName];return this};var v=0;h.prototype.animate=function(e){var t=e;return t.transition=u["default"].animationTime/1e3+"s",this.css(t),new function(e){_animated+=1;var t=function(){};this.done=function(e){t=e()},e.addEventListener("transitionend",function(){v-=1,_animated<=0&&(v=0,t.call(this))})}(this.el)},h.prototype.done=function(e){};var k=function(e){return"string"==typeof e?e=document.querySelector(e):e instanceof Array&&(e=e[0]),new h(e)};d["default"].listen("initField",function(e){var t=e.a.field?e.a.field:"#mat";"string"==typeof t&&(t=2==t.split(".").length?document.getElementsByClassName(t.split(".")[1])[0]:2==t.split("#").length?document.getElementById(t.split("#")[1]):document.getElementsByTagName(t),t||(t=document.getElementById("mat")));var a=(0,p["default"])();a.domElement=t;var n={};e.a.width&&"number"==typeof e.a.width&&(n.width=o["default"].get("zoom")*e.a.width+"px"),e.a.height&&"number"==typeof e.a.height&&(n.height=o["default"].get("zoom")*e.a.height+"px"),e.a.top&&"number"==typeof e.a.top&&(n.top=o["default"].get("zoom")*e.a.top+"px"),e.a.left&&"number"==typeof e.a.left&&(n.left=o["default"].get("zoom")*e.a.left+"px");var i=e.a.theme&&"string"==typeof e.a.theme?e.a.theme:u["default"].theme;k(t).css(n).addClass("field").addClass(i)}),d["default"].listen("hideCard",function(e){e&&e.domElement&&(e.domElement[0].style.display="none")}),d["default"].listen("showCard",function(e){e&&e.domElement&&(e.domElement[0].style.display="block")});var y=function(e,t,a){e.x=t.position&&t.position.x&&"number"==typeof t.position.x?t.position.x:0,e.y=t.position&&t.position.y&&"number"==typeof t.position.y?t.position.y:0,e.x=t.parentPosition&&t.parentPosition.x?e.x+t.parentPosition.x:e.x,e.y=t.parentPosition&&t.parentPosition.y?e.y+t.parentPosition.y:e.y,a.rotate=e.rotate=t.rotate&&"number"==typeof t.rotate?t.rotate:0,e.padding_y=t.paddingY&&"number"==typeof t.paddingY?t.paddingY:t.paddingType?u["default"].padding_y:0,e.padding_x=t.paddingX&&"number"==typeof t.paddingX?t.paddingX:t.paddingType?u["default"].padding_x:0,e.flip_padding_y=t.flipPaddingY&&"number"==typeof t.flipPaddingY?t.flipPaddingY:t.paddingType?u["default"].flip_padding_y:0,e.flip_padding_x=t.flipPaddingX&&"number"==typeof t.flipPaddingX?t.flipPaddingX:t.paddingType?u["default"].flip_padding_x:0};d["default"].listen("addDeckEl",function(e){var t=(0,p["default"])();y(e.params,e.a,e.deck),e.deck.domElement=$("<div>")[0];var a={left:o["default"].get("zoom")*e.params.x+"px",top:o["default"].get("zoom")*e.params.y+"px",width:o["default"].get("zoom")*u["default"].card.width+"px",height:o["default"].get("zoom")*u["default"].card.height+"px",transform:"rotate("+(0|e.params.rotate)+"deg)"};a.display=e.deck.visible?"block":"none",$(e.deck.domElement).css(a).addClass("el").attr({id:e.deck.getId()}),e.a.showSlot&&$(e.deck.domElement).addClass("slot"),e.a["class"]&&$(e.deck.domElement).addClass(e.a["class"]),$(t.domElement).append(e.deck.domElement);var n=e.a.label&&"string"==typeof e.a.label?e.a.label:null;if(!e.a.label&&o["default"].get("debugLabels")&&(n='<span style="color:#65B0FF;">'+e.deck.name+"</span>"),n){var i=$("<div>").addClass("deckLabel").attr({title:e.deck.getId()+" ("+e.deck.parent+")"});$(i).html(n),$(e.deck.domElement).append(i)}}),d["default"].listen("showTip",function(e){e&&e.el&&e.el.domElement&&e.type&&k(e.el.domElement[0]).addClass(e.type)}),d["default"].listen("hideTips",function(e){if(e&&e.types)for(var t in e.types){var a=e.types[t],n=document.getElementsByClassName(a);for(var t in n)k(n[t]).removeClass(a)}else for(var t in g["default"].tipTypes){var a=g["default"].tipTypes[t],n=document.getElementsByClassName(a);for(var i in n){if(0==n.length)return;k(n[i]).removeClass(a)}}}),d["default"].listen("removeEl",function(e){$(e.domElement).remove()}),d["default"].listen("redrawDeck",function(e){e.a&&(y(e.params,e.a,e.deck),e.a.paddingX&&o["default"].get("padding_x",e.a.paddingX),e.a.flipPaddingX&&o["default"].get("flip_padding_x",e.a.flipPaddingX),e.a.paddingY&&o["default"].get("padding_y",e.a.paddingY),e.a.flipPaddingY&&o["default"].get("flip_padding_y",e.a.flipPaddingY));var t={left:o["default"].get("zoom")*e.params.x,top:o["default"].get("zoom")*e.params.y,transform:"rotate("+(0|e.params.rotate)+"deg)"};t.display=e.deck.visible?"block":"none",$(e.deck.domElement).css(t);for(var a in e.cards){var n=e.deck.padding(a),i=(0|e.params.startZIndex)+(0|a),t={left:o["default"].get("zoom")*n.x+"px",top:o["default"].get("zoom")*n.y+"px","z-index":i,"-ms-transform":"rotate("+(0|e.params.rotate)+"deg)","-webkit-transform":"rotate("+(0|e.params.rotate)+"deg)","-webkit-transform":"rotate("+(0|e.params.rotate)+"deg)","-moz-transform":"rotate("+(0|e.params.rotate)+"deg)"};t.display=e.deck.visible?"block":"none",e.cards[a].flip?k(e.cards[a].domElement[0]).addClass("flip"):k(e.cards[a].domElement[0]).removeClass("flip"),$(e.cards[a].domElement).css(t);for(var d in t)e.cards[a].domElement[0].style[d]=t[d]}}),d["default"].listen("addCardEl",function(e){var t=(0,p["default"])();e.domElement=$("<div>").addClass("el card draggable").addClass(e.name);var a={width:o["default"].get("zoom")*u["default"].card.width+"px",height:o["default"].get("zoom")*u["default"].card.height+"px"};$(e.domElement).css(a).attr({id:e.id}),$(t.domElement).append(e.domElement)}),d["default"].listen("moveDragDeck",function(e){f["default"].curLock();for(var t in e.moveDeck){var a=e.destination.padding(e.destination.cards.length-1+(0|t)),n={left:o["default"].get("zoom")*a.x+"px",top:o["default"].get("zoom")*a.y+"px"},i=e.departure.rotate,r=e.destination.rotate;Math.abs(i-r)>180&&(i>r?i-=360:r-=360);var s=(0|u["default"].topZIndex)+(0|t);e.moveDeck[t].card.domElement[0].style["z-index"]=s,$({deg:i,e:e}).animate({deg:r},{duration:u["default"].animationTime,step:function(e){$(this).css({"-ms-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)"})}.bind(e.moveDeck[t].card.domElement)}),$(e.moveDeck[t].card.domElement).animate(n,u["default"].animationTime,function(){e.departure.Redraw(),e.destination.Redraw()})}$(".draggable").promise().done(function(){f["default"].curUnLock(),d["default"].dispatch("moveDragDeckDone",{deck:e.destination})})}),d["default"].listen("moveCardToHome",function(e){f["default"].curLock();for(var t in e.moveDeck){var a=e.departure.padding(e.moveDeck[t].index),n={left:a.x+"px",top:a.y+"px"};$(e.moveDeck[t].card.domElement).animate(n,u["default"].animationTime)}$(".draggable").promise().done(function(){f["default"].curUnLock()}),$(".draggable").promise().done(function(){e.departure&&e.departure.Redraw()})}),d["default"].listen("moveDragDeckDone",function(e){if(e.deck.fill){var t=e.deck.cards;for(var a in t)k(t[a].domElement[0]).addClass("fill")}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),d=n(i),r=a(5),o=n(r),s=a(30),u=n(s),l=[],f=[],c=new function(){this.record=function(e){f=[],l.push(e)},this.undo=function(){var e=l.pop();return e&&f.push(e),e},this.redo=function(){var e=f.pop();return e&&l.push(e),e}},p=!1,m=function(e){p||(p=!0,d["default"].listen("makeStep",c.record),e&&e.drawButtons&&$(document.body).append($("<div>").append($("<span>").addClass("awesome").text("UNDO").click(function(){var e=c.undo();e&&SolitaireEngine.event.dispatch("undo",e)})).append($("<span>").addClass("awesome").text("REDO").click(function(){var e=c.redo();e&&SolitaireEngine.event.dispatch("redo",e)})).css({position:"fixed",top:"1px",left:"1px"})))};t["default"]={deckGenerator:u["default"],debugHistory:m,debugHistoryMgr:c,validateCardName:o["default"].validateCardName}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t="all",a=!1,n=10,d=e&&e.type&&"string"==typeof e.type?e.type:t,s=e&&e.deckCount&&"number"==typeof e.deckCount?e.deckCount:52,u=e&&e.iterations&&"number"==typeof e.iterations&&e.iterations<n?e.iterations:1,l=e&&e.shuffle&&"boolean"==typeof e.shuffle?e.shuffle:a,f=function(e,t){var a=[];for(var n in e)for(var i in t)a.push(e[n]+t[i]);return a},c=36==s?r["default"].card.ranks36:r["default"].card.ranks;if(e&&e.ranks){c=[];for(i in e.ranks)r["default"].card.rank.indexOf(e.ranks[i].toString())>=0&&c.push(e.ranks[i].toString())}for(var p={all:function(){return f(r["default"].card.suits,c)},black:function(){var e=r["default"].card.colors.black;return f(e,c)},red:function(){var e=r["default"].card.colors.red;return f(e,c)},black_and_red:function(){var e=[r["default"].card.colors.red[Math.random()*r["default"].card.colors.red.length|0],r["default"].card.colors.black[Math.random()*r["default"].card.colors.black.length|0]];return f(e,c)},h_only:function(){var e=["h"];return f(e,c)},d_only:function(){var e=["d"];return f(e,c)},c_only:function(){var e=["c"];return f(e,c)},s_only:function(){var e=["s"];return f(e,c)},one_rank_only:function(){var e=[r["default"].card.solors[Math.random()*r["default"].card.solors.length|0]];return f(e,c)}},m=[];u>0;u-=1)m=m.concat(p[d]());return l&&o(m),m};var d=a(3),r=n(d),o=function(e){for(var t,a,n=e.length;n;t=Math.floor(Math.random()*n),a=e[--n],e[n]=e[t],e[t]=a);}}]);
//# sourceMappingURL=SolitaireEngine.js.map