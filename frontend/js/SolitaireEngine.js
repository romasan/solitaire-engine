/*
 * Solitaire game engine
 * Author     : Roman Bauer - <kotapesic@gmail.com>
 * Version    : 0.12.3363
 * Build time : Wed, 05 Apr 2017 15:40:29 GMT
 */
var SolitaireEngine=function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(1),i=n(r),o=a(2),u=n(o),d=a(3),l=n(d),s=a(4),f=(n(s),a(67)),c=(n(f),a(23)),p=(n(c),a(68)),v=(n(p),a(12)),h=n(v),y=a(5),m=(n(y),a(83)),k=n(m),g=a(33),_=(n(g),a(9)),b=(n(_),a(85)),x=n(b),w=null,C=!0;t.event=u.default,t.options=l.default,t.winCheck=k.default.hwinCheck,t.generator=x.default,t.version="9091496443".split(9).slice(1).map(function(e){return parseInt(e,8)}).join("."),t.onload=function(e){w=e},t.onChangePreferences=function(e){i.default.set("changePreferencesCallback",e)},t.init=function(e){if(u.default.dispatch("gameInit",{firstInit:C}),u.default.clearByTag(u.default.tags.inGame),u.default.setTag(u.default.tags.inGame),h.default.clear(),h.default.create(e),C&&(C=!1,"function"==typeof w)){var a=i.default.get("gamePreferencesData");w(a)}var n=i.default.get("changePreferencesCallback");if("function"==typeof n){var r=i.default.get("gamePreferencesData");n(r)}u.default.dispatch("gameInited"),t.Redraw=function(e){h.default.Redraw(e)}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(2),d=n(u),l=a(3),s=(n(l),function(){function e(){r(this,e),this._data={}}return o(e,[{key:"get",value:function(e){return void 0!==this._data[e]?(d.default.dispatch("shareGet:"+e,this._data[e]),this._data[e]):null}},{key:"set",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){if(d.default.dispatch("shareChange:"+e,{from:this._data[e],to:t}),"boolean"==typeof a&&a)try{this._data[e]=["string","number","boolean"].indexOf(void 0===t?"undefined":i(t))>=0?t:t instanceof Array?Object.assign([],t):Object.assign({},t)}catch(a){this._data[e]=t}else this._data[e]=t;d.default.dispatch("shareSet:"+e,t)}else if(e instanceof Object){"boolean"==typeof t&&(a=t);for(var n in e){if(d.default.dispatch("shareChange:"+e,{from:this._data[n],to:e[n]}),"boolean"==typeof a&&a)try{this._data[n]=["string","number","boolean"].indexOf(i(e[n]))>=0?e[n]:e[n]instanceof Array?Object.assign([],e[n]):Object.assign({},e[n])}catch(t){this._data[n]=e[n]}else this._data[n]=e[n];d.default.dispatch("shareSet:"+n,e[n])}}}},{key:"getAll",value:function(){return this._data}},{key:"delete",value:function(e){delete this._data[e]}}]),e}());t.default=new s},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e),this.tags={preInit:"preInit",inGame:"inGame"},this._tag=this.tags.preInit,this._events={}}return n(e,[{key:"listen",value:function(e,t,a,n){"function"==typeof t&&"string"==typeof e&&(this._events[e]?this._events[e].push({tag:this._tag,context:a,callback:t,once:n}):this._events[e]=[{tag:this._tag,callback:t,context:a,once:n}])}},{key:"once",value:function(e,t,a){this.listen(e,t,a,!0)}},{key:"dispatch",value:function(e,t){if(this._events[e])for(var a in this._events[e])this._events[e][a]&&(this._events[e][a].callback(t,{eventInfo:{eventName:e,index:a,count:this._events[e].length}}),this._events[e][a].once&&delete this._events[e][a])}},{key:"clear",value:function(){this._events={}}},{key:"setTag",value:function(e){this._tag=e}},{key:"clearByTag",value:function(e){for(var t in this._events)for(var a in this._events[t])this._events[t][a]&&this._events[t][a].tag==e&&(this._events[t]=this._events[t].slice(0,a).concat(this._events[t].slice((0|a)+1)))}},{key:"get",value:function(e,t){if(t){var a=[];for(var n in this._events[e]){var r=!0;for(var i in t)r=r&&this._events[e][n][i]==t[i];r&&a.push(this._events[e][n])}return a}return this._events[e]}},{key:"has",value:function(e,t){if(t){var a=0;for(var n in this._events[e]){var r=!0;for(var i in t)r=r&&this._events[e][n][i]==t[i];r&&(a+=1)}return a}return this._events[e]?this._events[e].length:0}},{key:"_getAll",value:function(){return this._events}}]),e}();t.default=new r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={themes:{field:["default_field","alternative_field"],face:["default_face","alternative_face"],back:["default_back","alternative_back"]},pref:{field:"default_field",face:"alternative_face",back:"default_back"},showTips:!0,showTipsDestination:!1,showTipPriority:!1,canMoveFlip:!1,tipsParams:{hideOnEmpty:!1,excludeHomeGroups:!0},zoom:1,locale:"ru",animation:!0,animationTime:400,inputParams:{doubleClick:!1},flip:null,actions:null,can_move_flip:!1,showSlot:!0,autohide:!1,autoUnflipTop:!0,paddingType:"_default",flip_type:"none",rotate:0,takeRules:["any"],putRules:["any"],fullRules:["not"],moveDistance:0,padding_y:0,padding_x:0,flip_padding_y:0,flip_padding_x:0,move_distance:10,debugLabels:!1,startZIndex:100,topZIndex:900,card:{width:71,height:96,suits:["h","d","c","s"],ranks:["1","2","3","4","5","6","7","8","9","10","j","q","k"],values:[1,2,3,4,5,6,7,8,9,10,11,12,13],ranks36:["1","6","7","8","9","10","j","q","k"],colors:{red:["h","d"],black:["c","s"]}},stepType:"default",forceClone:!0,showHistoryAnimation:!0}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(1),d=n(u),l=a(2),s=n(l),f=a(3),c=n(f),p=a(5),v=n(p),h=a(14),y=n(h),m=a(9),k=n(m),g=function(){function e(){var t=this;r(this,e),d.default.set("dragDeck",null),d.default.set("startCursor",null);try{document.onmousedown=function(e){0===e.button&&t.take(e.target,e.clientX,e.clientY)},document.onmousemove=function(e){t.drag(e.clientX,e.clientY)},document.onmouseup=function(e){t.put(e.target,e.clientX,e.clientY)},document.ondblclick=function(e){t.take(e.target,e.clientX,e.clientY),t.put(e.target,e.clientX,e.clientY,!0),v.default.curUnLock()},document.addEventListener("touchstart",function(e){t.take(e.target,e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchmove",function(e){d.default.get("startCursor")&&e.preventDefault(),t.drag(e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchend",function(e){t.put(e.changedTouches[0].target,e.changedTouches[0].clientX,e.changedTouches[0].clientY)},!1)}catch(e){}}return o(e,[{key:"break",value:function(){var e=d.default.get("dragDeck");if(e&&e[0]&&e[0].card&&e[0].card.parent){var t=y.default.getDeckById(e[0].card.parent);t&&t.Redraw()}d.default.set("dragDeck",null),d.default.set("startCursor",null),v.default.curUnLock()}},{key:"take",value:function(e,t,a){if(d.default.set("dragDeck",null),d.default.set("startCursor",null),!v.default.isCurLock()&&!d.default.get("sessionStarted")){if(e.className.split(" ").indexOf("slot")>=0){var n=e.id,r=v.default.getElementById(n);(d.default.get("markerMode")||d.default.get("specialStepMode"))&&(r=null),r&&(s.default.dispatch("click",{to:r,toCard:null}),s.default.dispatch("click:emptyDeck",{to:r,toCard:null}))}if(e.className.split(" ").indexOf("draggable")>=0){var o=function(){var n=e.id,r=n?v.default.getElementById(n):null,i=r&&r.parent?r.parent:null,o=i?y.default.getDeckById(i):null;if(o&&d.default.get("markerMode")&&(s.default.dispatch("toggleMarkCard",{card:r,callback:function(e){var t=o.getCardIndexById(r.id),a={};a[e?"markCard":"unmarkCard"]={deckName:o.name,cardName:r.name,cardIndex:t},s.default.dispatch("addStep",a),s.default.dispatch("toggleMarkerMode")}}),o=null),o&&d.default.get("specialStepMode")&&(s.default.dispatch("specialStep",r),s.default.dispatch("toggleSpecialStepMode"),o=null),o&&(s.default.dispatch("click",{to:o,toCard:r}),r.flip?s.default.dispatch("click:flipCard",{to:o,toCard:r}):s.default.dispatch("click:unflipCard",{to:o,toCard:r}),r.flip))return{v:void 0};var u=o?o.Take(n):null;d.default.set("dragDeck",u),u&&(d.default.set("startCursor",{x:t,y:a}),k.default.tipsDestination({currentCard:r}))}();if("object"===(void 0===o?"undefined":i(o)))return o.v}}}},{key:"drag",value:function(e,t){if(!v.default.isCurLock()){var a=d.default.get("startCursor"),n=d.default.get("dragDeck");if(n&&a){var r=v.default.getElementById(n[0].card.parent);s.default.dispatch("dragDeck",{x:e,y:t,_dragDeck:n,_startCursor:a,_deck:r})}}}},{key:"put",value:function(e,t,a,n){if(!v.default.isCurLock()){var r=d.default.get("startCursor"),i=d.default.get("dragDeck");if(i&&r){var o=v.default.getElementById(i[0].card.parent),u=o.padding(i[0].index),l=Math.sqrt(function(e){return e*e}(t-r.x)+function(e){return e*e}(a-r.y)),f={distance:l,dbclick:!!n,direction:{x:t-r.x,y:a-r.y,right:t>r.x,left:t<r.x,down:a>r.y,up:a<r.y},lastPosition:{x:t,y:a},deckPosition:{x:u.x+(t-r.x),y:u.y+(a-r.y)}};d.default.set("lastCursorMove",f,c.default.forceClone),d.default.set("lastDragDeck",{dragDeckParentId:i[0].card.parent,dragDeck:i},c.default.forceClone),s.default.dispatch("hideCard",e);var p=document.elementFromPoint(t,a);s.default.dispatch("showCard",e),s.default.dispatch("Move",{moveDeck:i,to:p&&p.id?p.id:"mat",cursorMove:f}),d.default.set("dragDeck",null),d.default.set("startCursor",null)}}}}]),e}();t.default=new g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(2),u=n(o),d=a(3),l=n(d),s=a(6),f=n(s),c=a(9),p=n(c),v=a(12),h=n(v),y=a(33),m=(n(y),a(61)),k=n(m),g=a(63),_=n(g),b=a(65),x=n(b),w=a(66);n(w);u.default.listen("gameInit",function(e){i.default.set("stepType",l.default.stepType),i.default.delete("sessionStarted"),i.default.set("markerMode",!1),O(),e.firstInit&&((0,k.default)(),(0,_.default)())}),u.default.listen("gameInited",function(e){(0,x.default)()}),u.default.listen("moveEnd",function(e){p.default.checkTips()}),u.default.listen("actionBreak",function(e){p.default.checkTips()}),u.default.listen("startSession",function(e){i.default.set("sessionStarted",!0),f.default.backup()}),u.default.listen("stopSession",function(e){i.default.set("sessionStarted",!1)});var C=function(e){return i.default.get("curLockState")},D=function(e){i.default.set("curLockState",!0)},O=function(e){i.default.set("curLockState",!1)},T=function(e){return i.default.get("elements")},P=function(e){var t=i.default.get("elements");return t[e]},M=function(e,t){var a=[],n=i.default.get("elements");for(var r in n)n[r].name&&"string"==typeof n[r].name&&n[r].name==e&&(t&&"string"==typeof n[r].type&&t&&n[r].type==t?a.push(n[r]):a.push(n[r]));return a},I=function(e,t){return M(e,t)[0]},j=function(e){var t=[],a=i.default.get("elements");if(e)for(var n in a)"string"==typeof a[n].type&&a[n].type==e&&t.push(a[n]);return t},S=function(e){if("string"!=typeof e)return!1;var t=e.slice(0,1),a=e.slice(1,3),n=null,r=l.default.card.values[l.default.card.ranks.indexOf(a)];for(var i in l.default.card.colors)l.default.card.colors[i].indexOf(t)>=0&&(n=i);return l.default.card.suits.indexOf(t)>=0&&l.default.card.ranks.indexOf(a)>=0&&{color:n,value:r,name:e,suit:t,rank:a}},E=0,N=function(e){return E+=1};i.default.set("animation",l.default.animation);var R=function(e){i.default.set("animation",!0)},B=function(e){i.default.set("animation",l.default.animation)},A=function(e){i.default.set("animation",!1)};u.default.listen("newGame",function(e){A()}),u.default.listen("historyReapeater",function(e){e?(i.default.set("noRedraw",!0),i.default.set("noTips",!0)):(i.default.set("noRedraw",!1),h.default.Redraw(),i.default.set("noTips",!1),p.default.checkTips())}),i.default.set("stepType",l.default.stepType);var F=function(e){var t=i.default.get("markerMode");i.default.set("markerMode",!t),t?document.getElementById("markCard").className="":document.getElementById("markCard").className="markCardButtonActive"};u.default.listen("toggleMarkerMode",F);var L=function(e){var t=i.default.get("specialStepMode");i.default.set("specialStepMode",!t);var a=document.getElementById("specialMoveBtn").className.split(" ");t?a=a.filter(function(e){return"specialStepButtonActive"!=e}):a.push("specialStepButtonActive"),document.getElementById("specialMoveBtn").className=a.join(" ")};u.default.listen("toggleSpecialStepMode",L),t.default={isCurLock:C,curLock:D,curUnLock:O,getElements:T,getElementById:P,getElementsByName:M,getElementByName:I,getElementsByType:j,validateCardName:S,genId:N,animationOn:R,animationOff:A,animationDefault:B}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(1),d=n(u),l=a(2),s=n(l),f=a(3),c=(n(f),a(5)),p=n(c),v=a(7),h=n(v),y=a(8),m=n(y),k=["parent","visible","flip"],g=function(){function e(){r(this,e),this._state=null,this._sourceList=["stepType"],this._clearList=["animatedCallback","animatedElements","animatedElementsStack","curLockState","sessionStarted","startCursor","lastCursorMove"]}return o(e,[{key:"backup",value:function(){s.default.dispatch("debugFlag",{flag:2,color:"green",text:"sm:backup"}),this._state={};for(var e in this._sourceList){var t=d.default.get(this._sourceList[e]);this._state[this._sourceList[e]]=["string","number","boolean"].indexOf(void 0===t?"undefined":i(t))>=0?t:t instanceof Array?Object.assign([],t):Object.assign({},t)}this._state.model={};var a=(0,h.default)();for(var n in a){var r=[];for(var o in a[n].cards){var u={name:a[n].cards[o].name,id:a[n].cards[o].id};for(var l in k){var f=k[l];u[f]=a[n].cards[o][f]}r.push(u)}this._state.model[n]={name:a[n].name,cards:r,group:a[n].parent}}}},{key:"restore",value:function(){if(this._state){for(var e in this._clearList)d.default.delete(this._clearList[e]);for(var t in this._sourceList)d.default.set(this._sourceList[t],this._state[this._sourceList[t]],!0);for(var a in this._state.model){var n=(0,m.default)(a),r=[];for(var i in this._state.model[a].cards){var o=this._state.model[a].cards[i].id,u=p.default.getElementById(o);if(u.name==this._state.model[a].cards[i].name){for(var l in k){var s=k[l];u[s]=this._state.model[a].cards[i][s]}r.push(u)}}n.cards=r,n.Redraw()}}}},{key:"get",value:function(){return this._state}},{key:"log",value:function(){return this._state}}]),e}();t.default=new g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r);t.default=function(e){var t={},a=i.default.get("elements");if(e&&e.visible)for(var n in a)"deck"==a[n].type&&a[n].visible&&(t[n]=a[n]);else for(var r in a)"deck"==a[r].type&&(t[r]=a[r]);return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r);t.default=function(e){var t=i.default.get("elements");return!(!t[e]||"deck"!=t[e].type)&&t[e]}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(1),u=n(o),d=a(3),l=n(d),s=a(5),f=n(s),c=a(10),p=n(c),v=a(11),h=n(v),y=a(14),m=n(y),k=a(12),g=n(k),_=l.default.showTips,b=["tip","tipTo","tipPriority","tipToHome"],x=[],w=function(e){return x},C=function(e){if(u.default.get("noTips"))return!1;i.default.dispatch("hideTips");var t=m.default.getDecks({visible:!0});if(x=(0,p.default)({decks:t}),0==x.length&&u.default.get("stepType")==l.default.stepType&&i.default.dispatch("noTips"),_){var a=g.default.homeGroups;for(var n in x)g.default.tipsParams.excludeHomeGroups&&a&&a.length?a.indexOf(x[n].from.deck.parent)<0&&i.default.dispatch("showTip",{el:x[n].from.card,type:"tipToHome"}):i.default.dispatch("showTip",{el:x[n].from.card,type:"tipToHome"})}};i.default.listen("makeStep",C),i.default.listen("checkTips",C);var D=function(e){_=!0,e&&e.init||C()};i.default.listen("tips:on",D),i.default.listen("tipsON",D);var O=function(e){_=!1,e&&e.init||C()};i.default.listen("tips:off",O),i.default.listen("tipsOFF",O);var T=function(e){if(u.default.get("showTipPriority")&&(i.default.dispatch("hideTips",{types:["tipPriority"]}),u.default.showTipPriority&&e&&e.moveDeck&&e.cursorMove&&e.cursorMove.distance&&e.cursorMove.distance>=u.default.moveDistance)){var t=(0,h.default)(e.moveDeck,e.cursorMove);t&&i.default.dispatch("showTip",{el:t.to.deck,type:"tipPriority"})}},P=function(e){if(u.default.get("showTipsDestination")&&(i.default.dispatch("hideTips"),e&&e.currentCard&&e.currentCard.id))for(var t in x)x[t].from.card.id==e.currentCard.id&&i.default.dispatch("showTip",{el:x[t].to.deck,type:"tipTo"})},M=function(e){for(var t in x)if(x[t].from.deck.name==e)return!0;return!1},I=function(e,t){for(var a in x)if(x[a].from.deck.name==e&&x[a].to.deck.name==t)return!0;return!1},j=function e(t){var a=g.default.homeGroups,n=[];for(var r in a){var o=a[r],u=f.default.getElementsByName(o,"deck")[0],d=u.getDecks();for(var l in d){var s=d[l];n.push(s.name)}}var c=[];for(var p in x){var v=x[p];n.indexOf(v.to.deck.name)>=0&&n.indexOf(v.from.deck.name)<0&&c.push(v)}if(c.length>0){var h=c[0],y={from:h.from.deck.name,to:h.to.deck.name,deck:[h.from.card.name],addStep:!0,save:!0};i.default.dispatch("forceMove",y),C(),e(t)}else i.default.dispatch("winCheck",{show:!0})};i.default.listen("autoStepToHome",j),t.default={tipTypes:b,getTips:w,checkTips:C,showTips:D,hideTips:O,tipsMove:T,checkFrom:M,fromTo:I,tipsDestination:P}},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e),this._decks=null,this._moves=[]}return n(e,[{key:"get",value:function(e){this._decks=e.decks,this._moves=[];for(var t in this._decks){var a=this._decks[t].cards;this.cardsInTakeDeck(a,t)}return this._moves}},{key:"cardsInTakeDeck",value:function(e,t){for(var a in e){var n=e[a].id,r=this._decks[t].Take(n);r&&this.decksToPut(e,r,t,a)}}},{key:"decksToPut",value:function(e,t,a,n){for(var r in this._decks)if(a!=r){var i=this._decks[r].Put(t);i&&this.put(r,a,n,e)}}},{key:"put",value:function(e,t,a,n){var r=this._decks[e].cards,i=r.length?r[r.length-1]:null;this._moves.push({from:{deck:this._decks[t],card:n[a],count:n.length},to:{deck:this._decks[e],lastCard:i,count:r.length}})}}]),e}(),i=new r;t.default=function(e){return i.get(e)}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=(n(r),a(3)),o=n(i),u=a(5),d=(n(u),a(9)),l=n(d),s=a(12),f=n(s);t.default=function(e,t){var a=[],n=l.default.getTips();for(var r in n)n[r].from.card.id==e[0].card.id&&a.push(n[r]);if(0==a.length)return!1;var i=0,u=0,d=-1,s=f.default.homeGroups;if(s){var c=[];for(var p in s)for(var v in a)a[v].to.deck.parent==s[p]&&c.push(a[v]);c.length&&(a=c)}if(a.length>1){for(var h=0;h<a.length;h+=1){var y=[];a[h].to.deck.cardsCount()&&y.push(a[h]),y.length&&(a=y)}for(var m in a){var k={x:t.deckPosition.x+(o.default.card.width/2|0),y:t.deckPosition.y+(o.default.card.height/2|0)},g=a[m].to.deck.padding(a[m].to.deck.cardsCount()),_={x:g.x+(o.default.card.width/2|0),y:g.y+(o.default.card.height/2|0)};a[m].distance=Math.sqrt(function(e){return e*e}(k.x-_.x)+function(e){return e*e}(k.y-_.y)),a[m].inDirection=!1,(t.direction.x>0&&_.x>k.x||t.direction.x<0&&_.x<k.x)&&(a[m].inDirection=!0,u+=1)}for(var b in a)"-1"==d?0==u?d=a[b].distance:a[b].inDirection&&(d=a[b].distance,i=b):a[b].distance<d&&(0==u?(d=a[b].distance,i=b):a[b].inDirection&&(d=a[b].distance,i=b))}return a[i]}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(1),d=n(u),l=a(2),s=n(l),f=a(3),c=n(f),p=a(5),v=(n(p),a(13)),h=n(v),y=a(14),m=n(y),k=a(9),g=n(k),_=a(57),b=n(_),x=a(60),w=n(x),C=function(){function e(){r(this,e),d.default.set("elements",{}),this.tipsParams={},this.inputParams={}}return o(e,[{key:"create",value:function(e){this.homeGroups=e.homeGroups?e.homeGroups:[],"boolean"==typeof e.showTips&&e.showTips?g.default.showTips({init:!0}):g.default.hideTips({init:!0}),d.default.set("stepType",c.default.stepType);var t={showTipsDestination:"boolean",showTipPriority:"boolean",moveDistance:"number",zoom:"number",animationTime:"number",showHistoryAnimation:"boolean"};for(var a in t)d.default.set(a,i(e[a])==t[a]?e[a]:c.default[a]);if(d.default.set("winCheck",e.winCheck),e.preferences){var n=w.default.get("pref"),r={},o={};for(var u in e.preferences)"string"==typeof u&&(r[u]=e.preferences[u],o[u]=n&&void 0!==n[u]?n[u]:e.preferences[u].value);d.default.set("gamePreferences",r),d.default.set("gamePreferencesData",o)}else d.default.set("gamePreferences",{});for(var l in c.default.tipsParams)this.tipsParams[l]=e.tipsParams&&void 0!==e.tipsParams[l]?e.tipsParams[l]:c.default.tipsParams[l];for(var f in c.default.inputParams)this.inputParams[f]=e.inputParams&&void 0!==e.inputParams[f]?e.inputParams[f]:c.default.inputParams[f];if(e.startZIndex&&"number"==typeof e.startZIndex&&d.default.set("start_z_index",e.startZIndex),e.autoSteps&&(this.autoSteps=(0,b.default)(e.autoSteps)),s.default.dispatch("initField",e),e.groups)for(var p in e.groups)e.groups[p].name=p,h.default.add(e.groups[p]);if(e.decks)for(var v in e.decks)m.default.addDeck(e.decks[v]);if(e.fill){var y=m.default.getDecks(),k=null;try{k=Object.assign([],e.fill)}catch(t){k=e.fill}for(;k.length;)for(var _ in y)if(k.length){var x=k.shift();y[_].Fill([x])}}g.default.checkTips(),s.default.dispatch("newGame")}},{key:"Redraw",value:function(e){if(e){for(var t in e.groups){var a=h.default.getByName(t);a&&a.Redraw(e.groups[t])}for(var n in e.decks){var r=m.default.getDeck(e.decks[n].name);r&&r.Redraw(e.decks[n])}}else{var i=m.default.getDecks();for(var o in i)i[o].Redraw()}}},{key:"clear",value:function(){var e=d.default.get("elements");for(var t in e)"deck"==e[t].type?(e[t].clear(),e[t]=null):"group"==e[t].type&&(e[t]=null);d.default.set("elements",{})}}]),e}();t.default=new C},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=(n(o),a(1)),d=n(u),l=a(3),s=n(l),f=a(5),c=n(f),p=a(14),v=n(p),h=a(43),y=n(h),m=a(44),k=n(m),g=a(45),_=n(g),b={flip:{type:"any"},showSlot:{type:"any"},takeRules:{type:"any"},putRules:{type:"any"},fullRules:{type:"any"},autoHide:{type:"any"},paddingType:{type:"any"},padding:{type:"any"},paddingX:{type:"any"},paddingY:{type:"any"},flipPadding:{type:"any"},flipPaddingX:{type:"any"},flipPaddingY:{type:"any"},actions:{type:"any"},tags:{type:"any"},save:{type:"boolean",default:!0},autoUnflipTop:{type:"boolean",default:s.default.autoUnflipTop}},x=function(){function e(t,a){r(this,e),this.type="group",this.id=a,this.name=t.name&&"string"==typeof t.name?t.name:"name_"+a,this.position={x:t.position&&t.position.x&&"number"==typeof t.position.x?t.position.x:0,y:t.position&&t.position.y&&"number"==typeof t.position.y?t.position.y:0},this.placement=t.placement?{x:t.placement.x?t.placement.x:0,y:t.placement.y?t.placement.y:0}:null,this.decks={},this.parameters={};for(var n in b)"any"==b[n].type?this.parameters[n]=t[n]?t[n]:s.default[n]:"boolean"==b[n].type&&(this.parameters[n]="boolean"==typeof t[n]?t[n]:b[n].default);this.deckIndex=[],this.tags=t.tags}return i(e,[{key:"addDeck",value:function(e){if(e){e.position||(e.position={x:0,y:0}),e.parent||(e.parent=this.name),e.parentPosition={x:this.position.x,y:this.position.y};var t=0;if(e.groupIndex&&decks[this.deckIndex[e.groupIndex-1]].this.deckIndex==e.this.deckIndex&&"number"==typeof e.groupIndex&&this.deckIndex[e.groupIndex-1]&&(e.groupIndex=null),e.groupIndex&&"number"==typeof e.groupIndex)if(this.deckIndex[e.groupIndex-1]){for(;void 0!==this.deckIndex[t];t+=1);if(placement){var a=this.deckIndex[e.groupIndex-1],n=d.default.get("elements");placement.x&&n[a].x(this.position.x+(placement.x+s.default.card.width)*a),placement.y&&n[a].y(this.position.y+(placement.y+s.default.card.width)*a),d.default.set("elements",n)}this.deckIndex[t]=this.deckIndex[e.groupIndex-1],this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1}else this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1;else{for(;void 0!==this.deckIndex[t];t+=1);this.deckIndex[t]=!0}this.placement&&(this.placement.x&&(e.position.x=(this.placement.x+s.default.card.width)*t),this.placement.y&&(e.position.y=(this.placement.y+s.default.card.height)*t));for(var r in b)"any"==b[r].type?this.parameters[r]&&void 0===e[r]&&(e[r]=this.parameters[r]):"boolean"==b[r].type&&"boolean"==typeof this.parameters[r]&&void 0===e[r]&&(e[r]=this.parameters[r]);e.deckIndex="number"==typeof e.deckIndex?e.deckIndex:(0|t)+1;var i=v.default.addDeck(e);this.deckIndex[t]=i.id,this.decks[i.id]=i}}},{key:"Fill",value:function(e){(0,y.default)(this,e)}},{key:"getDeckById",value:function(e){return this.decks[e]}},{key:"getDeckIndexById",value:function(e){for(var t in this.deckIndex)if(this.deckIndex[t]==e)return t;return null}},{key:"getDeckIdByIndex",value:function(e){return this.deckIndex[(0|e)-1]}},{key:"getDeckByIndex",value:function(e){var t=this.getDeckIdByIndex(e);return this.getDeckById(t)}},{key:"getDecksByName",value:function(e){var t={};for(var a in this.decks)this.decks[a].name==e&&(t[a]=decks[a]);return t}},{key:"getDecks",value:function(e){var t=[];for(var a in this.decks)e&&e.visible?this.decks[a].visible&&t.push(this.decks[a]):t.push(this.decks[a]);return t}},{key:"Redraw",value:function(e){(0,k.default)(this,e)}},{key:"hasDeck",value:function(e){var t=!1;for(var a in decks)decks[a].name==e&&(t=!0);return t}},{key:"decksCount",get:function(){var e=0;for(var t in this.decks)e+=1;return e}}]),e}(),w=function(e){if(!e)return!1;if(!e.decks)return!1;var t="group_"+c.default.genId(),a=new x(e,t);if(e.decks){if("number"==typeof e.decks&&(e.decks={generator:{type:"count",count:e.decks}}),e.decks.generator){if(!e.decks.generator.type)return;if(!_.default[e.decks.generator.type])return;e.decks=_.default[e.decks.generator.type](a,e.decks.generator),e.placement=null}for(var n in e.decks)for(var r in e.decks[n].relations){var i=null;try{i=Object.assign({},e.decks[n].relations[r])}catch(t){i=e.decks[n].relations[r]}}for(var o in e.decks)a.addDeck(e.decks[o])}var u=d.default.get("elements");if(u[t]=a,d.default.set("elements",u),e&&e.fill){var l=e.fill.length;l&&a.Fill(e.fill)}return a},C=function(e){return c.default.getElementsByName(e,"group")[0]};t.default={getByName:C,add:w}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=n(o),d=a(1),l=n(d),s=a(3),f=n(s),c=a(5),p=n(c),v=a(15),h=n(v),y=a(16),m=n(y),k=a(18),g=n(k),_=a(19),b=n(_),x=a(20),w=n(x),C=a(21),D=n(C),O=a(38),T=n(O),P=a(39),M=n(P),I=a(40),j=n(I),S=a(13),E=n(S),N=a(7),R=n(N),B=a(8),A=n(B),F=a(41),L=n(F),X=a(42),Y=n(X),H=a(35),z=(n(H),function(){function e(t,a){var n=this;if(r(this,e),!t)return!1;this.cards=[],this.type="deck",this.full=!1,this.id=a;var i=E.default.getByName(t.parent),o=i?i.name:"no_parent_",d=i?i.getDecks().length:a;this.name="string"==typeof t.name?t.name:o+"_"+d,this.locked=!!t.locked,this.save=!!t.save,this.visible="boolean"!=typeof t.visible||t.visible,this.deckIndex="number"==typeof t.deckIndex?t.deckIndex:null,this.parent="string"==typeof t.parent?t.parent:"field",this.autoHide="boolean"==typeof t.autoHide?t.autoHide:f.default.autohide,this.data={},void 0===t.showSlot&&(t.showSlot=f.default.showSlot),t.padding&&("number"==typeof t.padding.x&&"number"!=typeof t.paddingX&&(t.paddingX=t.padding.x),"number"==typeof t.padding.y&&"number"!=typeof t.paddingY&&(t.paddingY=t.padding.y)),t.flipPadding&&("number"==typeof t.flipPadding.x&&"number"!=typeof t.flipPaddingX&&(t.flipPaddingX=t.flipPadding.x),"number"==typeof t.flipPadding.y&&"number"!=typeof t.flipPaddingY&&(t.flipPaddingY=t.flipPadding.y)),this._params={padding_y:"number"==typeof t.paddingY?t.paddingY:f.default.padding_y,flip_padding_y:"number"==typeof t.flipPaddingY?t.flipPaddingY:f.default.flip_padding_y,padding_x:"number"==typeof t.paddingX?t.paddingX:f.default.padding_x,flip_padding_x:"number"==typeof t.flipPaddingX?t.flipPaddingX:f.default.flip_padding_x,startZIndex:"number"==typeof t.startZIndex?t.startZIndex:f.default.startZIndex,rotate:"number"==typeof t.rotate?t.rotate:f.default.rotate,x:0,y:0},this.rotate=this._params.rotate,this.autoUnflipTop="boolean"==typeof t.autoUnflipTop?t.autoUnflipTop:f.default.autoUnflipTop;var l=null,s=t.flip&&"string"==typeof t.flip?t.flip.indexOf(":")>=0?function(e){var t=e[0];return 2==e.length&&(l=e[1]),h.default[t]?t:f.default.flip_type}(t.flip.split(":")):h.default[t.flip]?t.flip:f.default.flip_type:f.default.flip_type;this.cardFlipCheck=function(e,t,a){e.flip=h.default[s](t,a,l);
},this.putRules=t.putRules?"string"==typeof t.putRules?m.default[t.putRules]?[t.putRules]:f.default.putRules:t.putRules.constructor==Array?t.putRules.filter(function(e){return!("string"!=typeof e||!m.default[e])}):f.default.putRules:f.default.putRules,0==this.putRules.length&&(this.putRules=f.default.putRules),this.takeRules=t.takeRules?"string"==typeof t.takeRules?g.default[t.takeRules]?[t.takeRules]:f.default.takeRules:t.takeRules.constructor==Array?t.takeRules.filter(function(e){return"string"==typeof e&&g.default[e]}):f.default.takeRules:f.default.takeRules,this.fullRules=t.fullRules?"string"==typeof t.fullRules?b.default[t.fullRules]?[t.fullRules]:f.default.fullRules:t.putRules.constructor==Array?t.fullRules.filter(function(e){return"string"==typeof e&&b.default[e]}):f.default.fullRules:f.default.fullRules;var c=null,p=t.paddingType&&"string"==typeof t.paddingType?w.default[t.paddingType]?w.default[t.paddingType]:t.paddingType.indexOf(":")>=0?function(e){var t=e[0];return w.default[t]?(c=e[1],w.default[t]):w.default[f.default.paddingType]}(t.paddingType.split(":")):w.default[f.default.paddingType]:w.default[f.default.paddingType];this.padding=function(e){var t=n.getCards(),a=e<t.length?e:t.length-1,r=t[a]?t[a]:n.cards[e];return p(n._params,r,a,t.length,t,c)},this.actions=[],t.actions&&(this.actions=t.actions,D.default.add(this)),t.relations?this.relations=t.relations:this.relations=[],this.tags=t.tags?t.tags:[],u.default.dispatch("addDeckEl",{deckData:t,deck:this,params:this._params});var v=function(e){e.destination.name==n.name&&n.checkFull()};u.default.listen("moveDragDeck",v)}return i(e,[{key:"Redraw",value:function(e){u.default.dispatch("redrawDeck",{deck:this,deckData:e,params:this._params,cards:this.cards}),u.default.dispatch("redrawDeckFlip",{cards:this.cards})}},{key:"getTopCard",value:function(){return 0!=this.cards.length&&this.cards[this.cards.length-1]}},{key:"getSomeCards",value:function(e){var t=[];("number"!=typeof e||e>this.cards.length||e<1)&&(e=this.cards.length);for(var a=0;a<e;a+=1)t.push(this.cards[this.cards.length-1-a]);return t}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"flipCheck",value:function(){for(var e in this.cards)this.cardFlipCheck(this.cards[e],0|e,this.cards.length,this.cards[this.cards.length-1].name);u.default.dispatch("redrawDeckFlip",this)}},{key:"unflipCardByIndex",value:function(e){this.cards[e]&&(this.cards[e].flip=!1,this.Redraw(),u.default.dispatch("addStep",{unflip:{deckName:this.name,cardIndex:e,cardName:this.cards[e].name}}))}},{key:"unflipTopCard",value:function(e){this.cards.length>0&&(this.unflipCardByIndex(this.cards.length-1),e&&u.default.dispatch("addStep",{unflip:{cardName:this.cards[this.cards.length-1].name,cardIndex:this.cards.length-1,deckName:this.name}}))}},{key:"flipAllCards",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];for(var a in this.cards)this.cards[a].flip=!0,t&&u.default.dispatch("addStep",{flip:{cardName:this.cards[a].name,cardIndex:a,deckName:this.name}});e&&this.Redraw()}},{key:"unflipAllCards",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];for(var a in this.cards)this.cards[a].flip=!1,t&&u.default.dispatch("addStep",{unflip:{cardName:this.cards[a].name,cardIndex:a,deckName:this.name}});e&&this.Redraw()}},{key:"checkFull",value:function(){if(!this.full&&this.fullRules&&this.fullRules.length>0){var e=!0;for(var t in this.fullRules){var a=this.fullRules[t];if("string"==typeof a)e=e&&"function"==typeof b.default[a]&&b.default[a](this);else for(var n in a)"string"==typeof n&&"function"==typeof b.default[n]&&(e=e&&b.default[n](this,a[n]))}this.full=e}return this.full}},{key:"Fill",value:function(e){for(var t in e)this.genCardByName(e[t])}},{key:"clear",value:function(){for(var e in this.cards)u.default.dispatch("removeEl",this.cards[e]),this.cards[e]=null;this.cards=[],u.default.dispatch("removeEl",this)}},{key:"Push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null;t&&(a=this.cardsCount());for(var n in e)e[n].parent=this.id,t&&a<this.cards.length?this.cards=[].concat(this.cards.slice(0,a),e[n],this.cards.slice(a)):this.cards.push(e[n])}},{key:"Pop",value:function(e,t){var a=this.getCards();if(a.length<e)return!1;for(var n=[];e;e-=1){for(var r=a.pop(),i=0;i<this.cards.length;i+=1)this.cards[i].id==r.id&&(this.cards=[].concat(this.cards.slice(0,i),this.cards.slice((0|i)+1)));t&&(r.parent=null),n.push(r),n[n.length-1].parent=null}return n.reverse(),this.autoHide&&0==this.cards.length&&this.hide(),this.Redraw(),n}},{key:"Take",value:function(e){return(0,T.default)(this,e)}},{key:"Put",value:function(e){return(0,M.default)(this,e)}},{key:"genCardByName",value:function(e){return(0,j.default)(this,e)}},{key:"hide",value:function(){this.visible=!1,u.default.dispatch("addStep",{hideDeck:this.name}),this.Redraw()}},{key:"show",value:function(){this.visible=!1,u.default.dispatch("addStep",{showDeck:this.name}),this.Redraw()}},{key:"hideCards",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];for(var a in this.cards)this.cards[a].visible=!1,t&&u.default.dispatch("addStep",{hide:{cardName:this.cards[a].name,cardIndex:a,deckName:this.name}});e&&this.Redraw()}},{key:"hideCardByIndex",value:function(e,t){this.cards[e]&&(this.cards[e].visible=!1,t&&this.Redraw())}},{key:"showCards",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];for(var a in this.cards)this.cards[a].visible=!0,t&&u.default.dispatch("addStep",{show:{cardName:this.cards[a].name,cardIndex:a,deckName:this.name}});e&&this.Redraw()}},{key:"showCardByIndex",value:function(e,t){this.cards[e]&&(this.cards[e].visible=!0,t&&this.Redraw())}},{key:"getCardsNames",value:function(){var e=[];for(var t in this.cards)e.push(this.cards[t].name);return e}},{key:"getCards",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{visible:!0},t=[];for(var a in this.cards){var n=!0;for(var r in e)try{n=n&&this.cards[a][r]==e[r]}catch(e){}n&&t.push(this.cards[a])}return t}},{key:"cardsCount",value:function(e){return this.getCards(e).length}},{key:"getCardByIndex",value:function(e){return!!this.cards[e]&&this.cards[e]}},{key:"getCardIndexById",value:function(e){var t=!1;for(var a in this.cards)this.cards[a].id==e&&(t=a);return t}},{key:"getRelationsByName",value:function(e,t){var a=[];for(var n in this.relations)if(this.relations[n].name==e)if(t){var r=!0;for(var i in t)r=r&&this.relations[n][i]==t[i];r&&a.push(this.relations[n])}else a.push(this.relations[n]);return a}},{key:"hasTag",value:function(e){for(var t in this.tags)if(this.tags[t]==e)return!0;return!1}}]),e}()),G=function(e){if(!e)return!1;var t="deck_"+p.default.genId(),a=new z(e,t);if(e.fill)for(var n in e.fill)"string"==typeof e.fill[n]&&a.genCardByName(e.fill[n]);var r=l.default.get("elements");return r[t]=a,l.default.set("elements",r),a};t.default={deckCardNames:L.default,addDeck:G,getDeck:Y.default,getDecks:R.default,getDeckById:A.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={none:function(e,t){return!1},all:function(e,t){return!0},notlast:function(e,t){return e<t-1},bee:function(e,t){return e!=t-1&&e%2==0},beeFlip:function(e,t){return e==t-1||e%2!=0},_direction_type:function(e,t,a,n,r){return!!(r&&(0|r)>0)&&("top"==e?a>n-r-1?"flip"==t:"flip"!=t:a<r?"flip"==t:"flip"!=t)},bottomFlip:function(e,t,n){return a._direction_type("bootom","flip",e,t,n)},bottomUnflip:function(e,t,n){return a._direction_type("bootom","unflip",e,t,n)},topFlip:function(e,t,n){return a._direction_type("top","flip",e,t,n)},topUnflip:function(e,t,n){return a._direction_type("top","unflip",e,t,n)}};t.default=a},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),o=a(3),u=n(o),d=a(14),l=n(d),s=a(17),f=n(s),c={linePrev:function(e){var t=(0,f.default)(e.to).prev;return!!t&&(e.link=t.to,!0)},lineNext:function(e){var t=(0,f.default)(e.to).next;return!!t&&(e.link=t.to,!0)},_down_up_cards:function(e){if(0==e.cards.length)return!1;var t=i.default.validateCardName(e.cards[e.cards.length-1].name),a=i.default.validateCardName(e.putDeck[0].card.name);return!(!t||!a)&&{up:a,down:t}},_down_up_rank_num:function(e){var t=c._down_up_cards(e);return!!t&&{down:u.default.card.ranks.indexOf(t.down.rank),up:u.default.card.ranks.indexOf(t.up.rank)}},_isFirst:function(e,t){if(0==e.cards.length){var a=null;return(a=i.default.validateCardName(e.putDeck[0].card.name))&&a.rank==t}return!0},striped:function(e){if(0==e.cards.length)return!0;var t=i.default.validateCardName(e.cards[e.cards.length-1].name).color,a=null,n=null;return(n=i.default.validateCardName(e.putDeck[0].card.name))&&(a=n.color),t!=a},firstAce:function(e){return c._isFirst(e,u.default.card.ranks[0])},firstKing:function(e){return c._isFirst(e,u.default.card.ranks[u.default.card.ranks.length-1])},notForEmpty:function(e){return e.cards.length>0},onlyEmpty:function(e){return 0==e.cards.length},oneRank:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e);return t&&t.up.rank==t.down.rank},oneSuit:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e);return t&&t.up.suit==t.down.suit},any:function(e){return!0},not:function(e){return!1},ascendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[a-1].card.name).rank),r=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[a].card.name).rank);t=t&&1+n==r}return t},descendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[a-1].card.name).rank),r=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[a].card.name).rank);t=t&&n==1+r}return t},oneRankDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=i.default.validateCardName(e.putDeck[a-1].card.name).rank,r=i.default.validateCardName(e.putDeck[a].card.name).rank;t=t&&n==r}return t},oneSuitDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var a in e.putDeck)if(a>0){var n=i.default.validateCardName(e.putDeck[a-1].card.name).suit,r=i.default.validateCardName(e.putDeck[a].card.name).suit;t=t&&n==r}return t},ascend:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down<t.up},descent:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down>t.up},descentOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down==1+t.up},ascendOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&1+t.down==t.up},ascdescOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&1==Math.abs(t.down-t.up)},sum14:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e),a=t.down.value+t.up.value;return 14==a},around:function(e){if(0==e.cards.length)return!0;var t=e.from.deck.getRelationsByName("around",{from:null}),a=l.default.getDeckById(e.cards[0].parent);for(var n in t)if(t[n].to==a.name)return!0;return!1}};t.default=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.getRelationsByName("beside",{from:null,type:"prev"})[0],a=e.getRelationsByName("beside",{from:null,type:"next"})[0];return{prev:t,next:a}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={not:function(e){return!1},notFirst:function(e){return e.cardIndex>0},any:function(e){return!0},onlytop:function(e){return e.cardIndex==e.deckLength-1}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),o=a(5),u=n(o),d=a(13),l=n(d),s=a(14),f=n(s),c=a(9),p=(n(c),a(17)),v=n(p),h={_topCard:function(e){var t=e.getTopCard();return t&&u.default.validateCardName(t.name)},_bottomCard:function(e){var t=e.getCards()[0];return t&&u.default.validateCardName(t.name)},_besideTopCardRecoursive:function(e,t,a){for(var n=!0,r=e,i=(0,v.default)(r)[t];i&&n;){var o=f.default.getDeck(i.to);n=n&&a(h._topCard(e),h._topCard(o)),r=o,i=(0,v.default)(o)[t]}return n},_besideTopCard:function(e,t,a){var n=(0,v.default)(e)[t],r=f.default.getDeck(n.to);return a(h._topCard(e),h._topCard(r))},_deckRecoursive:function(e,t){for(var a=!0,n=e.getCards(),r=n.length,i=r;i>0;i-=1)a=a&&t(u.default.validateCardName(n[i].name),u.default.validateCardName(n[i-1].name));return a},query:function(e,t){var a=!0,n=[];if(t.groups)for(var r in t.groups){var i=t.groups[r],o=l.default.getByName(i),u=(o.getDecks(),t.select?t.select:"all");if("first"==u){var d=o.getDeckByIndex(1);n.push(d)}}if(t.decks)for(var s in t.decks){var c=t.decks[s],p=f.default.getDeck(c);p&&n.push(p)}for(var v in n){var y=n[v];for(var m in t.rules){var k=t.rules[m];h[k]&&(a=a&&h[k](y))}if(t.anyRule){var g=!1;for(var _ in t.anyRule){var b=t.anyRule[_];h[b]&&(g=g||h[b](y))}a=a&&g}}return a},deckLength:function(e){return i.default.card.ranks.length<=e.cards.length},not:function(e){return!1},topAce:function(e){var t=h._topCard(e);return t&&t.rank==i.default.card.ranks[0]},topKing:function(e){var t=h._topCard(e),a=i.default.card.ranks.length-1;return t&&t.rank==i.default.card.ranks[a]},bottomAce:function(e){var t=h._bottomCard(e);return t&&t.rank==i.default.card.ranks[0]},bottomKing:function(e){var t=h._bottomCard(e),a=i.default.card.ranks.length-1;return t&&t.rank==i.default.card.ranks[a]},prevDeckTopCardDescStep:function(e){return h._besideTopCard(e,"prev",function(e,t){return e.value==(0|t.value)+1})},prevDeckTopCardAscStep:function(e){return h._besideTopCard(e,"prev",function(e,t){return(0|e.value)+1==t.value})},nextDeckTopCardDescStep:function(e){return h._besideTopCard(e,"next",function(e,t){return e.value==(0|t.value)+1})},nextDeckTopCardAscStep:function(e){return h._besideTopCard(e,"next",function(e,t){return(0|e.value)+1==t.value})},prevDeckTopCardDesc:function(e){return h._besideTopCard(e,"prev",function(e,t){return e.value>t.value})},prevDeckTopCardAsc:function(e){return h._besideTopCard(e,"prev",function(e,t){return e.value<t.value})},nextDeckTopCardDesc:function(e){return h._besideTopCard(e,"next",function(e,t){return e.value>t.value})},nextDeckTopCardAsc:function(e){return h._besideTopCard(e,"next",function(e,t){return e.value<t.value})},recoursivePrevNotEmpty:function(e){return!1},recoursiveNextNotEmpty:function(e){return!1},recoursivePrevDeckTopCardDescStep:function(e){return h._besideTopCardRecoursive(e,"prev",function(e,t){return e.value==(0|t.value)+1})},recoursivePrevDeckTopCardAscStep:function(e){return h._besideTopCardRecoursive(e,"prev",function(e,t){return(0|e.value)+1==t.value})},recoursiveNextDeckTopCardDescStep:function(e){return h._besideTopCardRecoursive(e,"next",function(e,t){return e.value==(0|t.value)+1})},recoursiveNextDeckTopCardAscStep:function(e){return h._besideTopCardRecoursive(e,"next",function(e,t){return(0|e.value)+1==t.value})},recoursivePrevDeckTopCardDesc:function(e){return h._besideTopCardRecoursive(e,"prev",function(e,t){return e.value>t.value})},recoursivePrevDeckTopCardAsc:function(e){return h._besideTopCardRecoursive(e,"prev",function(e,t){return e.value<t.value})},recoursiveNextDeckTopCardDesc:function(e){return h._besideTopCardRecoursive(e,"next",function(e,t){return e.value>t.value})},recoursiveNextDeckTopCardAsc:function(e){return h._besideTopCardRecoursive(e,"next",function(e,t){return e.value<t.value})},descByStep:function(e){return h._deckRecoursive(e,function(e,t){return e.value==(0|t.value)+1})},ascByStep:function(e){return h._deckRecoursive(e,function(e,t){return(0|e.value)+1==t.value})},asc:function(e){return h._deckRecoursive(e,function(e,t){return e.value>t.value})},desc:function(e){return h._deckRecoursive(e,function(e,t){return e.value<t.value})},prevDeckTopCardEquallySuit:function(e){return h._besideTopCard(e,"prev",function(e,t){return e.suit==t.suit})},nextDeckTopCardEquallySuit:function(e){return!1},prevDeckFull:function(e){return f.default.getDeck((0,v.default)(e).prev.to).full},nextDeckFull:function(e){return f.default.getDeck((0,v.default)(e).next.to).full}};t.default=h},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(3),u=n(o),d=a(5),l=(n(d),{_default:function(e,t,a,n,r){for(var i=e.y,o=e.x,u=0;u<a;u+=1)i+=r[u]&&r[u].flip?e.flip_padding_y:e.padding_y,o+=r[u]&&r[u].flip?e.flip_padding_x:e.padding_x;return{x:o,y:i}},vertical:function(e,t,a,n,r){var i={};for(var o in e)i[o]=e[o];return i.padding_x=0,i.padding_y=10,i.flip_padding_x=0,i.flip_padding_y=5,l._default(i,t,a,n,r)},horizontal:function(e,t,a,n,r){var i={};for(var o in e)i[o]=e[o];return i.padding_x=10,i.padding_y=0,i.flip_padding_x=5,i.flip_padding_y=0,l._default(i,t,a,n,r)},roller:function(e,t,a,n,r,o){var d=o.split(","),l=0|d[0],s=(0|d[1])>0?0|d[1]:1,f=0|d[2],c=0;return a>=n-l&&0==t.flip?{x:e.x+u.default.card.width*i.default.get("zoom")+f+(a-n+l-c)*e.padding_x,y:e.y+(a-n+l)*e.padding_y}:(a>=n-l&&(c+=1),{x:e.x+e.flip_padding_x*(a/s|0),y:e.y+e.flip_padding_y*(a/s|0)})}});t.default=l},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(1),u=n(o),d=a(3),l=(n(d),a(5)),s=n(l),f=a(22),c=n(f),p=a(25),v=n(p),h=a(26),y=n(h),m=a(27),k=n(m),g=a(28),_=n(g),b=a(30),x=n(b),w=a(31),C=n(w),D=a(32),O=n(D),T={dealerdeck:c.default,kick:v.default,stepsAround:y.default,changeStepType:k.default,lock:_.default,unlock:x.default,checkFull:C.default,roller:O.default},P=[],M=[];i.default.listen("initField",function(e){P=[],M=[]});var I=function(e){i.default.listen(e,function(t){for(var a in P)if(P[a].event==e){var n=P[a].action,r=0!=e.indexOf("click")||t.to.name==P[a].deck.name;r&&T[n].run(P[a].deck,{actionData:P[a].deck.actions[n],eventData:t,eventName:e})}},"addActionEvent:"+e)},j=function(e){for(var t in e.actions)if(void 0!==T[t]){e.actions[t].events||("string"==typeof e.actions[t].event?e.actions[t].events=[e.actions[t].event]:e.actions[t].events=["click"]);for(var a in e.actions[t].events){var n=e.actions[t].events[a];P.push({deck:e,event:n,action:t}),u.default.set("actionEvent:"+e.name+":"+n,!0),!M.indexOf(n)>=0&&(M.push(n),I(n))}}S(e)},S=function(e){s.default.animationDefault();for(var t in e.actions)e.actions[t].autorun&&T[t]&&T[t].run(e,{actionData:e.actions[t],eventData:null,eventName:e.actions[t].event})};t.default={add:j}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=n(l),f=a(1),c=n(f),p=a(3),v=n(p),h=a(5),y=n(h),m=a(23),k=n(m),g=a(24),_=n(g),b="dealerdeckStepType",x=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){var n="boolean"!=typeof a.eventData.save||a.eventData.save;if("string"==typeof a.actionData.stepType&&a.actionData.stepType!=c.default.get("stepType"))return void d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this);c.default.set("stepType",b);var r="string"==typeof a.actionData.from?Deck.getDeck(a.actionData.from):e;if(0==r.cards.length)return c.default.set("stepType",v.default.stepType),s.default.dispatch("actionBreak"),void this.end();var i=[];if(a.actionData.toGroup&&!a.actionData.to&&(a.actionData.to=a.actionData.toGroup),a.actionData.to)if("string"==typeof a.actionData.to){var o=y.default.getElementsByName(a.actionData.to);for(var u in o){if("group"==o[u].type)for(var l in o[u].decks)i.push(o[u].decks[l]);"deck"==o[u].type&&i.push(_el)}}else for(var f in a.actionData.to){var p=y.default.getElementsByName(a.actionData.to[f]);for(var h in p){if("group"==p[h].type)for(var m in p[h].decks)i.push(p[h].decks[m]);"deck"==p[h].type&&i.push(p[h])}}y.default.animationDefault();var g=!1;for(var _ in i){var x=r.getTopCard(),w=!a.actionData.onlyEmpty||0==i[_].cards.length;w&&x&&!function(){g=!0;var e=x.name,t=!1,n=function(e){t||s.default.dispatch("checkTips")};s.default.once("clearCallbacks",function(e){t=!0}),(0,k.default)({from:r.name,to:i[_].name,deck:[e],flip:!0,callback:n},!0),i[_].flipCheck(),s.default.dispatch("dealEnd"),s.default.dispatch("addStep",{move:{from:r.name,to:i[_].name,deck:[e],flip:!0,stepType:{undo:c.default.get("stepType"),redo:a.actionData.dispatch?c.default.get("stepType"):v.default.stepType},context:"dealerdeckAction"}})}()}g&&n&&s.default.dispatch("saveSteps","DEALERDECKACTION"),a.actionData.dispatch?s.default.dispatch(a.actionData.dispatch,!g):(this.end(),c.default.set("stepType",v.default.stepType))}},{key:"end",value:function(){s.default.dispatch("dealEnd"),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(_.default);t.default=new x},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(1),u=(n(o),a(5)),d=(n(u),a(14)),l=n(d),s=a(9),f=(n(s),function(e){if(e.from&&e.to&&e.deck&&e.deck.length){var t="string"==typeof e.from?l.default.getDeck(e.from):e.from,a="string"==typeof e.to?l.default.getDeck(e.to):e.to;if(t&&"deck"==t.type&&a&&"deck"==a.type){var n=!0,r=t.getCards();for(var o in r)if(o>=r.length-e.deck.length){var u=o-(0|r.length)+(0|e.deck.length);e.deck[u]&&r[o].name!=e.deck[u]&&(n=!1)}if(n){var d=t.Pop(e.deck.length);if("boolean"==typeof e.flip)for(var s in d)d[s].flip=e.flip;var f=a.cardsCount({visible:!1});a.Push(d,f>0);var c=[];for(var p in d)c.push({card:d[p]});var v={moveDeck:c,departure:t,destination:a};"function"==typeof e.callback?(v.callback=function(t){i.default.dispatch("forceMoveEnd"),e.callback()},v.debug="from:forceMove"):v.callback=function(e){i.default.dispatch("forceMoveEnd")},i.default.dispatch("moveDragDeck",v),e.addStep&&i.default.dispatch("addStep",{move:{from:e.from,to:e.to,deck:e.deck}}),t.autoUnflipTop&&t.cards.length>0&&t.cards[t.cards.length-1].flip&&t.unflipTopCard(e.addStep),e.save&&i.default.dispatch("saveSteps")}}}});i.default.listen("forceMove",function(e){f(e)}),t.default=f},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=n(o),d=function(){function e(){r(this,e)}return i(e,[{key:"run",value:function(){}},{key:"end",value:function(){u.default.dispatch("stopSession")}},{key:"break",value:function(){}}]),e}();t.default=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=n(l),f=a(1),c=n(f),p=a(5),v=n(p),h=a(3),y=n(h),m=a(24),k=n(m),g="kickStepType",_=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._actionName="kickAction",e}return o(t,e),u(t,[{key:"run",value:function(e,a){var n=this;if(c.default.get("stepType")!=y.default.stepType)return d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;if("string"==typeof a.eventData.stepType&&a.eventData.stepType!=y.default.stepType)return d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;if(a.eventData.to.name!=e.name)return d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;c.default.set("stepType",g),v.default.animationDefault();var r=a.eventData.to,i=r.getCardsNames(),o=function(e){var o=function(e){s.default.dispatch("addStep",{move:{from:r.name,to:a.actionData.to,deck:i,flip:!0,stepType:{undo:e.undo,redo:e.redo},context:"kickAction"}})};c.default.set("stepType",y.default.stepType),a.actionData.dispatch?(s.default.dispatch("kick:end"),s.default.dispatch(a.actionData.dispatch,{before:function(e){o({undo:g,redo:e.stepType}),s.default.dispatch("saveSteps","KICKACTION#1")}})):(s.default.dispatch("kick:end"),o({undo:g,redo:a.actionData.dispatch?c.default.get("stepType"):y.default.stepType}),s.default.dispatch("saveSteps","KICKACTION#2"),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",n).call(n))},u={from:r,to:a.actionData.to,deck:i,flip:!0,callback:o};s.default.dispatch("forceMove",u)}}]),t}(k.default);t.default=new _},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=n(l),f=a(1),c=n(f),p=a(5),v=n(p),h=a(3),y=n(h),m=a(24),k=n(m),g=a(9),_=n(g),b=a(14),x=(n(b),"stepsAround"),w=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){var n=this,r=c.default.get("stepType");if(r!=y.default.stepType)return void d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this);c.default.set("stepType",x),v.default.curLock();var i=e.getRelationsByName("around",{from:null});if("string"==typeof a.actionData.run)!function(){var t="boolean"!=typeof a.actionData.central||a.actionData.central,r=[];for(var o in i)_.default.fromTo(e.name,i[o].to)&&r.push(i[o]);var u=r.length,d=function(e){u-=1,0===u&&n.end()};0===u?n.end():t&&(u+=1,s.default.dispatch(a.actionData.run,{to:e.name,callback:d}));for(var l in r){var f=null;try{f=Object.assign({},r[l])}catch(e){f=r[l]}f.callback=d,s.default.dispatch(a.actionData.run,f)}}();else{var o=function(e){c.default.get("stepType")==x&&n.end()};s.default.listen("makeStep",o)}}},{key:"end",value:function(){c.default.set("stepType",y.default.stepType),v.default.curUnLock(),data.actionData.dispatch&&s.default.dispatch(data.actionData.dispatch,data.eventData),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(k.default);t.default=new w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=(n(l),a(1)),f=n(s),c=a(3),p=(n(c),a(5)),v=(n(p),a(24)),h=n(v),y=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){return a.eventData.to.name==e.name&&("string"!=typeof a.actionData.to?void d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this):(d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this),void f.default.set("stepType",a.actionData.to)))}}]),t}(h.default);t.default=new y},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{
value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=(n(l),a(1)),f=(n(s),a(3)),c=(n(f),a(5)),p=(n(c),a(24)),v=n(p),h=a(29),y=n(h),m=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){return a.eventData.to.name==e.name&&((0,y.default)(a.actionData,"lock",e.name),void d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this))}}]),t}(v.default);t.default=new m},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(1),u=(n(o),a(3)),d=(n(u),a(5)),l=n(d);t.default=function(e,t,a){var n=[];if("string"!=typeof e.source)if(e.source&&e.source.constructor==Array)for(var r in e.source)n.push(e.source[r]);else n=[a];else n=[e.source];if(e.save){var o={};o[t]=n,i.default.dispatch("addStep",o),i.default.dispatch("saveSteps","LOCKACTIONCOMMON")}for(var u in n){var d=l.default.getElementsByName(n[u])[0];if("group"==d.type){var s=d.getDecks();for(var f in s)s[f][t]()}"deck"==d.type&&d[t]()}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=(n(l),a(1)),f=(n(s),a(3)),c=(n(f),a(5)),p=(n(c),a(24)),v=n(p),h=a(29),y=n(h),m=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){return a.eventData.to.name==e.name&&((0,y.default)(a.actionData,"unlock",e.name),void d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this))}}]),t}(v.default);t.default=new m},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=n(l),f=a(13),c=n(f),p=a(24),v=n(p),h=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){if(a.eventData.to.name!=e.name&&!a.actionData.any)return!1;if(a&&a.actionData&&a.actionData.query){var n=a.actionData.query,r=[];if(n.groups){var i=n.select?n.select:"all";for(var o in n.groups){var u=n.groups[o],l=c.default.getByName(u);if("first"==i){var f=l.getDeckByIndex(1);f&&r.push(f)}else if("last"==i){var p=l.decksCount,v=l.getDeckByIndex(p);if(v){var h=l.decksCount,y=l.getDeckByIndex(h);r.push(y)}}else if("all"==i){var m=l.getDecks();r=r.concat(m)}}}if(n.decks)for(var k in n.decks){var g=n.decks[k],_=Deck.getByName(g);_&&r.push(_)}for(var b in r){var x=r[b];x.checkFull()&&x.Redraw()}}s.default.dispatch("saveSteps","CHECKFULLACTION"),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(v.default);t.default=new h},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(2),s=n(l),f=a(24),c=n(f),p=a(14),v=(n(p),a(33)),h=(n(v),a(35)),y=n(h),m=3,k=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,a){if(a.eventName.indexOf("moveEnd")>=0){if(a.eventData.from.name!=e.name)return;var n=e.cardsCount({visible:!0,flip:!1}),r=e.cardsCount({visible:!1});if(0==n&&r>0){var i=e.cards.length-r;e.showCardByIndex(i,!0),s.default.dispatch("addStep",{show:{cardIndex:i,cardName:e.cards[i].name,deckName:e.name}}),s.default.dispatch("checkTips")}}else{if(a.eventData.to.name!=e.name)return!1;var o=a.actionData.openCount?a.actionData.openCount:m,u=e.cardsCount({visible:!1}),l=e.cardsCount({visible:!0});if(l>0){var f=e.cardsCount({visible:!0,flip:!1}),c=e.cardsCount({visible:!0,flip:!0});0==u&&0==f&&s.default.dispatch("addStep",{rollerActionStart:e.name});var p=0;if(f>0){var v=e.getCards();for(var h in v)0==v[h].flip&&(p+=1,e.hideCardByIndex(h),s.default.dispatch("addStep",{hide:{cardIndex:h,cardName:e.cards[h].name,deckName:e.name}}))}if(o>1)for(var k=l-p;k<l;k+=1){var g=2*l-k-p-1;k<g&&y.default.swap(e,k,g,!0)}p=0;for(var _=c-1;_>=0&&_>=c-o;_-=1)p+=1,e.cards[_].flip=!1,s.default.dispatch("addStep",{unflip:{cardIndex:_,cardName:e.cards[_].name,deckName:e.name}});if(l=e.cardsCount({visible:!0}),o>1)for(var b=l-p;b<l;b+=1){var x=2*l-b-p-1;b<x&&y.default.swap(e,b,x,!0)}0==l?(u=e.cardsCount({visible:!1}),s.default.dispatch("rewindHistory",function(t){for(var a=!1,n=0,r=t.history.length-1;r>=0&&!a;r-=1){n+=1;var i=t.history[r];for(var o in i){var u=i[o];if(a||"string"!=typeof u.rollerActionStart||u.rollerActionStart!=e.name)!a&&u.move&&(a=!0,e.showCards(!1,!0),e.flipAllCards(!1,!0),s.default.dispatch("saveSteps"));else{a=!0,s.default.dispatch("resetHistory");for(var d=0;d<n;d+=1)t.undo();e.showCards(!1),e.flipAllCards(!1)}}}})):s.default.dispatch("saveSteps")}else if(u=e.cardsCount({visible:!1}),u>0)return e.showCards(!1,!0),e.flipAllCards(!1,!0),void this.run(e,a);e.Redraw(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this),s.default.dispatch("checkTips")}}}]),t}(c.default);t.default=new k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=n(o),d=a(1),l=(n(d),a(5)),s=(n(l),a(3)),f=(n(s),a(34)),c=(n(f),a(37)),p=(n(c),function(){function e(){r(this,e),this.steps=[]}return i(e,[{key:"reset",value:function(){this.steps=[]}},{key:"add",value:function(e){this.steps.push(e)}},{key:"get",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.steps;return e&&this.reset(!0),t}},{key:"count",value:function(){return this.steps.length}},{key:"zip",value:function(){}},{key:"unzip",value:function(e){}}]),e}()),v=new p;u.default.listen("addStep",function(e){e.debug&&delete e.debug,v.add(e)}),u.default.listen("saveSteps",function(e){var t=v.get();t.length&&u.default.dispatch("makeStep",t)}),u.default.listen("doHistory",function(e){for(var t in e.data)u.default.dispatch("redo",e.data[t]),"function"==typeof e.callback&&e.callback(e.data[t])}),u.default.listen("resetHistory",function(e){v.reset()}),u.default.listen("newGame",function(e){v.reset()}),t.default=v},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(5),l=n(d),s=a(3),f=(n(s),a(4)),c=n(f),p=a(33),v=n(p),h=a(9),y=n(h),m=a(35),k=n(m),g=a(6),_=n(g),b=function(e){if(u.default.get("sessionStarted")&&(i.default.dispatch("stopAnimations"),_.default.restore()),e.flip){var t=l.default.getElementByName(e.flip.deckName),a=t.getCardByIndex(0|e.flip.cardIndex);a&&a.name==e.flip.cardName&&(a.flip=!1,t.Redraw())}if(e.unflip){var n=l.default.getElementByName(e.unflip.deckName,"deck"),r=n.getCardByIndex(0|e.unflip.cardIndex);i.default.dispatch("removeMarkCard",{card:r}),r&&r.name==e.unflip.cardName&&(r.flip=!0,n.Redraw())}if(e.hide){var o=l.default.getElementByName(e.hide.deckName,"deck");o&&o.cards[e.hide.cardIndex].name==e.hide.cardName&&(o.cards[e.hide.cardIndex].visible=!0,o.Redraw())}if(e.show){var d=l.default.getElementByName(e.show.deckName,"deck");d&&d.cards[e.show.cardIndex].name==e.show.cardName&&(d.cards[e.show.cardIndex].visible=!1,d.Redraw()),d.Redraw()}if(e.full,void 0!==e.lock)for(var s in e.lock){var f=l.default.getElementsByName(e.lock[s])[0];f.unlock()}if(void 0!==e.unlock)for(var c in e.unlock){var p=l.default.getElementsByName(e.unlock[c])[0];p.lock()}if(void 0!==e.swap&&void 0!==e.swap.deckName&&void 0!==e.swap.fromIndex&&void 0!==e.swap.toIndex){var v=l.default.getElementByName(e.swap.deckName,"deck");k.default.swap(v,e.swap.fromIndex,e.swap.toIndex,!1),v.Redraw()}if(void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck){e.move.stepType&&("string"==typeof e.move.stepType&&u.default.set("stepType",e.move.stepType),"string"==typeof e.move.stepType.undo&&u.default.set("stepType",e.move.stepType.undo));var h={from:e.move.to,to:e.move.from,deck:e.move.deck};"boolean"==typeof e.move.flip&&(h.flip=!e.move.flip),u.default.get("showHistoryAnimation")||(l.default.animationOff(),h.callback=function(e){l.default.animationOn()}),i.default.dispatch("forceMove",h)}};i.default.listen("undo",function(e){if(e){if(c.default.break(),v.default.reset(),u.default.get("animation")&&i.default.dispatch("stopAnimations"),e instanceof Array){e.reverse();for(var t in e){var a=e[t];b(a)}e.reverse()}else b(e);y.default.checkTips()}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(36),i=n(r);t.default={swap:i.default}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r);t.default=function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=e.cards[t];e.cards[t]=e.cards[a],e.cards[a]=r,n&&i.default.dispatch("addStep",{swap:{deckName:e.name,fromIndex:t,toIndex:a}})}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(5),l=n(d),s=a(3),f=(n(s),a(4)),c=n(f),p=a(33),v=n(p),h=a(9),y=n(h),m=a(35),k=n(m),g=a(6),_=n(g),b=function(e){if(u.default.get("sessionStarted")&&(i.default.dispatch("stopAnimations"),_.default.restore()),e.flip){var t=l.default.getElementByName(e.flip.deckName),a=t.getCardByIndex(0|e.flip.cardIndex);a&&a.name==e.flip.cardName&&(a.flip=!0,t.Redraw())}if(e.unflip){var n=l.default.getElementByName(e.unflip.deckName,"deck"),r=n.getCardByIndex(0|e.unflip.cardIndex);r&&r.name==e.unflip.cardName&&(r.flip=!1,n.Redraw())}if(e.hide){var o=l.default.getElementByName(e.hide.deckName,"deck");o&&o.cards[e.hide.cardIndex].name==e.hide.cardName&&(o.cards[e.hide.cardIndex].visible=!1,o.Redraw())}if(e.show){var d=l.default.getElementByName(e.show.deckName,"deck");d&&d.cards[e.show.cardIndex].name==e.show.cardName&&(d.cards[e.show.cardIndex].visible=!0,d.Redraw())}if(e.full,void 0!==e.lock)for(var s in e.lock){var f=l.default.getElementsByName(e.lock[s])[0];f.lock()}if(void 0!==e.unlock)for(var c in e.unlock){var p=l.default.getElementsByName(e.unlock[c])[0];p.unlock()}if(void 0!==e.swap&&void 0!==e.swap.deckName&&void 0!==e.swap.fromIndex&&void 0!==e.swap.toIndex){var v=l.default.getElementByName(e.swap.deckName,"deck");k.default.swap(v,e.swap.fromIndex,e.swap.toIndex,!1),v.Redraw()}if(void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck){e.move.stepType&&("string"==typeof e.move.stepType&&u.default.set("stepType",e.move.stepType),"string"==typeof e.move.stepType.redo&&u.default.set("stepType",e.move.stepType.redo));var h={from:e.move.from,to:e.move.to,deck:e.move.deck,flip:e.move.flip};"boolean"==typeof e.move.flip&&(h.flip=e.move.flip),u.default.get("showHistoryAnimation")||(l.default.animationOff(),h.callback=function(e){l.default.animationOn()}),i.default.dispatch("forceMove",h)}if(e.markCard){var y=l.default.getElementByName(e.markCard.deckName,"deck"),m=y.getCardByIndex(0|e.markCard.cardIndex);m&&e.markCard.cardName==m.name&&i.default.dispatch("markCard",{card:m})}if(e.unmarkCard){var g=l.default.getElementByName(e.unmarkCard.deckName,"deck"),b=g.getCardByIndex(0|e.unmarkCard.cardIndex);b&&e.unmarkCard.cardName==b.name&&i.default.dispatch("unmarkCard",{card:b})}};i.default.listen("redo",function(e){if(e){if(c.default.break(),v.default.reset(),u.default.get("animation")&&i.default.dispatch("stopAnimations"),e instanceof Array)for(var t in e){var a=e[t];b(a)}else b(e);y.default.checkTips()}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=(n(r),a(3)),o=n(i),u=a(5),d=n(u),l=a(18),s=n(l);t.default=function(e,t){var a=!0;//!common.isLock();
a=a&&!e.locked,"boolean"==typeof e.full&&(a=a&&!e.full);var n=-1,r=null,i=null,u=null,l=e.cardsCount(),f=[],c=e.getCards();for(var p in c){if(c[p].id==t){n=0|p,r=c[p].name;var v=d.default.validateCardName(r);a=a&&v,v&&(i=v.suit,u=v.rank),a=a&&!c[p].flip&&c[p].flip==o.default.canMoveFlip}n>=0&&f.push({index:p,card:c[p]})}var h={cardId:t,cardName:r,cardSuit:i,cardRank:u,cardIndex:n,deckLength:l};for(var y in e.takeRules){var m=e.takeRules[y];a=!!s.default[m]&&(a&&s.default[m](h))}return a=a&&n>=0,a=a&&f}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(3),u=n(o),d=a(12),l=n(d),s=a(14),f=n(s),c=a(16),p=n(c);t.default=function(e,t){var a=i.default.get("stepType"),n=!0,r=t[0].card.parent,o=f.default.getDeckById(r);if(n=n&&!e.locked,a!=u.default.stepType)n=!!(n&&l.default.autoSteps&&l.default.autoSteps[a])&&l.default.autoSteps[a].manual({putDeck:t,to:e});else{var d=e;for(var s in e.putRules)if(n){var c=e.putRules[s];if(p.default[c]){var v={from:{deckId:r,deck:o},putDeck:t,cards:d.cards,to:d};n=n&&p.default[c](v)}else n=!1}}return n}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(1),u=n(o),d=a(5),l=n(d);t.default=function(e,t){var a=l.default.validateCardName(t);if(a){var n="card_"+l.default.genId(),r={id:n,name:t,type:"card",visible:!0,flip:!1,parent:e.id};i.default.dispatch("addCardEl",r);var o=u.default.get("elements");return o[n]=r,u.default.set("elements",o),e.Push([r]),e.flipCheck(),e.Redraw(),r}return!1}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[];for(var a in e)e[a].card&&e[a].card.name?t.push(e[a].card.name):e[a].name&&t.push(e[a].name);return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r);t.default=function(e,t){var a=i.default.getElementsByName(e,"deck");if(t&&"string"==typeof t){for(var n in a){var r=i.default.getElementById(a[n].parent());if(r&&r.name&&r.name==t)return a[n]}return!1}return a[0]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=[],n=0;for(var r in e.decks)n+=1,a.push(null);for(var i in e.decks)e.decks[i].groupIndex&&e.decks[i].groupIndex<=n&&(a[e.decks[i].groupIndex-1]=!0);for(var o in e.decks)if(!e.decks[o].groupIndex){for(var u=0;null!=a[u];u+=1);a[u]=e.decks[o].id}for(var d in e.decks)e.decks[d].groupIndex&&e.decks[d].groupIndex<=n&&(a[e.decks[d].groupIndex-1]=e.decks[d].id);var l={};for(var s in e.decks)e.decks[s].groupIndex&&e.decks[s].groupIndex>n&&(l[e.decks[s].groupIndex-1]=e.decks[s].id);for(var f in l){for(var c=0;null!=a[c];c+=1);a[c]=e.decks[l[f]].id}var p=!0;for(var v in t)p=p&&"string"==typeof t[v];if(p)for(var h in t){var y=a[h%a.length];e.decks[y].genCardByName(t[h])}else for(var m in t)m<a.length&&e.decks[a[m]].Fill(t[m])}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r);t.default=function(e,t){if(e&&t){var a=e.getDecks();void 0!==t.decks&&"number"!=typeof t.decks||(t.decks=[]);for(var n in a)t.decks[n]||(t.decks[n]={}),t.position&&t.decks[n].parentPosition&&(t.decks[n].parentPosition={x:t.position.x,y:t.position.y}),"number"==typeof t.paddingX&&(t.decks[n].paddingX=t.paddingX),"number"==typeof t.paddingY&&(t.decks[n].paddingY=t.paddingY),"number"==typeof t.flipPaddingX&&(t.decks[n].flipPaddingX=t.flipPaddingX),"number"==typeof t.flipPaddingY&&(t.decks[n].flipPaddingY=t.flipPaddingY),void 0===t.decks[n].position&&(t.decks[n].position={}),t.decks[n].parentPosition={},"number"==typeof t.rotate&&(t.decks[n].parentRotate=t.rotate),t.position&&"number"==typeof t.position.x&&(t.decks[n].parentPosition.x=t.position.x),t.position&&"number"==typeof t.position.y&&(t.decks[n].parentPosition.y=t.position.y),t.placement&&(t.placement.x&&(t.decks[n].position.x=(t.placement.x+i.default.card.width)*n),t.placement.y&&(t.decks[n].position.y=(t.placement.y+i.default.card.height)*n)),!t.decks[n].rotate&&t.rotate&&"number"==typeof t.rotate&&(t.decks[n].rotate=t.rotate),!t.decks[n].paddingX&&t.paddingX&&"number"==typeof t.paddingX&&(t.decks[n].paddingX=t.paddingX),!t.decks[n].paddingY&&t.paddingY&&"number"==typeof t.paddingY&&(t.decks[n].paddingY=t.paddingY),!t.decks[n].flipPaddingX&&t.flipPaddingX&&"number"==typeof t.flipPaddingX&&(t.decks[n].flipPaddingX=t.flipPaddingX),!t.decks[n].flipPaddingY&&t.flipPaddingY&&"number"==typeof t.flipPaddingY&&(t.decks[n].flipPaddingY=t.flipPaddingY),a[n].Redraw(t.decks[n])}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(46),i=n(r),o=a(47),u=n(o),d=a(48),l=n(d),s=a(55),f=n(s),c=a(56),p=n(c);t.default={count:i.default,fan:u.default,map:l.default,line:f.default,rhombus:p.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var a=t.count,n=[],r=0;r<a;r+=1){var i=e.name+"_deck"+(r+1);n.push({name:i})}return n}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r);t.default=function(e,t){e.placement={x:0,y:0};for(var a=[],n="number"==typeof t.count?t.count:3,r="number"==typeof t.radius?t.radius:100,o=180/n,u=o/2+270,d=Math.PI/180,l=void 0!==t.center&&void 0!==t.center.x&&void 0!==t.center.y?t.center:{x:0,y:0},s=0;s<n;s+=1){var f=Math.sin(u*d)*r,c=Math.cos(u*d)*r;u>360&&(u-=360),a.push({name:e.name+"_deck"+s,rotate:u,position:{x:l.x+f-i.default.card.width/2,y:l.y-c-i.default.card.height/2}}),u+=o}return a}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),o=a(49),u=n(o),d=a(51),l=n(d);t.default=function(e,t){var a=[],n={x:0,y:0},r=e.placement?{x:void 0!==e.placement.x?e.placement.x:n.x,y:void 0!==e.placement.y?e.placement.y:n.y}:n;e.placement={x:0,y:0};var o=1,d=l.default.mapSize(t.map);for(var s in t.map)for(var f in t.map[s])("boolean"==typeof t.map[s][f]&&t.map[s][f]||"number"==typeof t.map[s][f]&&t.map[s][f]>0)&&(t.map[s][f]={}),"string"==typeof t.map[s][f]?t.map[s][f]={name:t.map[s][f]}:t.map[s][f]&&void 0!==t.map[s][f]&&"string"!=typeof t.map[s][f].name&&(t.map[s][f].name=e.name+"_deck_"+f+"_"+s);for(var c in t.map)for(var p in t.map[c]){var v=0|p,h=0|c,y=t.map[h][v];if(y){var m={name:t.map[h][v].name,position:{x:v*((0|i.default.card.width)+(0|r.x)),y:h*((0|i.default.card.height)+(0|r.y))}},k=[],g={around:"mapAroundRelations",beside:"mapBesideRelations",fall:"mapFallRelations"};if(t.relations)for(var _ in g)t.relations[_]&&(k=k.concat(u.default[g[_]]({x:v,y:h,map:t.map,mapSize:d,el:y,data:t.relations[_]})));m.relations=k,a.push(m),o+=1}}return a}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(50),i=n(r),o=a(52),u=n(o),d=a(53),l=n(d),s=a(54),f=n(s);t.default={mapFallRelations:i.default,mapAroundRelations:u.default,mapBesideRelations:l.default,lineBesideRelations:f.default}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(51),i=n(r),o=[{left:"right"},{right:"left"},{up:"down"},{down:"up"}];t.default=function(e){var t=[],a=[];for(var n in e.data.directions)!a.indexOf(e.data.directions[n])>=0&&!a.indexOf(o[e.data.directions[n]])>=0&&a.push(e.data.directions[n]);for(var r in a){var u=null,d=null;switch(a[r]){case"left":u=(0|e.x)+i.default.beSide.left.x,d=(0|e.y)+i.default.beSide.left.y,i.default.exist(u,d,e.mapSize,e.map)&&t.push({name:"fall",direction:"left",to:e.map[d][u].name});break;case"right":u=(0|e.x)+i.default.beSide.right.x,d=(0|e.y)+i.default.beSide.right.y,i.default.exist(u,d,e.mapSize,e.map)&&t.push({name:"fall",direction:"right",to:e.map[d][u].name});break;case"up":u=(0|e.x)+i.default.beSide.up.x,d=(0|e.y)+i.default.beSide.up.y,i.default.exist(u,d,e.mapSize,e.map)&&t.push({name:"fall",direction:"up",to:e.map[d][u].name});break;case"down":u=(0|e.x)+i.default.beSide.down.x,d=(0|e.y)+i.default.beSide.down.y,i.default.exist(u,d,e.mapSize,e.map)&&t.push({name:"fall",direction:"down",to:e.map[d][u].name})}}return t}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1},down:{x:0,y:1}},n=function(e,t,a){return e>=0&&t>=0&&e<a.width&&t<a.height},r=function(e,t,a,r){return n(e,t,a)&&r[t][e]},i=function(e){var t={width:e[0].length,height:e.length};return e.forEach(function(e){t.width=Math.max(t.width,e.length)}),t},o=[{x:-1,y:-1,type:"corn",id:"clt"},{x:0,y:-1,type:"side",id:"top"},{x:1,y:-1,type:"corn",id:"crt"},{x:-1,y:0,type:"side",id:"lft"},{x:1,y:0,type:"side",id:"rgt"},{x:-1,y:1,type:"corn",id:"clb"},{x:0,y:1,type:"side",id:"btm"},{x:1,y:1,type:"corn",id:"crb"}];t.default={beSide:a,mapSize:i,inMap:n,aroundRelations:o,exist:r}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(51),i=n(r);t.default=function(e){var t=[];for(var a in i.default.aroundRelations)i.default.inMap(e.x+i.default.aroundRelations[a].x,e.y+i.default.aroundRelations[a].y,e.mapSize)&&e.map[e.y+i.default.aroundRelations[a].y][e.x+i.default.aroundRelations[a].x]&&t.push({to:e.map[e.y+i.default.aroundRelations[a].y][e.x+i.default.aroundRelations[a].x].name,type:i.default.aroundRelations[a].type,id:i.default.aroundRelations[a].id,name:"around"});return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(51);n(r);t.default=function(e){var t=[];return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(51);n(r);t.default=function(e){var t=[],a=e.deckIndex>0?e.decks[(0|e.deckIndex)-1].name:null;a&&t.push({name:"beside",type:"prev",to:a});var n=e.deckIndex<e.count-1?e.decks[(0|e.deckIndex)+1].name:null;return n&&t.push({name:"beside",type:"next",to:n}),t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(49),i=n(r);t.default=function(e,t){for(var a=t.count,n=[],r=0;r<a;r+=1){var o=e.name+"_deck"+(r+1),u={name:o};n.push(u)}if(n[0].tags.push("first"),t.first){var d=n[0];for(var l in t.first)d[l]=t.first[l]}if(n[1]&&n[1].tags.push("second"),n[n.length-1].tags.push("last"),t.last){var s=n[n.length-1];for(var f in t.last)s[f]=t.last[f]}for(var c in n){var p=[],v={beside:"lineBesideRelations"};if(t.relations)for(var h in v)t.relations[h]&&(p=p.concat(i.default[v[h]]({deckIndex:c,count:a,decks:n,data:t.relations[h]})));n[c].relations=p}return n}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(58),i=n(r),o={fallAutoStep:i.default};t.default=function(e){var t={};for(var a in e)if(o[a]){var n=new o[a](e[a]);n.init(a),t[a]=n}return t}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=a(1),s=(n(l),a(3)),f=(n(s),a(2)),c=(n(f),a(59)),p=n(c),v=a(14),h=n(v),y=a(9),m=n(y),k=function(e){function t(e){r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._name="fall",a.manualPossibleMoves=0,a}return o(t,e),u(t,[{key:"check",value:function(){m.default.checkTips();var e=m.default.getTips();0==e.length&&this.end()}},{key:"auto",value:function(){}},{key:"manual",value:function(e){var t=h.default.getDeckById(e.putDeck[0].card.parent),a=e.to,n=t.getRelationsByName("fall",{from:null});for(var r in n)if(n[r].to==a.name&&0===a.cardsCount())return this.manualPossibleMoves+=1,!0;return!1}},{key:"end",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this,{save:this.manualPossibleMoves>0})}}]),t}(p.default);t.default=k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=n(o),d=a(1),l=n(d),s=a(5),f=n(s),c=a(3),p=n(c),v=function(){function e(t){r(this,e),void 0!==t.groups&&(this.groups=t.groups),"string"==typeof t.event&&(this.event=t.event),"string"==typeof t.dispatch&&(this.dispatch=t.dispatch),"boolean"==typeof t.autoStep&&(this.autoStep=t.autoStep)}return i(e,[{key:"start",value:function(e){this.autoStep||u.default.dispatch("stopSession"),l.default.set("autoStep:stepType",this.stepType),e&&"function"==typeof e.before&&e.before({stepType:this.stepType}),l.default.set("stepType",this.stepType),this.autoStep?(f.default.curLock(),this.auto()):this.check()}},{key:"end",value:function(e){if(l.default.set("stepType",p.default.stepType),this.dispatch){var t={stepType:l.default.get("stepType")};if(e)for(var a in e)t[a]=e[a];u.default.dispatch(this.dispatch,t)}else u.default.dispatch("stopSession");l.default.delete("autoStep:stepType")}},{key:"init",value:function(e){var t=this;this.stepType=e,this.event&&u.default.listen(this.event,function(e){t.start(e)}),this.autoStep||u.default.listen("moveEnd",function(e){l.default.get("stepType")==t.stepType&&t.check()},"addAutoStepEvent:"+this.event)}}]),e}();t.default=v},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e);try{localStorage.hasOwnProperty("SolitaireEngine")||(localStorage.SolitaireEngine="{}")}catch(e){}}return n(e,[{key:"set",value:function(e,t){try{var a=JSON.parse(localStorage.SolitaireEngine);a[e]=t;var n=JSON.stringify(a);localStorage.SolitaireEngine=n}catch(e){}}},{key:"get",value:function(e){try{var t=JSON.parse(localStorage.SolitaireEngine);return t[e]}catch(e){return null}}},{key:"clear",value:function(){try{localStorage.SolitaireEngine="{}"}catch(e){}}}]),e}();t.default=new r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3);n(r);t.default=function(e){var t=a(62);try{var n=document.getElementById("gpCommit"),r=document.createElement("div");r.innerHTML=t,n.parentNode.insertBefore(r,n)}catch(e){}}},function(e,t){e.exports="<div id=solitaire-engine-style-preferences> <h4>Настройки оформления</h4> <div> <span class=solitaire-engine-style-preferences-label>Фон:</span> <label> <input type=radio name=pref_field value=default_field> Классический </label> <label> <input type=radio name=pref_field value=alternative_field> Альтернативный </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Лицевая сторона:</span> <label> <input type=radio name=pref_face value=default_face> Классическая </label> <label> <input type=radio name=pref_face value=alternative_face> Англо-американская </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Рубашка:</span> <label> <input type=radio name=pref_back value=default_back> Классическая </label> <label> <input type=radio name=pref_back value=alternative_back> Альтернативная </label> </div> <div id=gamePreferences></div> </div>"},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(2),u=n(o),d=a(3),l=n(d),s=a(60),f=n(s),c=a(64),p=n(c),v=function(e){var t=f.default.get("pref");!t&&(t=l.default.pref);try{for(var a in l.default.themes){var n=t[a]&&l.default.themes[a].indexOf(t[a])>=0?t[a]:l.default.pref[a];$("input[name='pref_"+a+"'][value='"+n+"']").prop({checked:!0})}}catch(e){}p.default.show(t)},h=function(e){var t={};try{for(var a in l.default.themes){var n=$("input[name='pref_"+a+"']:checked").val();n="true"==n||"false"!=n&&n,t[a]=n}}catch(e){}u.default.dispatch("fieldThemesSet",t),p.default.get(t),y(t);var r=i.default.get("changePreferencesCallback");if("function"==typeof r){var o=t;r(o)}},y=function(e){f.default.set("pref",e)};t.default=function(e){try{$("#bbParameters").click(v),$("#parametersPanel").on("change","input",h)}catch(e){}}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(1),u=n(o),d=function(){function e(){r(this,e),this.exist=!1}return i(e,[{key:"draw",value:function(){if(!this.exist){var e=u.default.get("gamePreferences");for(var t in e){var a=document.createElement("span");a.setAttribute("class","solitaire-engine-style-preferences-label"),a.innerHTML=e[t].title;var n=document.createElement("div");n.appendChild(a);for(var r in e[t].options)$(n).append($("<label>").append($("<input>").prop({type:"radio",name:"gamePref_"+t,value:e[t].options[r].value})).append(e[t].options[r].title));$("#gamePreferences").append(n)}this.exist=!0}}},{key:"show",value:function(e){this.draw();var t=u.default.get("gamePreferences");for(var a in t)e&&void 0!==e[a]?$("input[name='gamePref_"+a+"'][value='"+e[a]+"']").prop({checked:!0}):$("input[name='gamePref_"+a+"'][value='"+t[a].value+"']").prop({checked:!0})}},{key:"get",value:function(e){var t=u.default.get("gamePreferences");for(var a in t){var n=$("input[name='gamePref_"+a+"']:checked").val();n="true"==n||"false"!=n&&n,e[a]=n}}}]),e}();t.default=new d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(3),u=n(o),d=a(60),l=n(d);t.default=function(e){var t=l.default.get("pref");!t&&(t=u.default.pref);for(var a in t)u.default.themes[a]&&u.default.themes[a].indexOf(t[a])<0&&(t[a]=u.default.pref[a]);i.default.dispatch("fieldThemesSet",t)}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(14),u=n(o);i.default.listen("specialStep",function(e){var t=e.name,a=u.default.getDeckById(e.parent).name;i.default.dispatch("rewindHistory",function(e){for(var n=-1,r=e.history.length-1;r>0&&n<0;r-=1){var i=e.history[r];for(var o in i){var u=i[o];u.move&&u.move.to==a&&u.move.deck[0]==t&&(n=r)}}for(var d=n>=0?e.history.length-n:0,l=0;l<d;l+=1)e.undo()})})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(3),l=n(d),s=a(5),f=n(s),c=a(14),p=n(c),v=a(9),h=n(v),y=a(11),m=n(y),k=a(12),g=n(k),_=function e(t,a,n){f.default.animationDefault();var r=t[0].card.parent&&f.default.getElementById(t[0].card.parent),o=null,d=!0,s=u.default.get("stepType");if(!n.dbclick&&0===n.distance&&u.default.get("moveDistance")>0&&s==l.default.stepType)return!1;if(s!=l.default.stepType&&(g.default.autoSteps&&!g.default.autoSteps[s]||!g.default.autoSteps)){var c=t[0].card.parent&&f.default.getElementById(t[0].card.parent);return void i.default.dispatch("moveCardToHome",{moveDeck:t,departure:c,stepType:u.default.get("stepType")})}i.default.dispatch("startSession",{type:"move"}),d=d&&a;var v=null;if(d&&(v=f.default.getElementById(a)),d=d&&v,d&&("card"==v.type?o=f.default.getElementById(v.parent):"deck"==v.type&&(o=v)),d=d&&o,d=d&&r,d=d&&o.id!=r.id){var y=o.Put(t);if(d=d&&y,y){var k=r.Pop(t.length);if(d=d&&k,k){o.Push(k,!1),f.default.animationDefault();var _=!1;for(var b in o.actions)"moveEnd"==o.actions[b].event&&(_=!0);i.default.dispatch("addStep",{move:{from:r.name,to:o.name,deck:p.default.deckCardNames(t),stepType:{undo:s,redo:s},context:"move"}});var x=function(e){i.default.has("actionEvent:moveEnd:"+o.name,{tag:i.default.tags.inGame})&&u.default.get("autoStep:stepType")!=u.default.get("stepType")||i.default.dispatch("stopSession"),h.default.checkTips(),r.autoUnflipTop&&r.cards.length>0&&r.cards[r.cards.length-1].flip&&r.unflipTopCard();var a={from:r,to:o,moveDeck:t,stepType:u.default.get("stepType")};i.default.dispatch("moveEnd:beforeSave",a);var n=h.default.getTips();(o.save||n.length>0&&s!=l.default.stepType)&&i.default.dispatch("saveSteps","MOVE"),a.before=function(e){e&&"string"==typeof e.stepType&&i.default.dispatch("addStep",{redo:{stepType:e.stepType}})},i.default.dispatch("moveEnd:"+u.default.get("stepType")),i.default.dispatch("moveEnd",a),i.default.dispatch("winCheck",{show:!0})};i.default.dispatch("moveDragDeck",{departure:r,destination:o,moveDeck:t,callback:x})}}}if(!d&&r)if(g.default.inputParams.doubleClick&&n.dbclick||n.distance>=u.default.get("moveDistance")){var w=(0,m.default)(t,n);if(w)return void e(t,w.to.deck.id,n);i.default.dispatch("moveCardToHome",{moveDeck:t,departure:r}),i.default.dispatch("stopSession")}else i.default.dispatch("moveCardToHome",{moveDeck:t,departure:r}),i.default.dispatch("stopSession")};i.default.listen("Move",function(e){_(e.moveDeck,e.to,e.cursorMove)})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(69),l=n(d),s=a(72),f=(n(s),a(73)),c=(n(f),a(74)),p=(n(c),a(75)),v=(n(p),a(76)),h=(n(v),a(77)),y=(n(h),a(78));n(y);a(79),a(80),a(81),a(82),i.default.listen("removeEl",function(e){var t=u.default.get("domElement:"+e.id);try{t.remove(),u.default.delete("domElement:"+e.id)}catch(e){}}),i.default.listen("showCard",function(e){(0,l.default)(e).show()}),i.default.listen("hideCard",function(e){(0,l.default)(e).hide()})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=(n(r),a(1)),o=n(i),u=a(2),d=n(u),l=a(70),s=n(l),f=a(71),c=n(f);o.default.set("animatedElements",0),o.default.set("animatedElementsStack",[]),o.default.set("animatedCallback",function(e){return null});var p=function(e){if(!e)throw Error("elRender:empty arguments.");if("string"!=typeof e)return e.el||e.elements?e:new s.default(e);try{if("#"==e[0]){var t=document.getElementById(e.slice(1,1/0));return new s.default(t)}if("."==e[0]){var a=document.getElementsByClassName(e.slice(1,1/0));return new c.default(a)}if("<"==e[0]){var n=document.createElement("temp");n.innerHTML=e;var r=n.children[0];return new s.default(r)}}catch(e){}};p.stopAnimations=function(e){d.default.dispatch("clearCallbacks"),p(".animated").stop().css({transition:!1}).removeClass("animated")},d.default.listen("stopAnimations",p.stopAnimations),t.default=p},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(2),u=n(o),d=a(1),l=n(d),s=a(3),f=(n(s),a(5)),c=(n(f),function(){function e(t){r(this,e),this.el=t,t||(this.el=null),this._animationCallbacks=[],this._animationIndex=0}return i(e,[{key:"attr",value:function(e){try{for(var t in e)this.el[t]=e[t];return this}catch(e){}}},{key:"hasClass",value:function(e){try{var t=this.el.className.split(" ");return t.indexOf(e)>=0}catch(e){}}},{key:"toggleClass",value:function(e){try{this.hasClass(e)?this.removeClass(e):this.addClass(e)}catch(e){}}},{key:"addClass",value:function(e){try{var t=this.el.className.split(" ");return this.hasClass(e)||(t.push(e),this.el.className=t.join(" ")),this}catch(e){}}},{key:"removeClass",value:function(e){if(!this.el||!this.el.className)return this;try{var t=this.el.className.split(" "),a=[];for(var n in t)t[n]!=e&&a.push(t[n]);return t=a,this.el.className=t.join(" "),this}catch(e){}}},{key:"css",value:function(e){if(!this.el)return this;try{for(var t in e)this.el.style[t]=e[t];return this}catch(e){}}},{key:"hide",value:function(){try{return this.css({display:"none"})}catch(e){}}},{key:"show",value:function(){try{return this.css({display:"block"})}catch(e){}}},{key:"append",value:function(e){try{return e.el&&(e=e.el),this.el.appendChild(e),this}catch(e){}}},{key:"html",value:function(e){try{return void 0===e?this.el.innerHTML:(e.el&&(e=e.el),this.el.innerHTML=e,this)}catch(e){}}},{key:"animate",value:function(e,t,a,n){var r=this;try{!function(){var i=l.default.get("animation");void 0===t&&(t=l.default.get("animationTime")),"function"==typeof t&&(a=t,t=l.default.get("animationTime")),"string"==typeof a&&(n=a,a=null),n=n?n:"animation_"+r._animationIndex,r._animationCallbacks[n]=a,r._animationIndex+=1,setTimeout(function(a){i&&r.css({transition:t/1e3+"s"});var o=0,d=function(e){var t=e+"",a=t.split("px");return 2==a.length?(0|a[0])+"px":e};for(var l in e)d(r.el.style[l])!=d(e[l])&&(o+=1),r.el.style[l]=e[l];i?(r.addClass("animated"),r.el.addEventListener("transitionend",function(e){o-=1,o||(r.removeClass("animated"),r.css({transition:null}),"function"==typeof r._animationCallbacks[n]&&(r._animationCallbacks[n](),r._animationCallbacks[n]=null),u.default.dispatch("allAnimationsEnd",n))},!1)):("function"==typeof r._animationCallbacks[n]&&(r._animationCallbacks[n](),r._animationCallbacks[n]=null),u.default.dispatch("allAnimationsEnd",n))},0)}()}catch(e){}}},{key:"stop",value:function(){this._animationCallbacks=[]}},{key:"remove",value:function(){try{this.el.parentNode.removeChild(this.el)}catch(e){}}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"after",value:function(e){try{this.el.parentNode.insertBefore(e,this.el.nextElementSibling)}catch(e){}return this}},{key:"before",value:function(e){try{this.el.parentNode.insertBefore(e,this.el)}catch(e){}return this}},{key:"listen",value:function(e,t){this.el.addEventListener(e,t)}},{key:"trigger",value:function(e){"function"==typeof this.el[e]&&this.el[e]()}},{key:"click",value:function(e){this.listen("click",e)}}]),e}());t.default=c},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(3),u=(n(o),a(70)),d=n(u),l=function(){function e(t){r(this,e),this.elements=[];for(var a in t)this.elements.push(new d.default(t[a]))}return i(e,[{key:"attr",value:function(e){for(var t in this.elements)this.elements[t].attr(e);return this}},{key:"toggleClass",value:function(e){for(var t in this.elements)this.elements[t].toggleClass(e);return this}},{key:"addClass",value:function(e){for(var t in this.elements)this.elements[t].addClass(e);return this}},{key:"removeClass",value:function(e){for(var t in this.elements)this.elements[t].removeClass(e);return this}},{key:"css",value:function(e){for(var t in this.elements)this.elements[t].css(e);return this}},{key:"hide",value:function(){for(var e in this.elements)this.elements[e].hide();return this}},{key:"show",value:function(){for(var e in this.elements)this.elements[e].show();return this}},{key:"animate",value:function(e,t,a,n){void 0===t&&(t=share.get("animationTime")),"function"==typeof t&&(a=t,t=share.get("animationTime")),"string"==typeof a&&(n=a,a=null);var r=0;for(var i in this.elements)r+=1,this.elements[i].animate(e,t,function(){r-=1,r||a()});return this}},{key:"stop",value:function(){for(var e in this.elements)this.elements[e].stop();return this}},{key:"remove",value:function(){for(var e in this.elements)this.elements[e].parentNode.removeChild(this.elements[e]);return this}}]),e}();t.default=l},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(1),i=n(r),o=a(2),u=n(o),d=a(3),l=n(d),s=a(12),f=(n(s),a(69)),c=n(f);u.default.listen("initField",function(e){var t=e.field?e.field:"#map";"string"==typeof t&&(t=2==t.split(".").length?document.getElementsByClassName(t.split(".")[1])[0]:2==t.split("#").length?document.getElementById(t.split("#")[1]):document.getElementsByTagName(t),t||(t=document.getElementById("mat")));var a={};e.width&&"number"==typeof e.width&&(a.width=e.width+"px"),e.height&&"number"==typeof e.height&&(a.height=e.height+"px"),e.top&&"number"==typeof e.top&&(a.top=e.top+"px"),e.left&&"number"==typeof e.left&&(a.left=e.left+"px");var n=i.default.get("zoom");n==l.default.zoom&&1==n||(a.transform="scale("+n+")",a["transform-origin"]="0 0"),(0,c.default)(t).css(a).addClass("solitaireField"),i.default.set("domElement:field",t)})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(3),l=n(d),s=a(12),f=(n(s),a(69)),c=n(f),p=function(e){e.params.x=(0|(e.deckData.position&&"number"==typeof e.deckData.position.x?e.deckData.position.x:0))+(0|(e.deckData.parentPosition&&"number"==typeof e.deckData.parentPosition.x?e.deckData.parentPosition.x:0)),e.params.y=(0|(e.deckData.position&&"number"==typeof e.deckData.position.y?e.deckData.position.y:0))+(0|(e.deckData.parentPosition&&"number"==typeof e.deckData.parentPosition.y?e.deckData.parentPosition.y:0)),e.deck.rotate=e.params.rotate=e.deckData.rotate&&"number"==typeof e.deckData.rotate?e.deckData.rotate:0,e.params.padding_y=e.deckData.paddingY&&"number"==typeof e.deckData.paddingY?e.deckData.paddingY:e.deckData.paddingType?l.default.padding_y:0,e.params.padding_x=e.deckData.paddingX&&"number"==typeof e.deckData.paddingX?e.deckData.paddingX:e.deckData.paddingType?l.default.padding_x:0,e.params.flip_padding_y=e.deckData.flipPaddingY&&"number"==typeof e.deckData.flipPaddingY?e.deckData.flipPaddingY:e.deckData.paddingType?l.default.flip_padding_y:0,e.params.flip_padding_x=e.deckData.flipPaddingX&&"number"==typeof e.deckData.flipPaddingX?e.deckData.flipPaddingX:e.deckData.paddingType?l.default.flip_padding_x:0;
};i.default.listen("addDeckEl",function(e){p(e);var t=(0,c.default)("<div>"),a={transform:"rotate("+(0|e.params.rotate)+"deg)",width:l.default.card.width+"px",height:l.default.card.height+"px",left:e.params.x+"px",top:e.params.y+"px",display:e.deck.visible?"block":"none"};(0,c.default)(t).css(a).addClass("el").attr({id:e.deck.id}),e.deckData.showSlot&&(0,c.default)(t).addClass("slot"),e.deckData.class&&(0,c.default)(t).addClass(e.deckData.class);var n=u.default.get("domElement:field");(0,c.default)(n).append(t),u.default.set("domElement:"+e.deck.id,t)}),i.default.listen("redrawDeckFlip",function(e){if(e&&e.cards)for(var t in e.cards){var a={},n=u.default.get("domElement:"+e.cards[t].id);e.cards[t].flip?n.addClass("flip"):n.removeClass("flip"),n.css(a)}}),i.default.listen("redrawDeckIndexes",function(e){if(e&&e.cards)for(var t in e.cards){var a=u.default.get("domElement:"+e.cards[t].id);a.css({"z-index":(0|l.default.startZIndex)+(0|t)})}}),i.default.listen("redrawDeck",function(e){if(u.default.get("noRedraw"))return!1;e&&e.deckData&&e.deck&&e.params&&p(e);var t={transform:"rotate("+(0|e.params.rotate)+"deg)",left:e.params.x+"px",top:e.params.y+"px",display:e.deck.visible?"block":"none"},a=u.default.get("domElement:"+e.deck.id);if((0,c.default)(a).css(t),e.deck.full){var n=e.deck.getCards();for(var r in n){var i=u.default.get("domElement:"+n[r].id);i&&(0,c.default)(i).addClass("full")}}for(var o in e.cards){var d=e.deck.padding(o),l=(0|e.params.startZIndex)+(0|o),s={"-ms-transform":"rotate("+(0|e.params.rotate)+"deg)","-webkit-transform":"rotate("+(0|e.params.rotate)+"deg)","-moz-transform":"rotate("+(0|e.params.rotate)+"deg)",transform:"rotate("+(0|e.params.rotate)+"deg)",left:d.x+"px",top:d.y+"px","z-index":l,display:e.deck.visible&&e.cards[o].visible?"block":"none"},f=u.default.get("domElement:"+e.cards[o].id);e.cards[o].flip?(0,c.default)(f).addClass("flip"):(0,c.default)(f).removeClass("flip"),(0,c.default)(f).css(s)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(1),i=n(r),o=a(2),u=n(o),d=a(3),l=n(d),s=a(5),f=(n(s),a(12)),c=(n(f),a(69)),p=n(c);u.default.listen("addCardEl",function(e){var t={width:l.default.card.width+"px",height:l.default.card.height+"px"},a=(0,p.default)("<div>");(0,p.default)(a).addClass("el card draggable "+e.name).css(t).attr({id:e.id}),i.default.set("domElement:"+e.id,a);var n=i.default.get("domElement:field");(0,p.default)(n).append(a)}),u.default.listen("toggleMarkCard",function(e){var t=i.default.get("domElement:"+e.card.id);if(t&&!t.hasClass("flip")){var a=null;t.hasClass("marker")?(a=!1,t.removeClass("marker")):(a=!0,t.addClass("marker")),"function"==typeof e.callback&&e.callback(a)}}),u.default.listen("markCard",function(e){var t=i.default.get("domElement:"+e.card.id);t&&t.removeClass("marker")}),u.default.listen("unmarkCard",function(e){var t=i.default.get("domElement:"+e.card.id);t&&!t.hasClass("flip")&&t.removeClass("marker")})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(69),l=n(d),s=a(9),f=n(s);i.default.listen("showTip",function(e){if(e&&e.el&&e.type){var t=u.default.get("domElement:"+e.el.id);(0,l.default)(t).addClass(e.type)}}),i.default.listen("hideTips",function(e){if(e&&e.types)for(var t in e.types){var a=e.types[t];(0,l.default)("."+a).removeClass(a)}else for(var n in f.default.tipTypes){var r=f.default.tipTypes[n];(0,l.default)("."+r).removeClass(r)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(5),l=n(d),s=a(3),f=n(s),c=a(69),p=n(c),v=function(e){return e<0&&(e+=360),e>360&&(e-=360),e};i.default.listen("moveDragDeck",function(e){l.default.curLock();var t=e.moveDeck.length-1,a=function(a){var n=e.destination.padding(e.destination.cardsCount()-e.moveDeck.length+(0|a),!0);n.random=Math.random();var r=v(e.departure.rotate),o=v(e.destination.rotate),d=u.default.get("domElement:"+e.moveDeck[a].card.id);(0,p.default)(d).css({transform:"rotate("+r+"deg)"}),r-o>180&&(r-=360,(0,p.default)(d).css({transform:"rotate("+r+"deg)"})),r-o<-180&&(o-=360);var s={transform:"rotate("+o+"deg)",left:n.x+"px",top:n.y+"px"},c=(0|f.default.topZIndex)+(0|a),h=!1,y=function(e,t){h||(e.departure.Redraw(),e.destination.Redraw(),l.default.curUnLock(),t&&"function"==typeof e.callback&&e.callback(),i.default.dispatch("moveDragDeckDone",{deck:e.destination}))}.bind(null,e,a==t);i.default.once("clearCallbacks",function(e){h=!0}),(0,p.default)(d).css({"z-index":c}).animate(s,y)};for(var n in e.moveDeck)a(n)}),i.default.listen("moveDragDeckDone",function(e){if(e.deck.full){var t=e.deck.cards;for(var a in t){var n=u.default.get("domElement:"+t[a].id);(0,p.default)(n).addClass("full")}}}),i.default.listen("dragDeck",function(e){for(var t in e._dragDeck){var a=u.default.get("zoom"),n=e._deck.padding(e._dragDeck[t].index),r={left:n.x+(e.x-e._startCursor.x)/a+"px",top:n.y+(e.y-e._startCursor.y)/a+"px","z-index":f.default.topZIndex+(0|t)},i=u.default.get("domElement:"+e._dragDeck[t].card.id);(0,p.default)(i).css(r)}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(5),l=n(d),s=a(69),f=n(s);i.default.listen("moveCardToHome",function(e){u.default.get("lastCursorMove").distance>0&&l.default.curLock();for(var t in e.moveDeck){var a=e.departure.padding(e.moveDeck[t].index),n={left:a.x+"px",top:a.y+"px"},r=u.default.get("domElement:"+e.moveDeck[t].card.id);(0,f.default)(r).animate(n,function(t){l.default.curUnLock(),e.departure&&e.departure.Redraw(),"function"==typeof e.callback&&e.callback()},"moveCardToHomeAnimation")}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),i=n(r),o=a(1),u=n(o),d=a(3),l=n(d),s=a(12),f=(n(s),a(69)),c=n(f);i.default.listen("fieldThemesSet",function(e){var t=u.default.get("domElement:field");for(var a in l.default.themes){for(var n in l.default.themes[a]){var r=l.default.themes[a][n];(0,c.default)(t).removeClass(r)}var i=e[a];(0,c.default)(t).addClass(i)}})},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(2),u=n(o),d=a(5),l=(n(d),a(84)),s=n(l),f=a(14),c=n(f),p=function e(t){var a=!0,n=!1,e=i.default.get("winCheck");if(!e)return!1;e=e.rules?e.rules:e;for(var r in e)n=!0,a="string"==typeof r&&e[r]?a&&s.default[r]({decks:c.default.getDecks({visible:!0}),rulesArgs:e[r]}):"number"==typeof r&&e[e[r]]?a&&s.default[r]({decks:c.default.getDecks({visible:!0})}):a&&s.default.newerWin();return n||(a=a&&s.default.newerWin()),!!a&&(!(!t||!t.noCallback)||(u.default.dispatch("win",t),!0))};u.default.listen("winCheck",p);var v=function(e){e||(e={}),void 0===e.show&&(e.show=!1),p(e)};t.default={winCheck:p,hwinCheck:v}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),o=a(3),u=n(o),d={group:function(e){if(!e.filter||!e.filterArgs)return!1;var t=0,a={};for(var n in e.decks)("string"==typeof e.filterArgs&&e.decks[n].parent==e.filterArgs||e.filterArgs.length&&e.filterArgs.indexOf(e.decks[n].parent)>=0)&&(t+=1,a[n]=e.decks[n]);return e.decks=a,t},groups:function(e){return d.group(e)},select:function(e){if(!e.filter||!e.filterArgs)return!1;var t=0,a={};for(var n in e.decks)e.decks[n].tags.indexOf(e.filterArgs)>=0&&(t+=1,a[n]=deck);return e.decks=a,t},deck:function(e){if(!e.filter||!e.filterArgs)return!1;var t=0,a={};for(var n in e.decks)("string"==typeof e.filterArgs&&e.decks[n].name==e.filterArgs||e.filterArgs.indexOf(e.decks[n].name)>=0)&&(t+=1,a[n]=e.decks[n]);return e.decks=a,t},decks:function(e){return d.deck(e)},firstEmpty:function(e){var t={},a=0;for(var n in e.decks)e.decks[n].tags.indexOf("last")>=0&&(a+=1,t[n]=e.decks[n]);return e.decks=t,a},_asc_desk:function(e){if(!e||"number"!=typeof e.asc_desk)return!1;var t=!0;for(var a in e.decks){if(!t)return!1;var n=e.decks[a].cards;for(var r in n)if(r>0){var o=i.default.validateCardName(n[(0|r)-1].name),d=i.default.validateCardName(n[0|r].name),l=u.default.card.ranks;t=t&&o&&d&&l.indexOf(o.rank)==l.indexOf(d.rank)+e.asc_desk}}return t},newerWin:function(e){return!1},allEmpty:function(e){var t=!0;for(var a in e.decks)t=t&&0==e.decks[a].cards.length;return t},empty:function(e){return d.allEmpty(e)},allInOne:function(e){var t=0,a=0,n=0;for(var r in e.decks)0==e.decks[r].cards.length?t+=1:n=r,a+=1;var i=t==a-1;if(e.filter&&i){var o={};o[deckName]=e.decks[deckName],e.decks=o}return i},allAscend:function(e){return e.asc_desk=-1,d._asc_desk(e)},allDescent:function(e){return e.asc_desk=1,d._asc_desk(e)},topKing:function(e){for(var t in e.decks){var a=e.decks[t],n=a.getTopCard(),r=i.default.validateCardName(n.name).rank;if(void 0!==r&&r!=u.default.card.ranks[u.default.card.ranks.length-1])return!1}return!0},topAce:function(e){for(var t in e.decks){var a=e.decks[t],n=a.getTopCard(),r=i.default.validateCardName(n.name).rank;if(void 0!==r&&r!=u.default.card.ranks[0])return!1}return!0},query:function(e){if(!e||!e.rulesArgs)return!1;var t=!0;for(var a in e.rulesArgs){var n={};for(var r in e.decks)n[r]=e.decks[r];var i={decks:n};if(t&&e.rulesArgs[a].filters){i.filter=!0;for(var o in e.rulesArgs[a].filters)if("string"==typeof e.rulesArgs[a].filters[o]&&d[e.rulesArgs[a].filters[o]])i.filterArgs=null,t=t&&d[e.rulesArgs[a].filters[o]](i);else if(e.rulesArgs[a].filters[o]&&""+e.rulesArgs[a].filters[o]=="[object Object]")for(var u in e.rulesArgs[a].filters[o])d[u]?(i.filterArgs=e.rulesArgs[a].filters[o][u],t=t&&d[u](i)):t=t&&d.newerWin();else t=t&&d.newerWin();i.filter=!1}if(e.rulesArgs[a].rules)for(var l in e.rulesArgs[a].rules)t=d[e.rulesArgs[a].rules[l]]?t&&d[e.rulesArgs[a].rules[l]](i):t&&d.newerWin()}return t},lego:function(e){return d.query(e)}};t.default=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),o=n(r),u=function(e){for(var t,a,n=e.length;n;t=Math.floor(Math.random()*n),a=e[--n],e[n]=e[t],e[t]=a);},d=function(e,t){var a=[];for(var n in e){var r=e[n];for(var i in t){var o=t[i];a.push(r+o)}}return a},l={all:function(e){return d(o.default.card.suits,e)},black:function(e){var t=o.default.card.colors.black;return d(t,e)},red:function(e){var t=o.default.card.colors.red;return d(t,e)},black_and_red:function(e){var t=[o.default.card.colors.red[Math.random()*o.default.card.colors.red.length|0],o.default.card.colors.black[Math.random()*o.default.card.colors.black.length|0]];return d(t,e)},h_only:function(e){var t=["h"];return d(t,e)},d_only:function(e){var t=["d"];return d(t,e)},c_only:function(e){var t=["c"];return d(t,e)},s_only:function(e){var t=["s"];return d(t,e)},one_rank_only:function(e){var t=[o.default.card.solors[Math.random()*o.default.card.solors.length|0]];return d(t,e)},hearts:function(e){return l.h_only()},diamonds:function(e){return l.d_only()},clubs:function(e){return l.c_only()},spades:function(e){return l.s_only()}};t.default=function(e){var t="all",a=!1,n=10,r=e&&e.type&&"string"==typeof e.type?e.type:t,d=e&&e.deckCount&&"number"==typeof e.deckCount?e.deckCount:52,s=e&&e.iterations&&"number"==typeof e.iterations&&e.iterations<n?e.iterations:1,f=e&&e.shuffle&&"undefuned"!=typeof e.shuffle?e.shuffle:a,c=36==d?o.default.card.ranks36:o.default.card.ranks;if(e&&e.ranks){c=[];for(i in e.ranks)o.default.card.rank.indexOf(""+e.ranks[i])>=0&&c.push(""+e.ranks[i])}for(var p=[];s>0;s-=1)p=p.concat(l[r](c));return f&&u(p),p}}]);