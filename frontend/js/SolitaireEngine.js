/*
 * Solitaire game engine
 * Author     : Roman Bauer - <kotapesic@gmail.com>
 * Version    : 0.12.2452
 * Build time : Mon, 13 Feb 2017 14:25:53 GMT
 */
var SolitaireEngine=function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),i=a(r),o=n(2),u=a(o),l=n(3),s=a(l),d=n(4),f=(a(d),n(62)),c=(a(f),n(25)),p=(a(c),n(65)),v=(a(p),n(12)),y=a(v),h=n(5),m=(a(h),n(63)),k=a(m),g=n(56),_=(a(g),n(9)),b=(a(_),n(79)),x=a(b),w=null,O=!0;t.event=u.default,t.options=s.default,t.winCheck=k.default.hwinCheck,t.generator=x.default,t.version="9091494624".split(9).slice(1).map(function(e){return parseInt(e,8)}).join("."),t.onload=function(e){w=e},t.onChangePreferences=function(e){i.default.set("changePreferencesCallback",e)},t.init=function(e){if(u.default.dispatch("gameInit",{firstInit:O}),u.default.clearByTag(u.default.tags.inGame),u.default.setTag(u.default.tags.inGame),y.default.clear(),y.default.create(e),O&&(O=!1,"function"==typeof w)){var n=i.default.get("gamePreferencesData");w(n)}var a=i.default.get("changePreferencesCallback");if("function"==typeof a){var r=i.default.get("gamePreferencesData");a(r)}u.default.dispatch("gameInited"),t.Redraw=function(e){y.default.Redraw(e)}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(2),l=a(u),s=n(3),d=(a(s),function(){function e(){r(this,e),this._data={}}return o(e,[{key:"get",value:function(e){return void 0!==this._data[e]?(l.default.dispatch("shareGet:"+e,this._data[e]),this._data[e]):null}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){if(l.default.dispatch("shareChange:"+e,{from:this._data[e],to:t}),"boolean"==typeof n&&n)try{this._data[e]=["string","number","boolean"].indexOf(void 0===t?"undefined":i(t))>=0?t:t instanceof Array?Object.assign([],t):Object.assign({},t)}catch(n){this._data[e]=t}else this._data[e]=t;l.default.dispatch("shareSet:"+e,t)}else if(e instanceof Object){"boolean"==typeof t&&(n=t);for(var a in e){if(l.default.dispatch("shareChange:"+e,{from:this._data[a],to:e[a]}),"boolean"==typeof n&&n)try{this._data[a]=["string","number","boolean"].indexOf(i(e[a]))>=0?e[a]:e[a]instanceof Array?Object.assign([],e[a]):Object.assign({},e[a])}catch(t){this._data[a]=e[a]}else this._data[a]=e[a];l.default.dispatch("shareSet:"+a,e[a])}}}},{key:"getAll",value:function(){return this._data}},{key:"delete",value:function(e){delete this._data[e]}}]),e}());t.default=new d},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e),this.tags={preInit:"preInit",inGame:"inGame"},this._tag=this.tags.preInit,this._events={}}return a(e,[{key:"listen",value:function(e,t,n,a){"function"==typeof t&&"string"==typeof e&&(this._events[e]?this._events[e].push({tag:this._tag,context:n,callback:t,once:a}):this._events[e]=[{tag:this._tag,callback:t,context:n,once:a}])}},{key:"once",value:function(e,t,n){this.listen(e,t,n,!0)}},{key:"dispatch",value:function(e,t){if(this._events[e])for(var n in this._events[e])this._events[e][n]&&(this._events[e][n].callback(t,{eventInfo:{eventName:e,index:n,count:this._events[e].length}}),this._events[e][n].once&&delete this._events[e][n])}},{key:"clear",value:function(){this._events={}}},{key:"setTag",value:function(e){this._tag=e}},{key:"clearByTag",value:function(e){for(var t in this._events)for(var n in this._events[t])this._events[t][n]&&this._events[t][n].tag==e&&(this._events[t]=this._events[t].slice(0,n).concat(this._events[t].slice((0|n)+1)))}},{key:"get",value:function(e,t){if(t){var n=[];for(var a in this._events[e]){var r=!0;for(var i in t)r=r&&this._events[e][a][i]==t[i];r&&n.push(this._events[e][a])}return n}return this._events[e]}},{key:"has",value:function(e,t){if(t){var n=0;for(var a in this._events[e]){var r=!0;for(var i in t)r=r&&this._events[e][a][i]==t[i];r&&(n+=1)}return n}return this._events[e]?this._events[e].length:0}},{key:"_getAll",value:function(){return this._events}}]),e}();t.default=new r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={themes:{field:["default_field","alternative_field"],face:["default_face","alternative_face"],back:["default_back","alternative_back"]},pref:{field:"default_field",face:"alternative_face",back:"default_back"},showTips:!0,showTipsDestination:!1,showTipPriority:!1,canMoveFlip:!1,tipsParams:{hideOnEmpty:!1,excludeHomeGroups:!0},zoom:1,locale:"ru",animation:!0,animationTime:400,inputParams:{doubleClick:!1},flip:null,actions:null,can_move_flip:!1,showSlot:!0,autohide:!1,paddingType:"none",flip_type:"none",rotate:0,takeRules:["onlytop"],putRule:"any",moveDistance:0,padding_y:0,padding_x:0,flip_padding_y:0,flip_padding_x:0,move_distance:10,debugLabels:!1,startZIndex:100,topZIndex:900,card:{width:71,height:96,suits:["h","d","c","s"],ranks:["1","2","3","4","5","6","7","8","9","10","j","q","k"],values:[1,2,3,4,5,6,7,8,9,10,11,12,13],ranks36:["1","6","7","8","9","10","j","q","k"],colors:{red:["h","d"],black:["c","s"]}},stepType:"default",forceClone:!0,showHistoryAnimation:!0}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),u=a(o),l=n(2),s=a(l),d=n(3),f=a(d),c=n(5),p=a(c),v=n(14),y=a(v),h=n(9),m=a(h),k=function(){function e(){var t=this;r(this,e),u.default.set("dragDeck",null),u.default.set("startCursor",null);try{document.onmousedown=function(e){0===e.button&&t.take(e.target,e.clientX,e.clientY)},document.onmousemove=function(e){t.drag(e.clientX,e.clientY)},document.onmouseup=function(e){t.put(e.target,e.clientX,e.clientY)},document.ondblclick=function(e){t.take(e.target,e.clientX,e.clientY),t.put(e.target,e.clientX,e.clientY,!0),p.default.curUnLock()},document.addEventListener("touchstart",function(e){t.take(e.target,e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchmove",function(e){u.default.get("startCursor")&&e.preventDefault(),t.drag(e.touches[0].clientX,e.touches[0].clientY)},!1),document.addEventListener("touchend",function(e){t.put(e.changedTouches[0].target,e.changedTouches[0].clientX,e.changedTouches[0].clientY)},!1)}catch(e){}}return i(e,[{key:"break",value:function(){var e=u.default.get("dragDeck");if(e&&e[0]&&e[0].card&&e[0].card.parent){var t=y.default.getDeckById(e[0].card.parent);t&&t.Redraw()}u.default.set("dragDeck",null),u.default.set("startCursor",null),p.default.curUnLock()}},{key:"take",value:function(e,t,n){if(u.default.set("dragDeck",null),u.default.set("startCursor",null),!p.default.isCurLock()&&!u.default.get("sessionStarted")){if(e.className.split(" ").indexOf("slot")>=0){var a=e.id,r=p.default.getElementById(a);r&&s.default.dispatch("click",{to:r})}if(e.className.split(" ").indexOf("draggable")>=0){var i=e.id,o=i?p.default.getElementById(i):null,l=o&&o.parent?o.parent:null,d=l?y.default.getDeckById(l):null;d&&s.default.dispatch("click",{to:d});var f=d?d.Take(i):null;u.default.set("dragDeck",f),f&&(u.default.set("startCursor",{x:t,y:n}),m.default.tipsDestination({currentCard:o}))}}}},{key:"drag",value:function(e,t){if(!p.default.isCurLock()){var n=u.default.get("startCursor"),a=u.default.get("dragDeck");if(a&&n){var r=p.default.getElementById(a[0].card.parent);s.default.dispatch("dragDeck",{x:e,y:t,_dragDeck:a,_startCursor:n,_deck:r})}}}},{key:"put",value:function(e,t,n,a){if(!p.default.isCurLock()){var r=u.default.get("startCursor"),i=u.default.get("dragDeck");if(i&&r){var o=p.default.getElementById(i[0].card.parent),l=o.padding(i[0].index),d=Math.sqrt(function(e){return e*e}(t-r.x)+function(e){return e*e}(n-r.y)),c={distance:d,dbclick:!!a,direction:{x:t-r.x,y:n-r.y,right:t>r.x,left:t<r.x,down:n>r.y,up:n<r.y},lastPosition:{x:t,y:n},deckPosition:{x:l.x+(t-r.x),y:l.y+(n-r.y)}};u.default.set("lastCursorMove",c,f.default.forceClone),u.default.set("lastDragDeck",{dragDeckParentId:i[0].card.parent,dragDeck:i},f.default.forceClone),s.default.dispatch("hideCard",e);var v=document.elementFromPoint(t,n);s.default.dispatch("showCard",e),s.default.dispatch("Move",{moveDeck:i,to:v&&v.id?v.id:"mat",cursorMove:c}),u.default.set("dragDeck",null),u.default.set("startCursor",null)}}}}]),e}();t.default=new k},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),o=n(2),u=a(o),l=n(3),s=a(l),d=n(6),f=a(d),c=n(9),p=a(c),v=n(12),y=a(v),h=n(56),m=(a(h),n(57)),k=a(m),g=n(59),_=a(g),b=n(61),x=a(b);u.default.listen("gameInit",function(e){i.default.set("stepType",s.default.stepType),i.default.delete("sessionStarted"),D(),e.firstInit&&((0,k.default)(),(0,_.default)())}),u.default.listen("gameInited",function(e){(0,x.default)()}),u.default.listen("moveEnd",function(e){p.default.checkTips()}),u.default.listen("actionBreak",function(e){p.default.checkTips()}),u.default.listen("startSession",function(e){i.default.set("sessionStarted",!0),f.default.backup()}),u.default.listen("stopSession",function(e){i.default.set("sessionStarted",!1)});var w=function(e){return i.default.get("curLockState")},O=function(e){i.default.set("curLockState",!0)},D=function(e){i.default.set("curLockState",!1)},T=function(e){return i.default.get("elements")},P=function(e){var t=i.default.get("elements");return t[e]},C=function(e,t){var n=[],a=i.default.get("elements");for(var r in a)a[r].name&&"string"==typeof a[r].name&&a[r].name==e&&(t&&"string"==typeof a[r].type&&t&&a[r].type==t?n.push(a[r]):n.push(a[r]));return n},j=function(e){if("string"!=typeof e)return!1;var t=e.slice(0,1),n=e.slice(1,3),a=null,r=s.default.card.values[s.default.card.ranks.indexOf(n)];for(var i in s.default.card.colors)s.default.card.colors[i].indexOf(t)>=0&&(a=i);return s.default.card.suits.indexOf(t)>=0&&s.default.card.ranks.indexOf(n)>=0&&{color:a,value:r,name:e,suit:t,rank:n}},M=0,S=function(e){return M+=1};i.default.set("animation",s.default.animation);var E=function(e){i.default.set("animation",!0)},I=function(e){i.default.set("animation",s.default.animation)},R=function(e){i.default.set("animation",!1)};u.default.listen("newGame",function(e){R()}),u.default.listen("historyReapeater",function(e){e?(i.default.set("noRedraw",!0),i.default.set("noTips",!0)):(i.default.set("noRedraw",!1),y.default.Redraw(),i.default.set("noTips",!1),p.default.checkTips())}),i.default.set("stepType",s.default.stepType),t.default={isCurLock:w,curLock:O,curUnLock:D,getElements:T,getElementById:P,getElementsByName:C,validateCardName:j,genId:S,animationOn:E,animationOff:R,animationDefault:I}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),l=a(u),s=n(2),d=a(s),f=n(3),c=(a(f),n(5)),p=a(c),v=n(7),y=a(v),h=n(8),m=a(h),k=["parent","visible","flip"],g=function(){function e(){r(this,e),this._state=null,this._sourceList=["stepType"],this._clearList=["animatedCallback","animatedElements","animatedElementsStack","curLockState","sessionStarted","startCursor","lastCursorMove"]}return o(e,[{key:"backup",value:function(){d.default.dispatch("debugFlag",{flag:2,color:"green",text:"sm:backup"}),this._state={};for(var e in this._sourceList){var t=l.default.get(this._sourceList[e]);this._state[this._sourceList[e]]=["string","number","boolean"].indexOf(void 0===t?"undefined":i(t))>=0?t:t instanceof Array?Object.assign([],t):Object.assign({},t)}this._state.model={};var n=(0,y.default)();for(var a in n){var r=[];for(var o in n[a].cards){var u={name:n[a].cards[o].name,id:n[a].cards[o].id};for(var s in k){var f=k[s];u[f]=n[a].cards[o][f]}r.push(u)}this._state.model[a]={name:n[a].name,cards:r,group:n[a].parent}}}},{key:"restore",value:function(){if(this._state){for(var e in this._clearList)l.default.delete(this._clearList[e]);for(var t in this._sourceList)l.default.set(this._sourceList[t],this._state[this._sourceList[t]],!0);for(var n in this._state.model){var a=(0,m.default)(n),r=[];for(var i in this._state.model[n].cards){var o=this._state.model[n].cards[i].id,u=p.default.getElementById(o);if(u.name==this._state.model[n].cards[i].name){for(var s in k){var d=k[s];u[d]=this._state.model[n].cards[i][d]}r.push(u)}}a.cards=r,a.Redraw()}}}},{key:"get",value:function(){return this._state}},{key:"log",value:function(){return this._state}}]),e}();t.default=new g},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r);t.default=function(e){var t={},n=i.default.get("elements");if(e&&e.visible)for(var a in n)"deck"==n[a].type&&n[a].visible&&(t[a]=n[a]);else for(var r in n)"deck"==n[r].type&&(t[r]=n[r]);return t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r);t.default=function(e){var t=i.default.get("elements");return!(!t[e]||"deck"!=t[e].type)&&t[e]}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(1),u=a(o),l=n(3),s=a(l),d=n(5),f=(a(d),n(10)),c=a(f),p=n(11),v=a(p),y=n(14),h=a(y),m=n(12),k=a(m),g=s.default.showTips,_=["tip","tipTo","tipPriority","tipToHome"],b=[],x=function(e){return b},w=function(e){if(u.default.get("noTips"))return!1;i.default.dispatch("hideTips");var t=h.default.getDecks({visible:!0});if(b=(0,c.default)({decks:t}),0==b.length&&u.default.get("stepType")==s.default.stepType&&i.default.dispatch("noTips"),g){var n=k.default.homeGroups;for(var a in b)k.default.tipsParams.excludeHomeGroups&&n&&n.length&&n.indexOf(b[a].from.deck.parent)>=0||i.default.dispatch("showTip",{el:b[a].from.card,type:"tip"}),n.indexOf(b[a].to.deck.parent)>=0&&i.default.dispatch("showTip",{el:b[a].from.card,type:"tipToHome"})}};i.default.listen("makeStep",w),i.default.listen("checkTips",w);var O=function(e){g=!0,e&&e.init||w()};i.default.listen("tips:on",O),i.default.listen("tipsON",O);var D=function(e){g=!1,e&&e.init||w()};i.default.listen("tips:off",D),i.default.listen("tipsOFF",D);var T=function(e){if(u.default.get("showTipPriority")&&(i.default.dispatch("hideTips",{types:["tipPriority"]}),u.default.showTipPriority&&e&&e.moveDeck&&e.cursorMove&&e.cursorMove.distance&&e.cursorMove.distance>=u.default.moveDistance)){var t=(0,v.default)(e.moveDeck,e.cursorMove);t&&i.default.dispatch("showTip",{el:t.to.deck,type:"tipPriority"})}},P=function(e){if(u.default.get("showTipsDestination")&&(i.default.dispatch("hideTips"),e&&e.currentCard&&e.currentCard.id))for(var t in b)b[t].from.card.id==e.currentCard.id&&i.default.dispatch("showTip",{el:b[t].to.deck,type:"tipTo"})},C=function(e){for(var t in b)if(b[t].from.deck.name==e)return!0;return!1},j=function(e,t){for(var n in b)if(b[n].from.deck.name==e&&b[n].to.deck.name==t)return!0;return!1};t.default={tipTypes:_,getTips:x,checkTips:w,showTips:O,hideTips:D,tipsMove:T,checkFrom:C,fromTo:j,tipsDestination:P}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e),this._decks=null,this._moves=[]}return a(e,[{key:"get",value:function(e){this._decks=e.decks,this._moves=[];for(var t in this._decks){var n=this._decks[t].cards;this.cardsInTakeDeck(n,t)}return this._moves}},{key:"cardsInTakeDeck",value:function(e,t){for(var n in e){var a=e[n].id,r=this._decks[t].Take(a);r&&this.decksToPut(e,r,t,n)}}},{key:"decksToPut",value:function(e,t,n,a){for(var r in this._decks)if(n!=r){var i=this._decks[r].Put(t);i&&this.put(r,n,a,e)}}},{key:"put",value:function(e,t,n,a){var r=this._decks[e].cards,i=r.length?r[r.length-1]:null;this._moves.push({from:{deck:this._decks[t],card:a[n],count:a.length},to:{deck:this._decks[e],lastCard:i,count:r.length}})}}]),e}(),i=new r;t.default=function(e){return i.get(e)}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=(a(r),n(3)),o=a(i),u=n(5),l=(a(u),n(9)),s=a(l),d=n(12),f=a(d);t.default=function(e,t){var n=[],a=s.default.getTips();for(var r in a)a[r].from.card.id==e[0].card.id&&n.push(a[r]);if(0==n.length)return!1;var i=0,u=0,l=-1,d=f.default.homeGroups;if(d){var c=[];for(var p in d)for(var v in n)n[v].to.deck.parent==d[p]&&c.push(n[v]);c.length&&(n=c)}if(n.length>1){for(var y=0;y<n.length;y+=1){var h=[];n[y].to.deck.cardsCount()&&h.push(n[y]),h.length&&(n=h)}for(var m in n){var k={x:t.deckPosition.x+(o.default.card.width/2|0),y:t.deckPosition.y+(o.default.card.height/2|0)},g=n[m].to.deck.padding(n[m].to.deck.cards.length),_={x:g.x+(o.default.card.width/2|0),y:g.y+(o.default.card.height/2|0)};n[m].distance=Math.sqrt(function(e){return e*e}(k.x-_.x)+function(e){return e*e}(k.y-_.y)),n[m].inDirection=!1,(t.direction.x>0&&_.x>k.x||t.direction.x<0&&_.x<k.x)&&(n[m].inDirection=!0,u+=1)}for(var b in n)"-1"==l?0==u?l=n[b].distance:n[b].inDirection&&(l=n[b].distance,i=b):n[b].distance<l&&(0==u?(l=n[b].distance,i=b):n[b].inDirection&&(l=n[b].distance,i=b))}return n[i]}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),l=a(u),s=n(2),d=a(s),f=n(3),c=a(f),p=n(5),v=(a(p),n(13)),y=a(v),h=n(14),m=a(h),k=n(9),g=a(k),_=n(52),b=a(_),x=n(55),w=a(x),O=function(){function e(){r(this,e),l.default.set("elements",{}),this.tipsParams={},this.inputParams={}}return o(e,[{key:"create",value:function(e){this.homeGroups=e.homeGroups?e.homeGroups:[],"boolean"==typeof e.showTips&&e.showTips?g.default.showTips({init:!0}):g.default.hideTips({init:!0}),l.default.set("stepType",c.default.stepType);var t={showTipsDestination:"boolean",showTipPriority:"boolean",moveDistance:"number",zoom:"number",animationTime:"number",showHistoryAnimation:"boolean"};for(var n in t)l.default.set(n,i(e[n])==t[n]?e[n]:c.default[n]);if(l.default.set("winCheck",e.winCheck),e.preferences){var a=w.default.get("pref"),r={},o={};for(var u in e.preferences)"string"==typeof u&&(r[u]=e.preferences[u],o[u]=a&&void 0!==a[u]?a[u]:e.preferences[u].value);l.default.set("gamePreferences",r),l.default.set("gamePreferencesData",o)}else l.default.set("gamePreferences",{});for(var s in c.default.tipsParams)this.tipsParams[s]=e.tipsParams&&void 0!==e.tipsParams[s]?e.tipsParams[s]:c.default.tipsParams[s];for(var f in c.default.inputParams)this.inputParams[f]=e.inputParams&&void 0!==e.inputParams[f]?e.inputParams[f]:c.default.inputParams[f];if(e.startZIndex&&"number"==typeof e.startZIndex&&l.default.set("start_z_index",e.startZIndex),e.autoSteps&&(this.autoSteps=(0,b.default)(e.autoSteps)),d.default.dispatch("initField",e),e.groups)for(var p in e.groups)e.groups[p].name=p,y.default.add(e.groups[p]);if(e.decks)for(var v in e.decks)m.default.addDeck(e.decks[v]);if(e.fill){var h=m.default.getDecks(),k=null;try{k=Object.assign([],e.fill)}catch(t){k=e.fill}for(;k.length;)for(var _ in h)if(k.length){var x=k.shift();h[_].Fill([x])}}g.default.checkTips(),d.default.dispatch("newGame")}},{key:"Redraw",value:function(e){if(e){for(var t in e.groups){var n=y.default.getByName(t);n&&n.Redraw(e.groups[t])}for(var a in e.decks){var r=m.default.getDeck(e.decks[a].name);r&&r.Redraw(e.decks[a])}}else{var i=m.default.getDecks();for(var o in i)i[o].Redraw()}}},{key:"clear",value:function(){var e=l.default.get("elements");for(var t in e)"deck"==e[t].type?(e[t].clear(),e[t]=null):"group"==e[t].type&&(e[t]=null);l.default.set("elements",{})}}]),e}();t.default=new O},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=(a(o),n(1)),l=a(u),s=n(3),d=a(s),f=n(5),c=a(f),p=n(14),v=a(p),y=n(38),h=a(y),m=n(39),k=a(m),g=n(40),_=a(g),b={paddingType:{type:"any"},flip:{type:"any"},showSlot:{type:"any"},takeRules:{type:"any"},putRules:{type:"any"},fullRules:{type:"any"},autoHide:{type:"any"},paddingX:{type:"any"},paddingY:{type:"any"},flipPaddingX:{type:"any"},flipPaddingY:{type:"any"},actions:{type:"any"},tags:{type:"any"},save:{type:"boolean",default:!0}},x=function(){function e(t,n){r(this,e),this.type="group",this.id=n,this.name=t.name&&"string"==typeof t.name?t.name:"name_"+n,this.position={x:t.position&&t.position.x&&"number"==typeof t.position.x?t.position.x:0,y:t.position&&t.position.y&&"number"==typeof t.position.y?t.position.y:0},this.placement=t.placement?{x:t.placement.x?t.placement.x:0,y:t.placement.y?t.placement.y:0}:null,this.decks={},this.parameters={};for(var a in b)"any"==b[a].type?this.parameters[a]=t[a]?t[a]:d.default[a]:"boolean"==b[a].type&&(this.parameters[a]="boolean"==typeof t[a]?t[a]:b[a].default);this.deckIndex=[],this.tags=t.tags}return i(e,[{key:"addDeck",value:function(e){if(e){e.position||(e.position={x:0,y:0}),e.parent||(e.parent=this.name),e.parentPosition={x:this.position.x,y:this.position.y};var t=0;if(e.groupIndex&&decks[this.deckIndex[e.groupIndex-1]].this.deckIndex==e.this.deckIndex&&"number"==typeof e.groupIndex&&this.deckIndex[e.groupIndex-1]&&(e.groupIndex=null),e.groupIndex&&"number"==typeof e.groupIndex)if(this.deckIndex[e.groupIndex-1]){for(;void 0!==this.deckIndex[t];t+=1);if(placement){var n=this.deckIndex[e.groupIndex-1],a=l.default.get("elements");placement.x&&a[n].x(this.position.x+(placement.x+d.default.card.width)*n),placement.y&&a[n].y(this.position.y+(placement.y+d.default.card.width)*n),l.default.set("elements",a)}this.deckIndex[t]=this.deckIndex[e.groupIndex-1],this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1}else this.deckIndex[e.groupIndex-1]=!0,t=e.groupIndex-1;else{for(;void 0!==this.deckIndex[t];t+=1);this.deckIndex[t]=!0}this.placement&&(this.placement.x&&(e.position.x=(this.placement.x+d.default.card.width)*t),this.placement.y&&(e.position.y=(this.placement.y+d.default.card.height)*t));for(var r in b)"any"==b[r].type?this.parameters[r]&&void 0===e[r]&&(e[r]=this.parameters[r]):"boolean"==b[r].type&&"boolean"==typeof this.parameters[r]&&void 0===e[r]&&(e[r]=this.parameters[r]);e.deckIndex="number"==typeof e.deckIndex?e.deckIndex:(0|t)+1;var i=v.default.addDeck(e);this.deckIndex[t]=i.id,this.decks[i.id]=i}}},{key:"Fill",value:function(e){(0,h.default)(this,e)}},{key:"getDeckById",value:function(e){return this.decks[e]}},{key:"getDeckIndexById",value:function(e){for(var t in this.deckIndex)if(this.deckIndex[t]==e)return t;return null}},{key:"getDeckIdByIndex",value:function(e){return this.deckIndex[(0|e)-1]}},{key:"getDeckByIndex",value:function(e){var t=this.getDeckIdByIndex(e);return this.getDeckById(t)}},{key:"getDecksByName",value:function(e){var t={};for(var n in this.decks)this.decks[n].name==e&&(t[n]=decks[n]);return t}},{key:"getDecks",value:function(e){var t=[];for(var n in this.decks)e&&e.visible?this.decks[n].visible&&t.push(this.decks[n]):t.push(this.decks[n]);return t}},{key:"Redraw",value:function(e){(0,k.default)(this,e)}},{key:"hasDeck",value:function(e){var t=!1;for(var n in decks)decks[n].name==e&&(t=!0);return t}},{key:"decksCount",get:function(){var e=0;for(var t in this.decks)e+=1;return e}}]),e}(),w=function(e){if(!e)return!1;if(!e.decks)return!1;var t="group_"+c.default.genId(),n=new x(e,t);if(e.decks){if("number"==typeof e.decks&&(e.decks={generator:{type:"count",count:e.decks}}),e.decks.generator){if(!e.decks.generator.type)return;if(!_.default[e.decks.generator.type])return;e.decks=_.default[e.decks.generator.type](n,e.decks.generator),e.placement=null}for(var a in e.decks)for(var r in e.decks[a].relations){var i=null;try{i=Object.assign({},e.decks[a].relations[r])}catch(t){i=e.decks[a].relations[r]}}for(var o in e.decks)n.addDeck(e.decks[o])}var u=l.default.get("elements");if(u[t]=n,l.default.set("elements",u),e&&e.fill){var s=e.fill.length;s&&n.Fill(e.fill)}return n},O=function(e){return c.default.getElementsByName(e,"group")[0]};t.default={getByName:O,add:w}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=a(o),l=n(1),s=a(l),d=n(3),f=a(d),c=n(5),p=a(c),v=n(15),y=a(v),h=n(16),m=a(h),k=n(18),g=(a(k),n(19)),_=a(g),b=n(20),x=a(b),w=n(21),O=a(w),D=n(33),T=a(D),P=n(34),C=a(P),j=n(35),M=a(j),S=n(13),E=a(S),I=n(7),R=a(I),N=n(8),A=a(N),B=n(36),F=a(B),L=n(37),Y=a(L),X=function(){function e(t,n){var a=this;if(r(this,e),!t)return!1;this.cards=[],this.type="deck",this.full=!1,this.id=n;var i=E.default.getByName(t.parent),o=i?i.name:"no_parent_",l=i?i.getDecks().length:n;this.name="string"==typeof t.name?t.name:o+"_"+l,this.locked=!!t.locked,this.save=!!t.save,this.visible="boolean"!=typeof t.visible||t.visible,this.deckIndex="number"==typeof t.deckIndex?t.deckIndex:null,this.parent="string"==typeof t.parent?t.parent:"field",this.autoHide="boolean"==typeof t.autoHide?t.autoHide:f.default.autohide,void 0===t.showSlot&&(t.showSlot=f.default.showSlot),this._params={padding_y:"number"==typeof t.paddingY?t.paddingY:f.default.padding_y,flip_padding_y:"number"==typeof t.flipPaddingY?t.flipPaddingY:f.default.flip_padding_y,padding_x:"number"==typeof t.paddingX?t.paddingX:f.default.padding_x,flip_padding_x:"number"==typeof t.flipPaddingX?t.flipPaddingX:f.default.flip_padding_x,startZIndex:"number"==typeof t.startZIndex?t.startZIndex:f.default.startZIndex,rotate:"number"==typeof t.rotate?t.rotate:f.default.rotate,x:0,y:0},this.rotate=this._params.rotate;var s=t.flip&&"string"==typeof t.flip?t.flip:f.default.flip_type;this.cardFlipCheck=y.default[s],this.putRules=t.putRules?"function"==typeof t.putRules?t.putRules:"string"==typeof t.putRules?m.default[t.putRules]?m.default[t.putRules]:m.default[f.default.putRule]:t.putRules.constructor==Array?t.putRules:m.default[f.default.putRule]:m.default[f.default.putRule],this.takeRules=t.takeRules,this.fullRules=null,t.fullRules&&(this.fullRules=t.fullRules);var d=t.paddingX||t.paddingY?x.default.special:t.paddingType?"string"==typeof t.paddingType&&x.default[t.paddingType]?x.default[t.paddingType]:x.default.none:x.default[f.default.paddingType];this.padding=function(e){return d(a._params,a.cards[e],e,a.cards.length,a.cards)},this.actions=[],t.actions&&(this.actions=t.actions,O.default.add(this)),t.relations?this.relations=t.relations:this.relations=[],this.tags=t.tags?t.tags:[],u.default.dispatch("addDeckEl",{deckData:t,deck:this,params:this._params});var c=function(e){e.destination.name==a.name&&a.checkFull()};u.default.listen("moveDragDeck",c)}return i(e,[{key:"Redraw",value:function(e){u.default.dispatch("redrawDeck",{deck:this,deckData:e,params:this._params,cards:this.cards}),u.default.dispatch("redrawDeckFlip",{cards:this.cards})}},{key:"getTopCard",value:function(){return 0!=this.cards.length&&this.cards[this.cards.length-1]}},{key:"getSomeCards",value:function(e){var t=[];("number"!=typeof e||e>this.cards.length||e<1)&&(e=this.cards.length);for(var n=0;n<e;n+=1)t.push(this.cards[this.cards.length-1-n]);return t}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"flipCheck",value:function(){for(var e in this.cards)this.cardFlipCheck(this.cards[e],0|e,this.cards.length);u.default.dispatch("redrawDeckFlip",this)}},{key:"checkFull",value:function(){if(!this.full&&this.fullRules&&this.fullRules.length>0){var e=!0;for(var t in this.fullRules){var n=this.fullRules[t];if("string"==typeof n)e=e&&"function"==typeof _.default[n]&&_.default[n](this);else for(var a in n)"string"==typeof a&&"function"==typeof _.default[a]&&(e=e&&_.default[a](this,n[a]))}this.full=e}return this.full}},{key:"Fill",value:function(e){for(var t in e)this.genCardByName(e[t])}},{key:"clear",value:function(){for(var e in this.cards)u.default.dispatch("removeEl",this.cards[e]),this.cards[e]=null;this.cards=[],u.default.dispatch("removeEl",this)}},{key:"Push",value:function(e){for(var t in e)e[t].parent=this.id,this.cards.push(e[t])}},{key:"Pop",value:function(e,t){if(this.cards.length<e)return!1;for(var n=[];e;e-=1){var a=this.cards.pop();t&&(a.parent=null),n.push(a),n[n.length-1].parent=null}return n.reverse(),this.autoHide&&0==this.cards.length&&this.hide(),this.Redraw(),n}},{key:"Take",value:function(e){return(0,T.default)(this,e)}},{key:"Put",value:function(e){return(0,C.default)(this,e)}},{key:"genCardByName",value:function(e){return(0,M.default)(this,e)}},{key:"hide",value:function(){this.visible=!1,u.default.dispatch("addStep",{hideDeck:this.name}),this.Redraw()}},{key:"show",value:function(){this.visible=!1,u.default.dispatch("addStep",{showDeck:this.name}),this.Redraw()}},{key:"getCards",value:function(){return this.cards}},{key:"hideCards",value:function(){for(var e in this.cards)this.cards[e].visible=!1,u.default.dispatch("hideCard",this.cards[e]);
}},{key:"showCards",value:function(){for(var e in this.cards)this.cards[e].visible=!0,u.default.dispatch("showCard",this.cards[e])}},{key:"getCardsNames",value:function(){var e=[];for(var t in this.cards)e.push(this.cards[t].name);return e}},{key:"cardsCount",value:function(){return this.cards.length}},{key:"getRelationsByName",value:function(e,t){var n=[];for(var a in this.relations)if(this.relations[a].name==e)if(t){var r=0,i=0;for(var o in t)i+=1,this.relations[a][o]==t[o]&&(r+=1);r==i&&n.push(this.relations[a])}else n.push(this.relations[a]);return n}},{key:"hasTag",value:function(e){for(var t in this.tags)if(this.tags[t]==e)return!0;return!1}}]),e}(),H=function(e){if(!e)return!1;var t="deck_"+p.default.genId(),n=new X(e,t);if(e.fill)for(var a in e.fill)"string"==typeof e.fill[a]&&n.genCardByName(e.fill[a]);var r=s.default.get("elements");return r[t]=n,s.default.set("elements",r),n};t.default={deckCardNames:F.default,addDeck:H,getDeck:Y.default,getDecks:R.default,getDeckById:A.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={none:function(e,t,n){e.flip=!1},all:function(e,t,n){e.flip=!0},notlast:function(e,t,n){e.flip=t<n-1},first_1:function(e,t,n){e.flip=t<1},first_2:function(e,t,n){e.flip=t<2},first_3:function(e,t,n){e.flip=t<3},bee:function(e,t,n){e.flip=t!=n-1&&t%2==0}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=a(r),o=n(3),u=a(o),l=n(14),s=a(l),d=n(17),f=a(d),c={linePrev:function(e){var t=(0,f.default)(e.to).prev;return!!t&&(e.link=t.to,!0)},lineNext:function(e){var t=(0,f.default)(e.to).next;return!!t&&(e.link=t.to,!0)},_down_up_cards:function(e){if(0==e.cards.length)return!1;var t=i.default.validateCardName(e.cards[e.cards.length-1].name),n=i.default.validateCardName(e.putDeck[0].card.name);return!(!t||!n)&&{up:n,down:t}},_down_up_rank_num:function(e){var t=c._down_up_cards(e);return!!t&&{down:u.default.card.ranks.indexOf(t.down.rank),up:u.default.card.ranks.indexOf(t.up.rank)}},_isFirst:function(e,t){if(0==e.cards.length){var n=null;return(n=i.default.validateCardName(e.putDeck[0].card.name))&&n.rank==t}return!0},striped:function(e){if(0==e.cards.length)return!0;var t=i.default.validateCardName(e.cards[e.cards.length-1].name).color,n=null,a=null;return(a=i.default.validateCardName(e.putDeck[0].card.name))&&(n=a.color),t!=n},firstAce:function(e){return c._isFirst(e,u.default.card.ranks[0])},firstKing:function(e){return c._isFirst(e,u.default.card.ranks[u.default.card.ranks.length-1])},notForEmpty:function(e){return e.cards.length>0},onlyEmpty:function(e){return 0==e.cards.length},oneRank:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e);return t&&t.up.rank==t.down.rank},oneSuit:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e);return t&&t.up.suit==t.down.suit},any:function(e){return!0},not:function(e){return!1},ascendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var n in e.putDeck)if(n>0){var a=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[n-1].card.name).rank),r=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[n].card.name).rank);t=t&&1+a==r}return t},descendDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var n in e.putDeck)if(n>0){var a=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[n-1].card.name).rank),r=u.default.card.ranks.indexOf(i.default.validateCardName(e.putDeck[n].card.name).rank);t=t&&a==1+r}return t},oneRankDeck:function(e){if(1==e.putDeck.length)return!0;var t=!0;for(var n in e.putDeck)if(n>0){var a=i.default.validateCardName(e.putDeck[n-1].card.name).suit,r=i.default.validateCardName(e.putDeck[n].card.name).suit;t=t&&a==r}return t},ascend:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down<t.up},descent:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down>t.up},descentOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&t.down==1+t.up},ascendOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&1+t.down==t.up},ascdescOne:function(e){if(0==e.cards.length)return!0;var t=c._down_up_rank_num(e);return t&&1==Math.abs(t.down-t.up)},sum14:function(e){if(0==e.cards.length)return!0;var t=c._down_up_cards(e),n=t.down.value+t.up.value;return 14==n},around:function(e){if(0==e.cards.length)return!0;var t=e.from.deck.getRelationsByName("around",{from:null}),n=s.default.getDeckById(e.cards[0].parent);for(var a in t)if(t[a].to==n.name)return!0;return!1}};t.default=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.getRelationsByName("beside",{from:null,type:"prev"})[0],n=e.getRelationsByName("beside",{from:null,type:"next"})[0];return{prev:t,next:n}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={not:function(e){return!1},notFirst:function(e){return e.cardIndex>0},any:function(e){return!0},onlytop:function(e){return e.cardIndex==e.deckLength-1}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=a(r),o=n(5),u=a(o),l=n(13),s=a(l),d=n(14),f=a(d),c=n(9),p=(a(c),n(17)),v=a(p),y={_topCard:function(e){var t=e.getTopCard();return t&&u.default.validateCardName(t.name)},_bottomCard:function(e){var t=e.getCards()[0];return t&&u.default.validateCardName(t.name)},_besideTopCardRecoursive:function(e,t,n){for(var a=!0,r=e,i=(0,v.default)(r)[t];i&&a;){var o=f.default.getDeck(i.to);a=a&&n(y._topCard(e),y._topCard(o)),r=o,i=(0,v.default)(o)[t]}return a},_besideTopCard:function(e,t,n){var a=(0,v.default)(e)[t],r=f.default.getDeck(a.to);return n(y._topCard(e),y._topCard(r))},_deckRecoursive:function(e,t){for(var n=!0,a=e.getCards(),r=a.length,i=r;i>0;i-=1)n=n&&t(u.default.validateCardName(a[i].name),u.default.validateCardName(a[i-1].name));return n},query:function(e,t){var n=!0,a=[];if(t.groups){var r=!0,i=!1,o=void 0;try{for(var u,l=t.groups[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var d=u.value,c=s.default.getByName(d),p=(c.getDecks(),t.select?t.select:"all");if("first"==p){var v=c.getDeckByIndex(1);a.push(v)}}}catch(e){i=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}}if(t.decks){var h=!0,m=!1,k=void 0;try{for(var g,_=t.decks[Symbol.iterator]();!(h=(g=_.next()).done);h=!0){var b=g.value,x=f.default.getDeck(b);x&&a.push(x)}}catch(e){m=!0,k=e}finally{try{!h&&_.return&&_.return()}finally{if(m)throw k}}}var w=!0,O=!1,D=void 0;try{for(var T,P=a[Symbol.iterator]();!(w=(T=P.next()).done);w=!0){var C=T.value,j=!0,M=!1,S=void 0;try{for(var E,I=t.rules[Symbol.iterator]();!(j=(E=I.next()).done);j=!0){var R=E.value;y[R]&&(n=n&&y[R](C))}}catch(e){M=!0,S=e}finally{try{!j&&I.return&&I.return()}finally{if(M)throw S}}if(t.anyRule){var N=!1;for(var A in t.anyRule){var B=t.anyRule[A];y[B]&&(N=N||y[B](C))}n=n&&N}}}catch(e){O=!0,D=e}finally{try{!w&&P.return&&P.return()}finally{if(O)throw D}}return n},deckLength:function(e){return i.default.card.ranks.length<=e.cards.length},not:function(e){return!1},topAce:function(e){var t=y._topCard(e);return t&&t.rank==i.default.card.ranks[0]},topKing:function(e){var t=y._topCard(e),n=i.default.card.ranks.length-1;return t&&t.rank==i.default.card.ranks[n]},bottomAce:function(e){var t=y._bottomCard(e);return t&&t.rank==i.default.card.ranks[0]},bottomKing:function(e){var t=y._bottomCard(e),n=i.default.card.ranks.length-1;return t&&t.rank==i.default.card.ranks[n]},prevDeckTopCardDescStep:function(e){return y._besideTopCard(e,"prev",function(e,t){return e.value==(0|t.value)+1})},prevDeckTopCardAscStep:function(e){return y._besideTopCard(e,"prev",function(e,t){return(0|e.value)+1==t.value})},nextDeckTopCardDescStep:function(e){return y._besideTopCard(e,"next",function(e,t){return e.value==(0|t.value)+1})},nextDeckTopCardAscStep:function(e){return y._besideTopCard(e,"next",function(e,t){return(0|e.value)+1==t.value})},prevDeckTopCardDesc:function(e){return y._besideTopCard(e,"prev",function(e,t){return e.value>t.value})},prevDeckTopCardAsc:function(e){return y._besideTopCard(e,"prev",function(e,t){return e.value<t.value})},nextDeckTopCardDesc:function(e){return y._besideTopCard(e,"next",function(e,t){return e.value>t.value})},nextDeckTopCardAsc:function(e){return y._besideTopCard(e,"next",function(e,t){return e.value<t.value})},recoursivePrevNotEmpty:function(e){return!1},recoursiveNextNotEmpty:function(e){return!1},recoursivePrevDeckTopCardDescStep:function(e){return y._besideTopCardRecoursive(e,"prev",function(e,t){return e.value==(0|t.value)+1})},recoursivePrevDeckTopCardAscStep:function(e){return y._besideTopCardRecoursive(e,"prev",function(e,t){return(0|e.value)+1==t.value})},recoursiveNextDeckTopCardDescStep:function(e){return y._besideTopCardRecoursive(e,"next",function(e,t){return e.value==(0|t.value)+1})},recoursiveNextDeckTopCardAscStep:function(e){return y._besideTopCardRecoursive(e,"next",function(e,t){return(0|e.value)+1==t.value})},recoursivePrevDeckTopCardDesc:function(e){return y._besideTopCardRecoursive(e,"prev",function(e,t){return e.value>t.value})},recoursivePrevDeckTopCardAsc:function(e){return y._besideTopCardRecoursive(e,"prev",function(e,t){return e.value<t.value})},recoursiveNextDeckTopCardDesc:function(e){return y._besideTopCardRecoursive(e,"next",function(e,t){return e.value>t.value})},recoursiveNextDeckTopCardAsc:function(e){return y._besideTopCardRecoursive(e,"next",function(e,t){return e.value<t.value})},descByStep:function(e){return y._deckRecoursive(e,function(e,t){return e.value==(0|t.value)+1})},ascByStep:function(e){return y._deckRecoursive(e,function(e,t){return(0|e.value)+1==t.value})},asc:function(e){return y._deckRecoursive(e,function(e,t){return e.value>t.value})},desc:function(e){return y._deckRecoursive(e,function(e,t){return e.value<t.value})},prevDeckTopCardEquallySuit:function(e){return y._besideTopCard(e,"prev",function(e,t){return e.suit==t.suit})},nextDeckTopCardEquallySuit:function(e){return!1},prevDeckFull:function(e){return f.default.getDeck((0,v.default)(e).prev.to).full},nextDeckFull:function(e){return f.default.getDeck((0,v.default)(e).next.to).full}};t.default=y},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={none:function(e,t,n,a,r){return{x:e.x,y:e.y}},last_three_min:function(e,t,n,a,r){return n>a-3?a>3?{x:e.x-2*(a-3-n),y:e.y-(a-3-n)}:{x:e.x+2*n,y:e.y+(0|n)}:{x:x,y:y}},radial:function(e,t,n,a,r){var i=1,o=n*i,u=e.rotate,l=Math.PI/180,s=Math.sin(u*l)*o,d=Math.cos(u*l)*o;return{x:e.x+s,y:e.y-d}},special:function(e,t,n,a,r){for(var i=e.y,o=e.x,u=0;u<n;u+=1)i+=r[u]&&r[u].flip?e.flip_padding_y:e.padding_y,o+=r[u]&&r[u].flip?e.flip_padding_x:e.padding_x;return{x:o,y:i}},vertical:function(e,t,n,a,r){for(var i=e.y,o=0;o<n;o+=1)i+=r[o]&&r[o].flip?e.flip_padding_y:e.padding_y;var u={x:e.x,y:i};return u},horizontal:function(e,t,n,a,r){for(var i=e.x,o=0;o<n;o+=1)i+=r[o]&&r[o].flip?e.flip_padding_x:e.padding_x;var u={x:i,y:e.y};return u}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(1),u=a(o),l=n(3),s=(a(l),n(5)),d=a(s),f=n(22),c=a(f),p=n(24),v=a(p),y=n(26),h=a(y),m=n(27),k=a(m),g=n(28),_=a(g),b=n(29),x=a(b),w=n(31),O=a(w),D=n(32),T=a(D),P={twindeck:c.default,dealerdeck:v.default,kick:h.default,stepsAround:k.default,changeStepType:_.default,lock:x.default,unlock:O.default,checkFull:T.default},C=[],j=[];i.default.listen("initField",function(e){C=[],j=[]});var M=function(e){i.default.listen(e,function(t){for(var n in C)if(C[n].event==e){var a=C[n].action,r="click"!=e||t.to.name==C[n].deck.name;r&&P[a].run(C[n].deck,{actionData:C[n].deck.actions[a],eventData:t,eventName:e})}},"addActionEvent:"+e)},S=function(e){for(var t in e.actions)e.actions[t].event||(e.actions[t].event="click"),P[t]&&(C.push({deck:e,event:e.actions[t].event,action:t}),u.default.set("actionEvent:"+e.name+":"+e.actions[t].event,!0),!j.indexOf(e.actions[t].event)>=0&&(j.push(e.actions[t].event),M(e.actions[t].event)));E(e)},E=function(e){d.default.animationDefault();for(var t in e.actions)e.actions[t].autorun&&P[t]&&P[t].run(e,{actionData:e.actions[t],eventData:null,eventName:e.actions[t].event})};t.default={add:S}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(23),d=a(s),f=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(d.default);t.default=new f},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=a(o),l=function(){function e(){r(this,e)}return i(e,[{key:"run",value:function(){}},{key:"end",value:function(){u.default.dispatch("stopSession")}},{key:"break",value:function(){}}]),e}();t.default=l},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=a(s),f=n(1),c=a(f),p=n(3),v=a(p),y=n(5),h=a(y),m=n(25),k=a(m),g=n(23),_=a(g),b="dealerdeckStepType",x=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){var a="boolean"!=typeof n.eventData.save||n.eventData.save;if("string"==typeof n.actionData.stepType&&n.actionData.stepType!=c.default.get("stepType"))return void l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this);c.default.set("stepType",b);var r="string"==typeof n.actionData.from?Deck.getDeck(n.actionData.from):e;if(0==r.cards.length)return c.default.set("stepType",v.default.stepType),d.default.dispatch("actionBreak"),void this.end();var i=[];if(n.actionData.toGroup&&!n.actionData.to&&(n.actionData.to=n.actionData.toGroup),n.actionData.to)if("string"==typeof n.actionData.to){var o=h.default.getElementsByName(n.actionData.to);for(var u in o){if("group"==o[u].type)for(var s in o[u].decks)i.push(o[u].decks[s]);"deck"==o[u].type&&i.push(_el)}}else for(var f in n.actionData.to){var p=h.default.getElementsByName(n.actionData.to[f]);for(var y in p){if("group"==p[y].type)for(var m in p[y].decks)i.push(p[y].decks[m]);"deck"==p[y].type&&i.push(p[y])}}h.default.animationDefault();var g=!1;for(var _ in i){var x=r.getTopCard(),w=!n.actionData.onlyEmpty||0==i[_].cards.length;w&&x&&!function(){g=!0;var e=x.name,t=!1,a=function(e){t||d.default.dispatch("checkTips")};d.default.once("clearCallbacks",function(e){t=!0}),(0,k.default)({from:r.name,to:i[_].name,deck:[e],flip:!0,callback:a},!0),i[_].flipCheck(),d.default.dispatch("dealEnd"),d.default.dispatch("addStep",{move:{from:r.name,to:i[_].name,deck:[e],flip:!0,stepType:{undo:c.default.get("stepType"),redo:n.actionData.dispatch?c.default.get("stepType"):v.default.stepType},context:"dealerdeckAction"}})}()}g&&a&&d.default.dispatch("saveSteps","DEALERDECKACTION"),n.actionData.dispatch?d.default.dispatch(n.actionData.dispatch,!g):(this.end(),c.default.set("stepType",v.default.stepType))}},{key:"end",value:function(){d.default.dispatch("dealEnd"),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(_.default);t.default=new x},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(1),u=(a(o),n(5)),l=(a(u),n(14)),s=a(l),d=n(9),f=(a(d),function(e){if(e.from&&e.to&&e.deck&&e.deck.length){var t="string"==typeof e.from?s.default.getDeck(e.from):e.from,n="string"==typeof e.to?s.default.getDeck(e.to):e.to;if(t&&"deck"==t.type&&n&&"deck"==n.type){var a=!0,r=t.cards;for(var o in r)if(o>=r.length-e.deck.length){var u=o-(0|r.length)+(0|e.deck.length);e.deck[u]&&r[o].name!=e.deck[u]&&(a=!1)}if(a){var l=t.Pop(e.deck.length);if(e.flip)for(var d in l)l[d].flip=!l[d].flip;n.Push(l);var f=[];for(var c in l)f.push({card:l[c]});var p={moveDeck:f,departure:t,destination:n};"function"==typeof e.callback?(p.callback=function(t){i.default.dispatch("forceMoveEnd"),e.callback()},p.debug="from:forceMove"):p.callback=function(e){i.default.dispatch("forceMoveEnd")},i.default.dispatch("moveDragDeck",p)}}}});i.default.listen("forceMove",function(e){f(e)}),t.default=f},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=a(s),f=n(1),c=a(f),p=n(5),v=a(p),y=n(3),h=a(y),m=n(23),k=a(m),g="kickStepType",_=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._actionName="kickAction",e}return o(t,e),u(t,[{key:"run",value:function(e,n){var a=this;if(c.default.get("stepType")!=h.default.stepType)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;if("string"==typeof n.eventData.stepType&&n.eventData.stepType!=h.default.stepType)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;if(n.eventData.to.name!=e.name)return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this),!1;c.default.set("stepType",g),v.default.animationDefault();var r=n.eventData.to,i=r.getCardsNames(),o=function(e){var o=function(e){d.default.dispatch("addStep",{move:{from:r.name,to:n.actionData.to,deck:i,flip:!0,stepType:{undo:e.undo,redo:e.redo},context:"kickAction"}})};c.default.set("stepType",h.default.stepType),n.actionData.dispatch?(d.default.dispatch("kick:end"),d.default.dispatch(n.actionData.dispatch,{before:function(e){o({undo:g,redo:e.stepType}),d.default.dispatch("saveSteps","KICKACTION#1")}})):(d.default.dispatch("kick:end"),o({undo:g,redo:n.actionData.dispatch?c.default.get("stepType"):h.default.stepType}),d.default.dispatch("saveSteps","KICKACTION#2"),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",a).call(a))},u={from:r,to:n.actionData.to,deck:i,flip:!0,callback:o};d.default.dispatch("forceMove",u)}}]),t}(k.default);t.default=new _},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=a(s),f=n(1),c=a(f),p=n(5),v=a(p),y=n(3),h=a(y),m=n(23),k=a(m),g=n(9),_=a(g),b=n(14),x=(a(b),"stepsAround"),w=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){var a=this,r=c.default.get("stepType");if(r!=h.default.stepType)return void l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"break",this).call(this);c.default.set("stepType",x),v.default.curLock();var i=e.getRelationsByName("around",{from:null});if("string"==typeof n.actionData.run)!function(){var t="boolean"!=typeof n.actionData.central||n.actionData.central,r=[];for(var o in i)_.default.fromTo(e.name,i[o].to)&&r.push(i[o]);var u=r.length,l=function(e){u-=1,0===u&&a.end()};0===u?a.end():t&&(u+=1,d.default.dispatch(n.actionData.run,{to:e.name,callback:l}));for(var s in r){var f=null;try{f=Object.assign({},r[s])}catch(e){f=r[s]}f.callback=l,d.default.dispatch(n.actionData.run,f)}}();else{var o=function(e){c.default.get("stepType")==x&&a.end()};d.default.listen("makeStep",o)}}},{key:"end",value:function(){c.default.set("stepType",h.default.stepType),v.default.curUnLock(),data.actionData.dispatch&&d.default.dispatch(data.actionData.dispatch,data.eventData),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(k.default);t.default=new w},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=(a(s),n(1)),f=a(d),c=n(3),p=(a(c),n(5)),v=(a(p),n(23)),y=a(v),h=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){return n.eventData.to.name==e.name&&("string"!=typeof n.actionData.to?void l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this):(l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this),void f.default.set("stepType",n.actionData.to)))}}]),t}(y.default);t.default=new h},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=(a(s),n(1)),f=(a(d),n(3)),c=(a(f),n(5)),p=(a(c),n(23)),v=a(p),y=n(30),h=a(y),m=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){return n.eventData.to.name==e.name&&((0,h.default)(n.actionData,"lock",e.name),void l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this))}}]),t}(v.default);t.default=new m},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(1),u=(a(o),n(3)),l=(a(u),n(5)),s=a(l);t.default=function(e,t,n){var a=[];if("string"!=typeof e.source)if(e.source&&e.source.constructor==Array)for(var r in e.source)a.push(e.source[r]);else a=[n];else a=[e.source];if(e.save){var o={};o[t]=a,i.default.dispatch("addStep",o),i.default.dispatch("saveSteps","LOCKACTIONCOMMON")}for(var u in a){var l=s.default.getElementsByName(a[u])[0];if("group"==l.type){var d=l.getDecks();for(var f in d)d[f][t]()}"deck"==l.type&&l[t]()}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=(a(s),n(1)),f=(a(d),n(3)),c=(a(f),n(5)),p=(a(c),n(23)),v=a(p),y=n(30),h=a(y),m=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){return n.eventData.to.name==e.name&&((0,h.default)(n.actionData,"unlock",e.name),void l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this))}}]),t}(v.default);t.default=new m},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(2),d=a(s),f=n(13),c=a(f),p=n(23),v=a(p),y=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),u(t,[{key:"run",value:function(e,n){if(n.eventData.to.name!=e.name&&!n.actionData.any)return!1;if(n&&n.actionData&&n.actionData.query){var a=n.actionData.query,r=[];if(a.groups){var i=a.select?a.select:"all",o=!0,u=!1,s=void 0;try{for(var f,p=a.groups[Symbol.iterator]();!(o=(f=p.next()).done);o=!0){var v=f.value,y=c.default.getByName(v);if("first"==i){var h=y.getDeckByIndex(1);h&&r.push(h)}else if("last"==i){var m=y.decksCount,k=y.getDeckByIndex(m);if(k){var g=y.decksCount,_=y.getDeckByIndex(g);r.push(_)}}else if("all"==i){var b=y.getDecks();r=r.concat(b)}}}catch(e){u=!0,s=e;
}finally{try{!o&&p.return&&p.return()}finally{if(u)throw s}}}if(a.decks){var x=!0,w=!1,O=void 0;try{for(var D,T=a.decks[Symbol.iterator]();!(x=(D=T.next()).done);x=!0){var P=D.value,C=Deck.getByName(P);C&&r.push(C)}}catch(e){w=!0,O=e}finally{try{!x&&T.return&&T.return()}finally{if(w)throw O}}}for(var j in r){var M=r[j];M.checkFull()&&M.Redraw()}}d.default.dispatch("saveSteps","CHECKFULLACTION"),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this)}}]),t}(v.default);t.default=new y},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=(a(r),n(3)),o=a(i),u=n(5),l=a(u),s=n(18),d=a(s);t.default=function(e,t){var n=!0;//!common.isLock();
n=n&&!e.locked,"boolean"==typeof e.full&&(n=n&&!e.full);var a=-1,r=null,i=null,u=null,s=e.cards.length,f=[];for(var c in e.cards){if(e.cards[c].id==t){a=0|c,r=e.cards[c].name;var p=l.default.validateCardName(r);n=n&&p,p&&(i=p.suit,u=p.rank),n=n&&!e.cards[c].flip&&e.cards[c].flip==o.default.canMoveFlip}a>=0&&f.push({index:c,card:e.cards[c]})}var v={cardId:t,cardName:r,cardSuit:i,cardRank:u,cardIndex:a,deckLength:s};for(var y in e.takeRules){var h=e.takeRules[y];n=!!d.default[h]&&(n&&d.default[h](v))}return n=n&&a>=0,n=n&&f}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),o=n(3),u=a(o),l=n(12),s=a(l),d=n(14),f=a(d),c=n(16),p=a(c);t.default=function(e,t){var n=i.default.get("stepType"),a=!0,r=t[0].card.parent,o=f.default.getDeckById(r);if(a=a&&!e.locked,n!=u.default.stepType)a=!!(a&&s.default.autoSteps&&s.default.autoSteps[n])&&s.default.autoSteps[n].manual({putDeck:t,to:e});else{var l=null,d=e;for(var c in e.putRules)if(a){l&&(d=f.default.getDeck(l));var v=e.putRules[c];if(p.default[v]){var y={from:{deckId:r,deck:o},putDeck:t,cards:d.cards,to:d,link:l};a=a&&p.default[v](y),l=y.link}else a=!1}}return a}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(1),u=a(o),l=n(5),s=a(l);t.default=function(e,t){var n=s.default.validateCardName(t);if(n){var a="card_"+s.default.genId(),r={id:a,name:t,type:"card",visible:!0,flip:!1,parent:e.id};i.default.dispatch("addCardEl",r);var o=u.default.get("elements");return o[a]=r,u.default.set("elements",o),e.Push([r]),e.flipCheck(),e.Redraw(),r}return!1}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[];for(var n in e)e[n].card&&e[n].card.name?t.push(e[n].card.name):e[n].name&&t.push(e[n].name);return t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=a(r);t.default=function(e,t){var n=i.default.getElementsByName(e,"deck");if(t&&"string"==typeof t){for(var a in n){var r=i.default.getElementById(n[a].parent());if(r&&r.name&&r.name==t)return n[a]}return!1}return n[0]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[],a=0;for(var r in e.decks)a+=1,n.push(null);for(var i in e.decks)e.decks[i].groupIndex&&e.decks[i].groupIndex<=a&&(n[e.decks[i].groupIndex-1]=!0);for(var o in e.decks)if(!e.decks[o].groupIndex){for(var u=0;null!=n[u];u+=1);n[u]=e.decks[o].id}for(var l in e.decks)e.decks[l].groupIndex&&e.decks[l].groupIndex<=a&&(n[e.decks[l].groupIndex-1]=e.decks[l].id);var s={};for(var d in e.decks)e.decks[d].groupIndex&&e.decks[d].groupIndex>a&&(s[e.decks[d].groupIndex-1]=e.decks[d].id);for(var f in s){for(var c=0;null!=n[c];c+=1);n[c]=e.decks[s[f]].id}var p=!0;for(var v in t)p=p&&"string"==typeof t[v];if(p)for(var y in t){var h=n[y%n.length];e.decks[h].genCardByName(t[y])}else for(var m in t)m<n.length&&e.decks[n[m]].Fill(t[m])}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=a(r);t.default=function(e,t){if(e&&t){var n=e.getDecks();void 0!==t.decks&&"number"!=typeof t.decks||(t.decks=[]);for(var a in n)t.decks[a]||(t.decks[a]={}),t.position&&t.decks[a].parentPosition&&(t.decks[a].parentPosition={x:t.position.x,y:t.position.y}),"number"==typeof t.paddingX&&(t.decks[a].paddingX=t.paddingX),"number"==typeof t.paddingY&&(t.decks[a].paddingY=t.paddingY),"number"==typeof t.flipPaddingX&&(t.decks[a].flipPaddingX=t.flipPaddingX),"number"==typeof t.flipPaddingY&&(t.decks[a].flipPaddingY=t.flipPaddingY),void 0===t.decks[a].position&&(t.decks[a].position={}),t.decks[a].parentPosition={},"number"==typeof t.rotate&&(t.decks[a].parentRotate=t.rotate),t.position&&"number"==typeof t.position.x&&(t.decks[a].parentPosition.x=t.position.x),t.position&&"number"==typeof t.position.y&&(t.decks[a].parentPosition.y=t.position.y),t.placement&&(t.placement.x&&(t.decks[a].position.x=(t.placement.x+i.default.card.width)*a),t.placement.y&&(t.decks[a].position.y=(t.placement.y+i.default.card.height)*a)),!t.decks[a].rotate&&t.rotate&&"number"==typeof t.rotate&&(t.decks[a].rotate=t.rotate),!t.decks[a].paddingX&&t.paddingX&&"number"==typeof t.paddingX&&(t.decks[a].paddingX=t.paddingX),!t.decks[a].paddingY&&t.paddingY&&"number"==typeof t.paddingY&&(t.decks[a].paddingY=t.paddingY),!t.decks[a].flipPaddingX&&t.flipPaddingX&&"number"==typeof t.flipPaddingX&&(t.decks[a].flipPaddingX=t.flipPaddingX),!t.decks[a].flipPaddingY&&t.flipPaddingY&&"number"==typeof t.flipPaddingY&&(t.decks[a].flipPaddingY=t.flipPaddingY),n[a].Redraw(t.decks[a])}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=a(r),o=n(42),u=a(o),l=n(43),s=a(l),d=n(50),f=a(d),c=n(51),p=a(c);t.default={count:i.default,fan:u.default,map:s.default,line:f.default,rhombus:p.default}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=t.count,a=[],r=0;r<n;r+=1){var i=e.name+"_deck"+(r+1);a.push({name:i})}return a}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=a(r);t.default=function(e,t){e.placement={x:0,y:0};for(var n=[],a="number"==typeof t.count?t.count:3,r="number"==typeof t.radius?t.radius:100,o=180/a,u=o/2+270,l=Math.PI/180,s=void 0!==t.center&&void 0!==t.center.x&&void 0!==t.center.y?t.center:{x:0,y:0},d=0;d<a;d+=1){var f=Math.sin(u*l)*r,c=Math.cos(u*l)*r;u>360&&(u-=360),n.push({name:e.name+"_deck"+d,rotate:u,position:{x:s.x+f-i.default.card.width/2,y:s.y-c-i.default.card.height/2}}),u+=o}return n}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=a(r),o=n(44),u=a(o),l=n(46),s=a(l);t.default=function(e,t){var n=[],a={x:0,y:0},r=e.placement?{x:void 0!==e.placement.x?e.placement.x:a.x,y:void 0!==e.placement.y?e.placement.y:a.y}:a;e.placement={x:0,y:0};var o=1,l=s.default.mapSize(t.map);for(var d in t.map)for(var f in t.map[d])("boolean"==typeof t.map[d][f]&&t.map[d][f]||"number"==typeof t.map[d][f]&&t.map[d][f]>0)&&(t.map[d][f]={}),"string"==typeof t.map[d][f]?t.map[d][f]={name:t.map[d][f]}:t.map[d][f]&&void 0!==t.map[d][f]&&"string"!=typeof t.map[d][f].name&&(t.map[d][f].name=e.name+"_deck_"+f+"_"+d);for(var c in t.map)for(var p in t.map[c]){var v=0|p,y=0|c,h=t.map[y][v];if(h){var m={name:t.map[y][v].name,position:{x:v*((0|i.default.card.width)+(0|r.x)),y:y*((0|i.default.card.height)+(0|r.y))}},k=[],g={around:"mapAroundRelations",beside:"mapBesideRelations",fall:"mapFallRelations"};if(t.relations)for(var _ in g)t.relations[_]&&(k=k.concat(u.default[g[_]]({x:v,y:y,map:t.map,mapSize:l,el:h,data:t.relations[_]})));m.relations=k,n.push(m),o+=1}}return n}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),i=a(r),o=n(47),u=a(o),l=n(48),s=a(l),d=n(49),f=a(d);t.default={mapFallRelations:i.default,mapAroundRelations:u.default,mapBesideRelations:s.default,lineBesideRelations:f.default}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),i=a(r),o=[{left:"right"},{right:"left"},{up:"down"},{down:"up"}];t.default=function(e){var t=[],n=[];for(var a in e.data.directions)!n.indexOf(e.data.directions[a])>=0&&!n.indexOf(o[e.data.directions[a]])>=0&&n.push(e.data.directions[a]);for(var r in n){var u=null,l=null;switch(n[r]){case"left":u=(0|e.x)+i.default.beSide.left.x,l=(0|e.y)+i.default.beSide.left.y,i.default.exist(u,l,e.mapSize,e.map)&&t.push({name:"fall",direction:"left",to:e.map[l][u].name});break;case"right":u=(0|e.x)+i.default.beSide.right.x,l=(0|e.y)+i.default.beSide.right.y,i.default.exist(u,l,e.mapSize,e.map)&&t.push({name:"fall",direction:"right",to:e.map[l][u].name});break;case"up":u=(0|e.x)+i.default.beSide.up.x,l=(0|e.y)+i.default.beSide.up.y,i.default.exist(u,l,e.mapSize,e.map)&&t.push({name:"fall",direction:"up",to:e.map[l][u].name});break;case"down":u=(0|e.x)+i.default.beSide.down.x,l=(0|e.y)+i.default.beSide.down.y,i.default.exist(u,l,e.mapSize,e.map)&&t.push({name:"fall",direction:"down",to:e.map[l][u].name})}}return t}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1},down:{x:0,y:1}},a=function(e,t,n){return e>=0&&t>=0&&e<n.width&&t<n.height},r=function(e,t,n,r){return a(e,t,n)&&r[t][e]},i=function(e){var t={width:e[0].length,height:e.length};return e.forEach(function(e){t.width=Math.max(t.width,e.length)}),t},o=[{x:-1,y:-1,type:"corn",id:"clt"},{x:0,y:-1,type:"side",id:"top"},{x:1,y:-1,type:"corn",id:"crt"},{x:-1,y:0,type:"side",id:"lft"},{x:1,y:0,type:"side",id:"rgt"},{x:-1,y:1,type:"corn",id:"clb"},{x:0,y:1,type:"side",id:"btm"},{x:1,y:1,type:"corn",id:"crb"}];t.default={beSide:n,mapSize:i,inMap:a,aroundRelations:o,exist:r}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),i=a(r);t.default=function(e){var t=[];for(var n in i.default.aroundRelations)i.default.inMap(e.x+i.default.aroundRelations[n].x,e.y+i.default.aroundRelations[n].y,e.mapSize)&&e.map[e.y+i.default.aroundRelations[n].y][e.x+i.default.aroundRelations[n].x]&&t.push({to:e.map[e.y+i.default.aroundRelations[n].y][e.x+i.default.aroundRelations[n].x].name,type:i.default.aroundRelations[n].type,id:i.default.aroundRelations[n].id,name:"around"});return t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(46);a(r);t.default=function(e){var t=[];return t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(46);a(r);t.default=function(e){var t=[],n=e.deckIndex>0?e.decks[(0|e.deckIndex)-1].name:null;n&&t.push({name:"beside",type:"prev",to:n});var a=e.deckIndex<e.count-1?e.decks[(0|e.deckIndex)+1].name:null;return a&&t.push({name:"beside",type:"next",to:a}),t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=a(r);t.default=function(e,t){for(var n=t.count,a=[],r=0;r<n;r+=1){var o=e.name+"_deck"+(r+1),u={name:o};a.push(u)}if(a[0].tags=["first"],t.first){var l=a[0];for(var s in t.first)l[s]=t.first[s]}if(a[1]&&(a[1].tags=["second"]),a[a.length-1].tags=["last"],t.last){var d=a[a.length-1];for(var f in t.last)d[f]=t.last[f]}for(var c in a){var p=[],v={beside:"lineBesideRelations"};if(t.relations)for(var y in v)t.relations[y]&&(p=p.concat(i.default[v[y]]({deckIndex:c,count:n,decks:a,data:t.relations[y]})));a[c].relations=p}return a}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=a(r),o={fallAutoStep:i.default};t.default=function(e){var t={};for(var n in e)if(o[n]){var a=new o[n](e[n]);a.init(n),t[n]=a}return t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},s=n(1),d=(a(s),n(3)),f=(a(d),n(2)),c=(a(f),n(54)),p=a(c),v=n(14),y=a(v),h=n(9),m=a(h),k=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._name="fall",n.manualPossibleMoves=0,n}return o(t,e),u(t,[{key:"check",value:function(){m.default.checkTips();var e=m.default.getTips();0==e.length&&this.end()}},{key:"auto",value:function(){}},{key:"manual",value:function(e){var t=y.default.getDeckById(e.putDeck[0].card.parent),n=e.to,a=t.getRelationsByName("fall",{from:null});for(var r in a)if(a[r].to==n.name&&0===n.cardsCount())return this.manualPossibleMoves+=1,!0;return!1}},{key:"end",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this,{save:this.manualPossibleMoves>0})}}]),t}(p.default);t.default=k},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=a(o),l=n(1),s=a(l),d=n(5),f=a(d),c=n(3),p=a(c),v=function(){function e(t){r(this,e),void 0!==t.groups&&(this.groups=t.groups),"string"==typeof t.event&&(this.event=t.event),"string"==typeof t.dispatch&&(this.dispatch=t.dispatch),"boolean"==typeof t.autoStep&&(this.autoStep=t.autoStep)}return i(e,[{key:"start",value:function(e){this.autoStep||u.default.dispatch("stopSession"),s.default.set("autoStep:stepType",this.stepType),e&&"function"==typeof e.before&&e.before({stepType:this.stepType}),s.default.set("stepType",this.stepType),this.autoStep?(f.default.curLock(),this.auto()):this.check()}},{key:"end",value:function(e){if(s.default.set("stepType",p.default.stepType),this.dispatch){var t={stepType:s.default.get("stepType")};if(e)for(var n in e)t[n]=e[n];u.default.dispatch(this.dispatch,t)}else u.default.dispatch("stopSession");s.default.delete("autoStep:stepType")}},{key:"init",value:function(e){var t=this;this.stepType=e,this.event&&u.default.listen(this.event,function(e){t.start(e)}),this.autoStep||u.default.listen("moveEnd",function(e){s.default.get("stepType")==t.stepType&&t.check()},"addAutoStepEvent:"+this.event)}}]),e}();t.default=v},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e);try{localStorage.hasOwnProperty("SolitaireEngine")||(localStorage.SolitaireEngine="{}")}catch(e){}}return a(e,[{key:"set",value:function(e,t){try{var n=JSON.parse(localStorage.SolitaireEngine);n[e]=t;var a=JSON.stringify(n);localStorage.SolitaireEngine=a}catch(e){}}},{key:"get",value:function(e){try{var t=JSON.parse(localStorage.SolitaireEngine);return t[e]}catch(e){return null}}},{key:"clear",value:function(){try{localStorage.SolitaireEngine="{}"}catch(e){}}}]),e}();t.default=new r},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=a(o),l=n(1),s=a(l),d=n(5),f=a(d),c=n(3),p=a(c),v=n(6),y=a(v),h=n(25),m=a(h),k=n(14),g=(a(k),n(9)),_=a(g),b=n(12),x=(a(b),n(4)),w=a(x),O=function(e){if(s.default.get("sessionStarted")&&(u.default.dispatch("stopAnimations","HISTORY#1"),y.default.restore()),void 0!==e.lock)for(var t in e.lock){var n=f.default.getElementsByName(e.lock[t])[0];n.unlock()}if(void 0!==e.unlock)for(var a in e.unlock){var r=f.default.getElementsByName(e.unlock[a])[0];r.lock()}if(void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck){s.default.get("movesAnimation");e.move.stepType&&("string"==typeof e.move.stepType&&s.default.set("stepType",e.move.stepType),"string"==typeof e.move.stepType.undo&&s.default.set("stepType",e.move.stepType.undo));var i={from:e.move.to,to:e.move.from,deck:e.move.deck,flip:e.move.flip};s.default.get("showHistoryAnimation")||(f.default.animationOff(),i.callback=function(e){f.default.animationOn()}),(0,m.default)(i)}};u.default.listen("undo",function(e){if(e){if(w.default.break(),P.reset(),s.default.get("animation")&&u.default.dispatch("stopAnimations","HISTORY#2"),e instanceof Array){e.reverse();for(var t in e){var n=e[t];O(n)}e.reverse()}else O(e);_.default.checkTips()}});var D=function(e){if(s.default.get("sessionStarted")&&(u.default.dispatch("stopAnimations","HISTORY#2"),y.default.restore()),void 0!==e.lock)for(var t in e.lock){var n=f.default.getElementsByName(e.lock[t])[0];n.lock()}if(void 0!==e.unlock)for(var a in e.unlock){var r=f.default.getElementsByName(e.unlock[a])[0];r.unlock()}if(void 0!==e.move&&void 0!==e.move.from&&void 0!==e.move.to&&void 0!==e.move.deck){e.move.stepType&&("string"==typeof e.move.stepType&&s.default.set("stepType",e.move.stepType),"string"==typeof e.move.stepType.redo&&s.default.set("stepType",e.move.stepType.redo));var i={from:e.move.from,to:e.move.to,deck:e.move.deck,flip:e.move.flip};s.default.get("showHistoryAnimation")||(f.default.animationOff(),i.callback=function(e){f.default.animationOn()}),(0,m.default)(i)}e.redo&&"string"==typeof e.redo.stepType&&s.default.set("stepType",e.redo.stepType)};u.default.listen("redo",function(e){if(w.default.break(),P.reset(),s.default.get("animation")&&u.default.dispatch("stopAnimations","HISTORY#4"),e){if(e instanceof Array)for(var t in e){var n=e[t];D(n)}else D(e);_.default.checkTips(),s.default.get("stepType")!=p.default.stepType&&0==_.default.getTips().length&&(s.default.set("stepType",p.default.stepType),_.default.checkTips())}});var T=function(){function e(){r(this,e),this.steps=[]}return i(e,[{key:"reset",value:function(e){this.steps=[]}},{key:"add",value:function(e){this.steps.push(e)}},{key:"get",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.steps;return e&&this.reset(!0),t}},{key:"log",value:function(){}},{key:"count",value:function(){return this.steps.length}}]),e}(),P=new T;u.default.listen("addStep",function(e){e.debug&&delete e.debug,P.add(e)}),u.default.listen("saveSteps",function(e){var t=P.get();t.length&&u.default.dispatch("makeStep",t)}),u.default.listen("doHistory",function(e){for(var t in e.data)u.default.dispatch("redo",e.data[t]),"function"==typeof e.callback&&e.callback(e.data[t])}),t.default=P},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);a(r);t.default=function(e){var t=n(58);$("#gpCommit").parent().before(t)}},function(e,t){e.exports="<div id=solitaire-engine-style-preferences> <h4>Настройки оформления</h4> <div> <span class=solitaire-engine-style-preferences-label>Фон:</span> <label> <input type=radio name=pref_field value=default_field> Классический </label> <label> <input type=radio name=pref_field value=alternative_field> Альтернативный </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Лицевая сторона:</span> <label> <input type=radio name=pref_face value=default_face> Классическая </label> <label> <input type=radio name=pref_face value=alternative_face> Англо-американская </label> </div> <div> <span class=solitaire-engine-style-preferences-label>Рубашка:</span> <label> <input type=radio name=pref_back value=default_back> Классическая </label> <label> <input type=radio name=pref_back value=alternative_back> Альтернативная </label> </div> <div id=gamePreferences></div> </div>"},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),o=n(2),u=a(o),l=n(3),s=a(l),d=n(55),f=a(d),c=n(60),p=a(c),v=function(e){var t=f.default.get("pref");!t&&(t=s.default.pref);for(var n in s.default.themes){var a=t[n]&&s.default.themes[n].indexOf(t[n])>=0?t[n]:s.default.pref[n];$("input[name='pref_"+n+"'][value='"+a+"']").prop({checked:!0})}p.default.show(t)},y=function(e){var t={};for(var n in s.default.themes){var a=$("input[name='pref_"+n+"']:checked").val();a="true"==a||"false"!=a&&a,t[n]=a}u.default.dispatch("fieldThemesSet",t),p.default.get(t),h(t);var r=i.default.get("changePreferencesCallback");if("function"==typeof r){var o=t;r(o)}},h=function(e){f.default.set("pref",e)};t.default=function(e){$("#bbParameters").click(v),$("#parametersPanel").on("change","input",y)}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),u=a(o),l=function(){function e(){r(this,e),this.exist=!1}return i(e,[{key:"draw",value:function(){if(!this.exist){var e=u.default.get("gamePreferences");for(var t in e){var n=$("<div>").append($("<span>").addClass("solitaire-engine-style-preferences-label").html(e[t].title));for(var a in e[t].options)$(n).append($("<label>").append($("<input>").prop({type:"radio",name:"gamePref_"+t,value:e[t].options[a].value})).append(e[t].options[a].title));$("#gamePreferences").append(n)}this.exist=!0}}},{key:"show",value:function(e){this.draw();var t=u.default.get("gamePreferences");for(var n in t)e&&void 0!==e[n]?$("input[name='gamePref_"+n+"'][value='"+e[n]+"']").prop({checked:!0}):$("input[name='gamePref_"+n+"'][value='"+t[n].value+"']").prop({checked:!0})}},{key:"get",value:function(e){var t=u.default.get("gamePreferences");for(var n in t){var a=$("input[name='gamePref_"+n+"']:checked").val();a="true"==a||"false"!=a&&a,e[n]=a}}}]),e}();t.default=new l},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=a(r),o=n(3),u=a(o),l=n(55),s=a(l);t.default=function(e){var t=s.default.get("pref");!t&&(t=u.default.pref);for(var n in t)u.default.themes[n]&&!u.default.themes[n].indexOf(t[n])>=0&&(t[n]=u.default.pref[n]);i.default.dispatch("fieldThemesSet",t)}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(3),s=a(l),d=n(5),f=a(d),c=n(14),p=a(c),v=n(9),y=a(v),h=n(11),m=a(h),k=n(63),g=a(k),_=n(12),b=a(_),x=function e(t,n,a){f.default.animationDefault();var r=t[0].card.parent&&f.default.getElementById(t[0].card.parent),o=null,l=!0,d=u.default.get("stepType");if(!a.dbclick&&0===a.distance&&u.default.get("moveDistance")>0&&d==s.default.stepType)return!1;if(d!=s.default.stepType&&(b.default.autoSteps&&!b.default.autoSteps[d]||!b.default.autoSteps)){var c=t[0].card.parent&&f.default.getElementById(t[0].card.parent);return void i.default.dispatch("moveCardToHome",{moveDeck:t,departure:c,stepType:u.default.get("stepType")})}i.default.dispatch("startSession",{type:"move"}),l=l&&n;var v=null;if(l&&(v=f.default.getElementById(n)),l=l&&v,l&&("card"==v.type?o=f.default.getElementById(v.parent):"deck"==v.type&&(o=v)),l=l&&o,l=l&&r,l=l&&o.id!=r.id){var h=o.Put(t);if(l=l&&h,h){var k=r.Pop(t.length);if(l=l&&k,k){o.Push(k),f.default.animationDefault();var _=!1;for(var x in o.actions)"moveEnd"==o.actions[x].event&&(_=!0);i.default.dispatch("addStep",{move:{from:r.name,to:o.name,deck:p.default.deckCardNames(t),stepType:{undo:d,redo:d},context:"move"}});var w=function(e){i.default.has("actionEvent:moveEnd:"+o.name,{tag:i.default.tags.inGame})&&u.default.get("autoStep:stepType")!=u.default.get("stepType")||i.default.dispatch("stopSession"),y.default.checkTips();var n=y.default.getTips();(o.save||n.length>0&&d!=s.default.stepType)&&i.default.dispatch("saveSteps","MOVE"),i.default.dispatch("moveEnd:"+u.default.get("stepType")),i.default.dispatch("moveEnd",{from:r,to:o,moveDeck:t,stepType:u.default.get("stepType"),before:function(e){e&&"string"==typeof e.stepType&&i.default.dispatch("addStep",{redo:{stepType:e.stepType}})}}),g.default.winCheck({show:!0})};i.default.dispatch("moveDragDeck",{departure:r,destination:o,moveDeck:t,callback:w})}}}if(!l&&r)if(b.default.inputParams.doubleClick&&a.dbclick||a.distance>=u.default.get("moveDistance")){var O=(0,m.default)(t,a);if(O)return void e(t,O.to.deck.id,a);i.default.dispatch("moveCardToHome",{moveDeck:t,departure:r}),i.default.dispatch("stopSession")}else i.default.dispatch("moveCardToHome",{moveDeck:t,departure:r}),i.default.dispatch("stopSession")};i.default.listen("Move",function(e){x(e.moveDeck,e.to,e.cursorMove)}),i.default.listen("autoStepToHome",function(e){y.default.getTips()})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=a(r),o=n(2),u=a(o),l=n(5),s=(a(l),n(64)),d=a(s),f=n(14),c=a(f),p=function(e){var t=!0,n=!1,a=i.default.get("winCheck");if(!a)return!1;var r=a.rules?a.rules:a;for(var o in r){var l=1==o.length&&o|!0?r[o]:o;if(n=!0,d.default[l]){var s=d.default[l]({decks:c.default.getDecks({visible:!0}),rulesArgs:r[l]});t&=s}else t&=d.default.newerWin()}return n||(t&=d.default.newerWin()),!!t&&(!(!e||!e.noCallback)||(u.default.dispatch("win",e),!0))},v=function(e){e||(e={}),void 0===e.show&&(e.show=!1),p(e)};t.default={winCheck:p,hwinCheck:v}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=a(r),o=n(3),u=a(o),l={group:function(e){if(!e.filter||!e.filterArgs)return!1;var t=[];for(var n in e.decks)("string"==typeof e.filterArgs&&e.decks[n].parent==e.filterArgs||e.filterArgs.length&&e.filterArgs.indexOf(e.decks[n].parent)>=0)&&t.push(e.decks[n]);return e.decks=t,t.length},groups:function(e){return l.group(e)},select:function(e){var t=[],n=!0,a=!1,r=void 0;try{for(var i,o=e.decks[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;u.tags.indexOf(e.filterArgs)>=0&&t.push(u)}}catch(e){a=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return e.decks=t,t.length},deck:function(e){if(!e.filter||!e.filterArgs)return!1;var t=[];for(var n in e.decks)("string"==typeof e.filterArgs&&e.decks[n].name==e.filterArgs||e.filterArgs.indexOf(e.decks[n].name)>=0)&&t.push(e.decks[n]);return e.decks=t,t.length},decks:function(e){return l.deck(e)},firstEmpty:function(e){var t=[];for(var n in e.decks)e.decks[n].tags.indexOf("last")>=0&&t.push(e.decks[n]);return e.decks=t,t.length},_asc_desk:function(e){if(!e||"number"!=typeof e.asc_desk)return!1;var t=!0;for(var n in e.decks){if(!t)return!1;var a=e.decks[n].cards;for(var r in a)if(r>0){var o=i.default.validateCardName(a[(0|r)-1].name),l=i.default.validateCardName(a[0|r].name),s=u.default.card.ranks;t=t&&o&&l&&s.indexOf(o.rank)==s.indexOf(l.rank)+e.asc_desk}}return t},newerWin:function(e){return!1},allEmpty:function(e){var t=!0;for(var n in e.decks)t=t&&0==e.decks[n].cards.length;return t},empty:function(e){l.allEmpty(e)},allInOne:function(e){var t=0,n=0,a=0;for(var r in e.decks)0==e.decks[r].cards.length?t+=1:a=r,n+=1;var i=t==n-1;return e.filter&&(e.decks=i?[e.decks[a]]:[]),i},allAscend:function(e){return e.asc_desk=-1,l._asc_desk(e)},allDescent:function(e){return e.asc_desk=1,l._asc_desk(e)},topKing:function(e){for(var t in e.decks){var n=e.decks[t],a=n.getTopCard(),r=i.default.validateCardName(a.name).rank;if(void 0!==r&&r!=u.default.card.ranks[u.default.card.ranks.length-1])return!1}return!0},topAce:function(e){return!1},query:function(e){if(!e||!e.rulesArgs)return!1;var t=!0;for(var n in e.rulesArgs){var a={};for(var r in e.decks)a[r]=e.decks[r];var i={decks:a};if(t&&e.rulesArgs[n].filters){i.filter=!0;for(var o in e.rulesArgs[n].filters)if("string"==typeof e.rulesArgs[n].filters[o]&&l[e.rulesArgs[n].filters[o]])i.filterArgs=null,t=t&&l[e.rulesArgs[n].filters[o]](i);else if(e.rulesArgs[n].filters[o]&&""+e.rulesArgs[n].filters[o]=="[object Object]")for(var u in e.rulesArgs[n].filters[o])l[u]?(i.filterArgs=e.rulesArgs[n].filters[o][u],t=t&&l[u](i)):t=t&&l.newerWin();else t=t&&l.newerWin();i.filter=!1}if(e.rulesArgs[n].rules)for(var s in e.rulesArgs[n].rules)t=l[e.rulesArgs[n].rules[s]]?t&&l[e.rulesArgs[n].rules[s]](i):t&&l.newerWin()}return t},lego:function(e){return l.query(e)}};t.default=l},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(66),s=a(l),d=n(69),f=(a(d),n(70)),c=(a(f),n(71)),p=(a(c),n(72)),v=(a(p),n(73)),y=(a(v),n(74)),h=(a(y),n(75));a(h);n(76),n(77),n(78),i.default.listen("removeEl",function(e){var t=u.default.get("domElement:"+e.id);t.remove(),u.default.delete("domElement:"+e.id)}),i.default.listen("showCard",function(e){(0,s.default)(e).show()}),i.default.listen("hideCard",function(e){(0,s.default)(e).hide()})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=(a(r),n(1)),o=a(i),u=n(2),l=a(u),s=n(67),d=a(s),f=n(68),c=a(f);o.default.set("animatedElements",0),o.default.set("animatedElementsStack",[]),o.default.set("animatedCallback",function(e){return null});var p=function(e){if(!e)throw Error("elRender:empty arguments.");if("string"!=typeof e)return e.el||e.elements?e:new d.default(e);try{if("#"==e[0]){var t=document.getElementById(e.slice(1,1/0));return new d.default(t)}if("."==e[0]){var n=document.getElementsByClassName(e.slice(1,1/0));return new c.default(n)}if("<"==e[0]){var a=document.createElement("temp");a.innerHTML=e;var r=a.children[0];return new d.default(r)}}catch(e){}};p.stopAnimations=function(e){l.default.dispatch("clearCallbacks"),p(".animated").stop().css({transition:!1}).removeClass("animated")},l.default.listen("stopAnimations",p.stopAnimations),t.default=p},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),u=a(o),l=n(1),s=a(l),d=n(3),f=(a(d),n(5)),c=(a(f),function(){function e(t){r(this,e),this.el=t,t||(this.el=null),this._animationCallbacks=[],this._animationIndex=0}return i(e,[{key:"attr",value:function(e){try{for(var t in e)this.el[t]=e[t];return this}catch(e){}}},{key:"hasClass",value:function(e){try{var t=this.el.className.split(" ");return t.indexOf(e)>=0;
}catch(e){}}},{key:"toggleClass",value:function(e){try{this.hasClass(e)?this.removeClass(e):this.addClass(e)}catch(e){}}},{key:"addClass",value:function(e){try{var t=this.el.className.split(" ");return this.hasClass(e)||(t.push(e),this.el.className=t.join(" ")),this}catch(e){}}},{key:"removeClass",value:function(e){if(!this.el||!this.el.className)return this;try{var t=this.el.className.split(" "),n=[];for(var a in t)t[a]!=e&&n.push(t[a]);return t=n,this.el.className=t.join(" "),this}catch(e){}}},{key:"css",value:function(e){if(!this.el)return this;try{for(var t in e)this.el.style[t]=e[t];return this}catch(e){}}},{key:"hide",value:function(){try{return this.css({display:"none"})}catch(e){}}},{key:"show",value:function(){try{return this.css({display:"block"})}catch(e){}}},{key:"append",value:function(e){try{return e.el&&(e=e.el),this.el.appendChild(e),this}catch(e){}}},{key:"html",value:function(e){try{return void 0===e?this.el.innerHTML:(e.el&&(e=e.el),this.el.innerHTML=e,this)}catch(e){}}},{key:"animate",value:function(e,t,n,a){var r=this;try{!function(){var i=s.default.get("animation");void 0===t&&(t=s.default.get("animationTime")),"function"==typeof t&&(n=t,t=s.default.get("animationTime")),"string"==typeof n&&(a=n,n=null),a=a?a:"animation_"+r._animationIndex,r._animationCallbacks[a]=n,r._animationIndex+=1,setTimeout(function(n){i&&r.css({transition:t/1e3+"s"});var o=0,l=function(e){var t=e+"",n=t.split("px");return 2==n.length?(0|n[0])+"px":e};for(var s in e)l(r.el.style[s])!=l(e[s])&&(o+=1),r.el.style[s]=e[s];i?(r.addClass("animated"),r.el.addEventListener("transitionend",function(e){o-=1,o||(r.removeClass("animated"),r.css({transition:null}),"function"==typeof r._animationCallbacks[a]&&(r._animationCallbacks[a](),r._animationCallbacks[a]=null),u.default.dispatch("allAnimationsEnd",a))},!1)):("function"==typeof r._animationCallbacks[a]&&(r._animationCallbacks[a](),r._animationCallbacks[a]=null),u.default.dispatch("allAnimationsEnd",a))},0)}()}catch(e){}}},{key:"stop",value:function(){this._animationCallbacks=[]}},{key:"remove",value:function(){try{this.el.parentNode.removeChild(this.el)}catch(e){}}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"after",value:function(e){try{this.el.parentNode.insertBefore(e,this.el.nextElementSibling)}catch(e){}return this}},{key:"before",value:function(e){try{this.el.parentNode.insertBefore(e,this.el)}catch(e){}return this}},{key:"listen",value:function(e,t){this.el.addEventListener(e,t)}},{key:"trigger",value:function(e){"function"==typeof this.el[e]&&this.el[e]()}},{key:"click",value:function(e){this.listen("click",e)}}]),e}());t.default=c},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(3),u=(a(o),n(67)),l=a(u),s=function(){function e(t){r(this,e),this.elements=[];for(var n in t)this.elements.push(new l.default(t[n]))}return i(e,[{key:"attr",value:function(e){for(var t in this.elements)this.elements[t].attr(e);return this}},{key:"toggleClass",value:function(e){for(var t in this.elements)this.elements[t].toggleClass(e);return this}},{key:"addClass",value:function(e){for(var t in this.elements)this.elements[t].addClass(e);return this}},{key:"removeClass",value:function(e){for(var t in this.elements)this.elements[t].removeClass(e);return this}},{key:"css",value:function(e){for(var t in this.elements)this.elements[t].css(e);return this}},{key:"hide",value:function(){for(var e in this.elements)this.elements[e].hide();return this}},{key:"show",value:function(){for(var e in this.elements)this.elements[e].show();return this}},{key:"animate",value:function(e,t,n,a){void 0===t&&(t=share.get("animationTime")),"function"==typeof t&&(n=t,t=share.get("animationTime")),"string"==typeof n&&(a=n,n=null);var r=0;for(var i in this.elements)r+=1,this.elements[i].animate(e,t,function(){r-=1,r||n()});return this}},{key:"stop",value:function(){for(var e in this.elements)this.elements[e].stop();return this}},{key:"remove",value:function(){for(var e in this.elements)this.elements[e].parentNode.removeChild(this.elements[e]);return this}}]),e}();t.default=s},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),i=a(r),o=n(2),u=a(o),l=n(3),s=a(l),d=n(12),f=(a(d),n(66)),c=a(f);u.default.listen("initField",function(e){var t=e.field?e.field:"#map";"string"==typeof t&&(t=2==t.split(".").length?document.getElementsByClassName(t.split(".")[1])[0]:2==t.split("#").length?document.getElementById(t.split("#")[1]):document.getElementsByTagName(t),t||(t=document.getElementById("mat")));var n={};e.width&&"number"==typeof e.width&&(n.width=e.width+"px"),e.height&&"number"==typeof e.height&&(n.height=e.height+"px"),e.top&&"number"==typeof e.top&&(n.top=e.top+"px"),e.left&&"number"==typeof e.left&&(n.left=e.left+"px");var a=i.default.get("zoom");a==s.default.zoom&&1==a||(n.transform="scale("+a+")",n["transform-origin"]="0 0"),(0,c.default)(t).css(n).addClass("solitaireField"),i.default.set("domElement:field",t)})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(3),s=a(l),d=n(12),f=(a(d),n(66)),c=a(f),p=function(e){e.params.x=(0|(e.deckData.position&&"number"==typeof e.deckData.position.x?e.deckData.position.x:0))+(0|(e.deckData.parentPosition&&"number"==typeof e.deckData.parentPosition.x?e.deckData.parentPosition.x:0)),e.params.y=(0|(e.deckData.position&&"number"==typeof e.deckData.position.y?e.deckData.position.y:0))+(0|(e.deckData.parentPosition&&"number"==typeof e.deckData.parentPosition.y?e.deckData.parentPosition.y:0)),e.deck.rotate=e.params.rotate=e.deckData.rotate&&"number"==typeof e.deckData.rotate?e.deckData.rotate:0,e.params.padding_y=e.deckData.paddingY&&"number"==typeof e.deckData.paddingY?e.deckData.paddingY:e.deckData.paddingType?s.default.padding_y:0,e.params.padding_x=e.deckData.paddingX&&"number"==typeof e.deckData.paddingX?e.deckData.paddingX:e.deckData.paddingType?s.default.padding_x:0,e.params.flip_padding_y=e.deckData.flipPaddingY&&"number"==typeof e.deckData.flipPaddingY?e.deckData.flipPaddingY:e.deckData.paddingType?s.default.flip_padding_y:0,e.params.flip_padding_x=e.deckData.flipPaddingX&&"number"==typeof e.deckData.flipPaddingX?e.deckData.flipPaddingX:e.deckData.paddingType?s.default.flip_padding_x:0};i.default.listen("addDeckEl",function(e){p(e);var t=(0,c.default)("<div>"),n={transform:"rotate("+(0|e.params.rotate)+"deg)",width:s.default.card.width+"px",height:s.default.card.height+"px",left:e.params.x+"px",top:e.params.y+"px",display:e.deck.visible?"block":"none"};(0,c.default)(t).css(n).addClass("el").attr({id:e.deck.id}),e.deckData.showSlot&&(0,c.default)(t).addClass("slot"),e.deckData.class&&(0,c.default)(t).addClass(e.deckData.class);var a=u.default.get("domElement:field");(0,c.default)(a).append(t),u.default.set("domElement:"+e.deck.id,t)}),i.default.listen("redrawDeckFlip",function(e){if(e&&e.cards)for(var t in e.cards){var n={},a=u.default.get("domElement:"+e.cards[t].id);e.cards[t].flip?a.addClass("flip"):a.removeClass("flip"),a.css(n)}}),i.default.listen("redrawDeckIndexes",function(e){if(e&&e.cards)for(var t in e.cards){var n=u.default.get("domElement:"+e.cards[t].id);n.css({"z-index":(0|s.default.startZIndex)+(0|t)})}}),i.default.listen("redrawDeck",function(e){if(u.default.get("noRedraw"))return!1;e&&e.deckData&&e.deck&&e.params&&p(e),e.deck.full;var t={transform:"rotate("+(0|e.params.rotate)+"deg)",left:e.params.x+"px",top:e.params.y+"px",display:e.deck.visible?"block":"none"},n=u.default.get("domElement:"+e.deck.id);if((0,c.default)(n).css(t),e.deck.full){var a=e.deck.getCards();for(var r in a){var i=u.default.get("domElement:"+a[r].id);i&&(0,c.default)(i).addClass("full")}}for(var o in e.cards){var l=e.deck.padding(o),s=(0|e.params.startZIndex)+(0|o),d={"-ms-transform":"rotate("+(0|e.params.rotate)+"deg)","-webkit-transform":"rotate("+(0|e.params.rotate)+"deg)","-moz-transform":"rotate("+(0|e.params.rotate)+"deg)",transform:"rotate("+(0|e.params.rotate)+"deg)",left:l.x+"px",top:l.y+"px","z-index":s,display:e.deck.visible?"block":"none"},f=u.default.get("domElement:"+e.cards[o].id);e.cards[o].flip?(0,c.default)(f).addClass("flip"):(0,c.default)(f).removeClass("flip"),(0,c.default)(f).css(d)}})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),i=a(r),o=n(2),u=a(o),l=n(3),s=a(l),d=n(5),f=(a(d),n(12)),c=(a(f),n(66)),p=a(c);u.default.listen("addCardEl",function(e){var t={width:1*s.default.card.width.toFixed(3),height:1*s.default.card.height.toFixed(3)},n={width:t.width+"px",height:t.height+"px"},a=(0,p.default)("<div>");(0,p.default)(a).addClass("el card draggable "+e.name).css(n).attr({id:e.id}),i.default.set("domElement:"+e.id,a);var r=i.default.get("domElement:field");(0,p.default)(r).append(a)})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(66),s=a(l),d=n(9),f=a(d);i.default.listen("showTip",function(e){if(e&&e.el&&e.type){var t=u.default.get("domElement:"+e.el.id);(0,s.default)(t).addClass(e.type)}}),i.default.listen("hideTips",function(e){if(e&&e.types)for(var t in e.types){var n=e.types[t];(0,s.default)("."+n).removeClass(n)}else for(var a in f.default.tipTypes){var r=f.default.tipTypes[a];(0,s.default)("."+r).removeClass(r)}})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(5),s=a(l),d=n(3),f=a(d),c=n(66),p=a(c),v=function(e){return e<0&&(e+=360),e>360&&(e-=360),e};i.default.listen("moveDragDeck",function(e){s.default.curLock();var t=e.moveDeck.length-1,n=function(n){var a=e.destination.padding(e.destination.cards.length-1+(0|n)),r=v(e.departure.rotate),o=v(e.destination.rotate),l=u.default.get("domElement:"+e.moveDeck[n].card.id);(0,p.default)(l).css({transform:"rotate("+r+"deg)"}),r-o>180&&(r-=360,(0,p.default)(l).css({transform:"rotate("+r+"deg)"})),r-o<-180&&(o-=360);var d={transform:"rotate("+o+"deg)",left:a.x+"px",top:a.y+"px"},c=(0|f.default.topZIndex)+(0|n),y=!1,h=function(e,t){y||(e.departure.Redraw(),e.destination.Redraw(),s.default.curUnLock(),t&&"function"==typeof e.callback&&e.callback(),i.default.dispatch("moveDragDeckDone",{deck:e.destination}))}.bind(null,e,n==t);i.default.once("clearCallbacks",function(e){y=!0}),(0,p.default)(l).css({"z-index":c}).animate(d,h)};for(var a in e.moveDeck)n(a)}),i.default.listen("moveDragDeckDone",function(e){if(e.deck.full){var t=e.deck.cards;for(var n in t){var a=u.default.get("domElement:"+t[n].id);(0,p.default)(a).addClass("full")}}}),i.default.listen("dragDeck",function(e){for(var t in e._dragDeck){var n=u.default.get("zoom"),a=e._deck.padding(e._dragDeck[t].index),r={left:a.x+(e.x-e._startCursor.x)/n+"px",top:a.y+(e.y-e._startCursor.y)/n+"px","z-index":f.default.topZIndex+(0|t)},i=u.default.get("domElement:"+e._dragDeck[t].card.id);(0,p.default)(i).css(r)}})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(5),s=a(l),d=n(66),f=a(d);i.default.listen("moveCardToHome",function(e){u.default.get("lastCursorMove").distance>0&&s.default.curLock();for(var t in e.moveDeck){var n=e.departure.padding(e.moveDeck[t].index),a={left:n.x+"px",top:n.y+"px"},r=u.default.get("domElement:"+e.moveDeck[t].card.id);(0,f.default)(r).animate(a,function(t){s.default.curUnLock(),e.departure&&e.departure.Redraw(),"function"==typeof e.callback&&e.callback()},"moveCardToHomeAnimation")}})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(2),i=a(r),o=n(1),u=a(o),l=n(3),s=a(l),d=n(12),f=(a(d),n(66)),c=a(f);i.default.listen("fieldThemesSet",function(e){var t=u.default.get("domElement:field");for(var n in s.default.themes){for(var a in s.default.themes[n]){var r=s.default.themes[n][a];(0,c.default)(t).removeClass(r)}var i=e[n];(0,c.default)(t).addClass(i)}})},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=a(r),u=function(e){for(var t,n,a=e.length;a;t=Math.floor(Math.random()*a),n=e[--a],e[a]=e[t],e[t]=n);},l=function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var l=o.value,s=!0,d=!1,f=void 0;try{for(var c,p=t[Symbol.iterator]();!(s=(c=p.next()).done);s=!0){var v=c.value;n.push(l+v)}}catch(e){d=!0,f=e}finally{try{!s&&p.return&&p.return()}finally{if(d)throw f}}}}catch(e){r=!0,i=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}return n},s={all:function(e){return l(o.default.card.suits,e)},black:function(e){var t=o.default.card.colors.black;return l(t,e)},red:function(e){var t=o.default.card.colors.red;return l(t,e)},black_and_red:function(e){var t=[o.default.card.colors.red[Math.random()*o.default.card.colors.red.length|0],o.default.card.colors.black[Math.random()*o.default.card.colors.black.length|0]];return l(t,e)},h_only:function(e){var t=["h"];return l(t,e)},d_only:function(e){var t=["d"];return l(t,e)},c_only:function(e){var t=["c"];return l(t,e)},s_only:function(e){var t=["s"];return l(t,e)},one_rank_only:function(e){var t=[o.default.card.solors[Math.random()*o.default.card.solors.length|0]];return l(t,e)},hearts:function(e){return s.h_only()},diamonds:function(e){return s.d_only()},clubs:function(e){return s.c_only()},spades:function(e){return s.s_only()}};t.default=function(e){var t="all",n=!1,a=10,r=e&&e.type&&"string"==typeof e.type?e.type:t,l=e&&e.deckCount&&"number"==typeof e.deckCount?e.deckCount:52,d=e&&e.iterations&&"number"==typeof e.iterations&&e.iterations<a?e.iterations:1,f=e&&e.shuffle&&"undefuned"!=typeof e.shuffle?e.shuffle:n,c=36==l?o.default.card.ranks36:o.default.card.ranks;if(e&&e.ranks){c=[];for(i in e.ranks)o.default.card.rank.indexOf(""+e.ranks[i])>=0&&c.push(""+e.ranks[i])}for(var p=[];d>0;d-=1)p=p.concat(s[r](c));return f&&u(p),p}}]);